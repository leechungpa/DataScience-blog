[{"categories":["R"],"content":"\r\rIDE setting for Data Science\r\rë°ì´í„° ì‚¬ì´ì–¸ìŠ¤ìª½ìœ¼ë¡œ ê³µë¶€í•˜ê³  ì‹¶ì–´ì„œ ë…¸íŠ¸ë¶ì„ ìƒˆë¡œ êµ¬ë§¤í—€ë‹¤. ë¬´ë ¤ 8ë…„ë§Œì—. ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤ë©´ ì• í”Œì„ ìƒ€ì–´ì•¼ í–ˆëŠ”ë°, ê²½ì œì  ì—¬ê±´ ìƒ êµ­ë‚´ ì¤‘ì†Œê¸°ì—…ì¸ í•œì„±ì»´í“¨í„° ì œí’ˆì„ êµ¬ë§¤í—€ë‹¤. ë§¤ìš° ì“°ë ˆê¸° ì˜€ë‹¤.\nêµ¬ë§¤í•˜ê³  í•œë‹¬ë„ ì•ˆë˜ì–´ì„œ ì‚¬ìš©ì¤‘ ì…§ë‹¤ìš´ ë˜ëŠ” ìë™ ì ˆì „ëª¨ë“œë¡œ ì „í™˜ë˜ëŠ” í˜„ìƒì´ ë‚˜íƒ€ë‚¬ë‹¤. ì„œë¹„ìŠ¤ ì„¼í„°ì— ì…ê³ ë¥¼ í–ˆë”ë‹ˆ, ì¦ìƒì´ ì•ˆë‚˜ì˜¨ë‹¤ê³  ë‹¤ì‹œ ë³´ëƒˆë‹¤. ì§ì ‘ ì¦ìƒì´ ë‚˜ì˜¤ëŠ” ê²ƒì„ ì´¬ì˜í•˜ê³  ë³´ëƒˆë”ë‹ˆ í¬ë§·í•œë²ˆ í•˜ê³  ë³´ëƒˆë‹¤. ë‚´ê°€ ë³´ë‚´ê¸° ì „ì— í¬ë§·ì€ ìˆ˜ë„ ì—†ì´ ë§ì´ í–ˆëŠ”ë°. ê²°êµ­ 3ë²ˆ ë³´ë‚´ê³  ë‚˜ì„œ SSDêµì²´ë¥¼ í•´ì£¼ì—ˆë‹¤. ë¬¸ì œëŠ” í„°ì¹˜íŒ¨ë“œ ê·¼ì²˜ì— ì•„ì´íŒ¨ë“œë¥¼ ê°€ì ¸ë‹¤ ë˜ë©´ ë…¸íŠ¸ë¶ì´ êº¼ì§ˆ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì‹ ì¬í’ˆì—ì„œë„ ë™ì¼í•˜ê²Œ ë‚˜íƒ€ë‚˜ë¯€ë¡œ ì£¼ì˜ë¥¼ ìš”êµ¬í•œë‹¤ê³  ë§í–ˆë‹¤. ë‚´ê°€ ì»´í“¨í„° í•˜ë£¨ì´í‹€ ë§Œì§„ê²ƒë„ ì•„ë‹ˆê³ , ë°ìŠ¤í¬íƒ‘ì€ ì§ì ‘ ë¶€í’ˆì„ ì‚¬ì„œ ë‹¤ ì¡°ë¦½ë„ í•  ìˆ˜ ìˆëŠ”ë° ê³ ì‘ ê·¸ ì•½í•œ ìì„±ë–„ë¬¸ì— êº¼ì§€ëŠ”ê²Œ ë‹¹ì—°í•˜ë‹¤ê³ â€¦ í•œì„±ì€ ì“°ë ˆê¸°ë‹¤. ëˆ ë²Œë©´ ë°”ë¡œ ì• í”Œ ì‚´ê²ƒì´ë‹¤.\nì—¬íŠ¼ ê·¸ë˜ì„œ í¬ë§·ì„ ìˆ˜ë„ì—†ì´ ë§ì´ í–ˆë‹¤. ì¦‰ Rê³¼ Rstudio ë“±ë“± ìˆ˜ë„ì—†ì´ ë°˜ë³µí•´ì„œ ì„¤ì¹˜í•´ë³´ë©´ì„œ ë‚˜ì—ê²Œ ìµìˆ™í•œ ê°œë°œí™˜ê²½ì´ ë¬´ì—‡ì¸ì§€ ì°¾ì•˜ë‹¤. ì´ì œ ë³¸ë¡ ìœ¼ë¡œ ê°€ì.\nì´ˆê¸° ì„¤ì •\rR ì„¤ì¹˜\rë¨¼ì € Rì„ ì„¤ì¹˜í•œë‹¤. ì„¤ì¹˜ì‹œ ìœ ì˜í•  ì ì€ ì•„ë˜ì™€ ê°™ë‹¤.\n\r64-bitë§Œ ì„¤ì¹˜\n\rì„¤ì¹˜ ê²½ë¡œëŠ” ëª¨ë‘ ì˜ì–´ë¡œ, í´ë”ëª…ì— ë„ì–´ì“°ê¸°ëŠ” ì§€ì–‘í•˜ì\n\rí•œêµ­ì–´ ë³´ë‹¤ëŠ” ì˜ì–´ë¥¼ ê¸°ë³¸ì–¸ì–´ë¡œ ì„¤ì •í•˜ì\r\r\rR studio ì„¤ì¹˜\rì´ì œ IDEì¸ R studioë¥¼ ì„¤ì¹˜í•˜ë©´ ëœë‹¤. R studioë¥¼ ì„¤ì¹˜í•˜ê³  ì„¤ì •í•  í™˜ê²½ì´ ë§ë‹¤. (ì‚¬ì‹¤ ì´ë¶€ë¶„ì„ ì •ë¦¬í•˜ê³ ì ì“´ê±°ë‹¤.)\nTools - Global Options\n\rGeneral-Basic : Default working directory ë³€ê²½\n\rGeneral-Basic : Workspaceì—ì„œ .RData ì‚¬ìš©í•˜ì§€ ì•ŠìŒ(never) ì„¤ì • ë° ì‹œì‘ì‹œ ìë™ ë¶ˆëŸ¬ì˜¤ê¸° ë¯¸ì‚¬ìš©\n\rCode-Saving : encodingì„ UTF-8ë¡œ ë³€ê²½\n\rAppearance : í…Œë§ˆ ë³€ê²½, ëˆˆì´ ì•ˆì¢‹ìœ¼ë¯€ë¡œ zoom 125%ì— Tommorrow Night Brightë¥¼ ì„ í˜¸\n\rTerminal : Bash(Windows Subsystem for Linux), ì°¸ê³ ë¡œ ìš°ë¶„íŠ¸ ë“± ì„¤ì¹˜í›„ ê°€ëŠ¥\n\r\rê¸°íƒ€\n\rë§ˆí¬ë‹¤ìš´ : Preview in Viewr Pane ì²´í¬\n\rë§ˆí¬ë‹¤ìš´ : Chunk Ouptput in Console ì²´í¬\n\r\r\r\rì¶”ê°€ ì„¤ì¹˜ : Git bash ë° ìš°ë¶„íˆ¬ ë“±\rì°¸ê³ ë¡œ ìœˆë„ìš°10 ê¸°ì¤€ ê°œë°œí™˜ê²½ì´ë‹¤. ì—í”Œì„ ì‚¬ì•¼í•˜ëŠ” ì´ìœ ê°€ ì´ê²ƒì´ë‹¤. ì§€ê¸ˆë¶€í„°ëŠ” ì—í”Œì´ë¼ë©´ í•„ìš”ì—†ëŠ” ì„¤ì¹˜ì´ê¸° ë•Œë¬¸ì´ë‹¤.\n\rwindows ê¸°ëŠ¥ ì¼œê¸°/ë„ê¸°ì—ì„œ Linuxìš© Windows í•˜ìœ„ ì‹œìŠ¤í…œ ì²´í¬\n\rìš°ë¶„íˆ¬ ì„¤ì¹˜\n\ríŒŒì¼ ê´€ë¦¬ë¥¼ ìœ„í•œ git bash(https://git-scm.com/) ì„¤ì¹˜\n\rpdf ë§ˆíŠ¸ë‹¤ìš´ì„ ìœ„í•œ TeX ì„¤ì¹˜\n\r\r\r\rì´ˆê¸° ì„¤ì • í™•ì¸\rì´ë ‡ê²Œ ì„¤ì¹˜ë¥¼ ì™„ë£Œí–ˆë‹¤ë©´ ì„¤ì¹˜ ë° ì„¤ì •ì´ ì˜ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ ë³´ì.\nsessionInfo()\r## R version 4.0.0 (2020-04-24)\r## Platform: x86_64-w64-mingw32/x64 (64-bit)\r## Running under: Windows 10 x64 (build 18363)\r## ## Matrix products: default\r## ## locale:\r## [1] LC_COLLATE=Korean_Korea.949 LC_CTYPE=Korean_Korea.949 ## [3] LC_MONETARY=Korean_Korea.949 LC_NUMERIC=C ## [5] LC_TIME=Korean_Korea.949 ## ## attached base packages:\r## [1] stats graphics grDevices utils datasets methods base ## ## loaded via a namespace (and not attached):\r## [1] compiler_4.0.0 magrittr_1.5 bookdown_0.19 tools_4.0.0 ## [5] htmltools_0.4.0 yaml_2.2.1 Rcpp_1.0.4.6 stringi_1.4.6 ## [9] rmarkdown_2.1 blogdown_0.19 knitr_1.28 stringr_1.4.0 ## [13] digest_0.6.25 xfun_0.13 rlang_0.4.6 evaluate_0.14\rgetwd()\r## [1] \"D:/git/blog/content/posts\"\rê²½ê³ í‘œì‹œë‚˜ ì¤‘ê°„ì¤‘ê°„ í•œê¸€ì„ ì‚¬ìš©í•˜ë©´ ë¬¸ì œê°€ ë§ë‹¤. ê·¸ëŸ¬ëŠ” ê²½ìš° localeì„ ë°”ê¿”ì•¼ í•œë‹¤.\nSys.getlocale()\r## [1] \"LC_COLLATE=Korean_Korea.949;LC_CTYPE=Korean_Korea.949;LC_MONETARY=Korean_Korea.949;LC_NUMERIC=C;LC_TIME=Korean_Korea.949\"\rSys.setlocale() ë¡œ ì›í•˜ëŠ” ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤.\n\rì—…ë°ì´íŠ¸\rì´ˆê¸° ì„¤ì • ì´í›„ ì‹œê°„ì´ ì§€ë‚˜ë©´ Rê³¼ R studio ì—…ë°ì´íŠ¸ê°€ í•„ìš” í•  ìˆ˜ ìˆë‹¤. ë¨¼ì € Rì€ ë‹¤ìŒì˜ ì½”ë“œë¥¼ ì´ìš©í•˜ë©´ ëœë‹¤.\n# install.packages('installr')\rinstallr::check.for.updates.R()\rinstallr::install.R()\rR studioì˜ ê²½ìš° Help-Check for Update ë¥¼ í™•ì¸í•´ ë³´ë©´ëœë‹¤.\në§ˆì§€ë§‰ìœ¼ë¡œ ì„¤ì¹˜ëœ packagesë¥¼ ì—…ë°ì´íŠ¸ í•´ì£¼ë©´ ëœë‹¤.\nupdate.packages()\r\r","description":"","tags":["R","Rstudio","IDE","Git"],"title":"Data Scienceë¥¼ ìœ„í•œ R ì´ˆê¸° í™˜ê²½","uri":"/posts/r/1/"},{"categories":["R"],"content":"\r\r\r\r\r\r\rë¨¼ì € ì‚¬ìš©í•œ í˜í‚¤ì§€ì´ë‹¤.\nlibrary(tidyverse)\r## -- Attaching packages ----------------------------------------------------------------------------------------------------- tidyverse 1.3.0 --\r## âˆš ggplot2 3.3.0 âˆš purrr 0.3.4\r## âˆš tibble 3.0.1 âˆš dplyr 0.8.5\r## âˆš tidyr 1.0.3 âˆš stringr 1.4.0\r## âˆš readr 1.3.1 âˆš forcats 0.5.0\r## -- Conflicts -------------------------------------------------------------------------------------------------------- tidyverse_conflicts() --\r## x dplyr::filter() masks stats::filter()\r## x dplyr::lag() masks stats::lag()\rlibrary(rpart)\rlibrary(rpart.plot)\rlibrary(pROC)\r## Type 'citation(\"pROC\")' for a citation.\r## ## ë‹¤ìŒì˜ íŒ¨í‚¤ì§€ë¥¼ ë¶€ì°©í•©ë‹ˆë‹¤: 'pROC'\r## The following objects are masked from 'package:stats':\r## ## cov, smooth, var\rlibrary(plotly)\r## ## ë‹¤ìŒì˜ íŒ¨í‚¤ì§€ë¥¼ ë¶€ì°©í•©ë‹ˆë‹¤: 'plotly'\r## The following object is masked from 'package:ggplot2':\r## ## last_plot\r## The following object is masked from 'package:stats':\r## ## filter\r## The following object is masked from 'package:graphics':\r## ## layout\rë‹¤ìŒìœ¼ë¡œ ìš°ë¦¬ê°€ ì‚¬ìš©í•  ë°ì´í„°ì´ë‹¤. ë°ì´í„°ëŠ” ìˆ™ì œ ì£¼ì†Œ ì¤‘ í•˜ë‚˜ì¸ https://www.openml.org/d/29 ì—ì„œ ê°€ì ¸ì™”ë‹¤.\nraw_hw_tb = read_csv(\"data/dataset_29_credit-a.csv\",na=\"?\")\r## Parsed with column specification:\r## cols(\r## A1 = col_character(),\r## A2 = col_double(),\r## A3 = col_double(),\r## A4 = col_character(),\r## A5 = col_character(),\r## A6 = col_character(),\r## A7 = col_character(),\r## A8 = col_double(),\r## A9 = col_logical(),\r## A10 = col_logical(),\r## A11 = col_character(),\r## A12 = col_logical(),\r## A13 = col_character(),\r## A14 = col_character(),\r## A15 = col_double(),\r## class = col_character()\r## )\rí•´ë‹¹ìë£ŒëŠ” Credit Approvalë¡œ credit card applicationsì™€ ê´€ë ¨ëœ ìë£Œì´ë‹¤. Ross Quinlanì˜ ìë£Œë¡œ, 1987ë…„ UCIì— ê³µê°œëœ ìë£Œì´ë‹¤. ëª¨ë“  ìë£ŒëŠ” ë³´ì•ˆì„ ìœ„í•´ ë‹¤ë¥¸ ë‹¨ì–´ë¡œ ë³€ê²½ë˜ì—ˆë‹¤. ì •í™•íˆ ê°ê°ì˜ ë³€ìˆ˜ê°€ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ” ì•Œ ìˆ˜ ì—†ëŠë‚˜ í™ˆí˜ì´ì§€ë¥¼ í†µí•´ ê° ë³€ìˆ˜ë“¤ì˜ íŠ¹ì„±ì„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤. ë¨¼ì € A1, A4, A5, A6, A7, A9, A10, A12, A13ëŠ” ëª…ëª©í˜• ìë£Œì´ë‹¤. ëŒ€ë¶€ë¶„ì€ 2ê°œì˜ ë²”ì£¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë‚˜, A6ê³¼ ê°™ì€ê²½ìš° 15ê°œì˜ ë²”ì£¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. ë°˜ë©´ A2, A3, A8, A11, A14, A15ëŠ” ìˆ«ìí˜• ë²”ì£¼ì´ë‹¤. read_csvì—ì„œ ë³´ë©´ ê·¸ íŠ¹ì„±ê³¼ ë‹¤ë¥´ê²Œ ê°€ì ¸ì™”ê¸°ì— ì´ì— ë§ê²Œ ë³€ìˆ˜ë¥¼ ë³€í™˜í•˜ì˜€ë‹¤. ë˜í•œ ì¤‘ê°„ì¤‘ê°„ NAê°€ ìˆìœ¼ë‚˜ ë‚˜ë¬´ëª¨í˜•ì„ ì‚¬ìš©í•˜ê¸°ì— ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì˜€ë‹¤.\nhw_tb = raw_hw_tb %\u003e% mutate(\rA1=as.factor(A1), A4=as.factor(A4), A5=as.factor(A5), A6=as.factor(A6), A7=as.factor(A7),\rA9=as.factor(A9), A10=as.factor(A10), A12=as.factor(A12), A13=as.factor(A13),\rA2=as.numeric(A2), A3=as.numeric(A3), A8=as.numeric(A8), A11=as.numeric(A11),\rA14=as.numeric(A14), A15=as.numeric(A15),\rclass=as.factor(class)\r)\rìë£Œì˜ êµ¬ì¡°ì™€ ì´ ê°œìˆ˜ë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.\nstr(hw_tb)\r## tibble [690 x 16] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\r## $ A1 : Factor w/ 2 levels \"a\",\"b\": 2 1 1 2 2 2 2 1 2 2 ...\r## $ A2 : num [1:690] 30.8 58.7 24.5 27.8 20.2 ...\r## $ A3 : num [1:690] 0 4.46 0.5 1.54 5.62 ...\r## $ A4 : Factor w/ 3 levels \"l\",\"u\",\"y\": 2 2 2 2 2 2 2 2 3 3 ...\r## $ A5 : Factor w/ 3 levels \"g\",\"gg\",\"p\": 1 1 1 1 1 1 1 1 3 3 ...\r## $ A6 : Factor w/ 14 levels \"aa\",\"c\",\"cc\",..: 13 11 11 13 13 10 12 3 9 13 ...\r## $ A7 : Factor w/ 9 levels \"bb\",\"dd\",\"ff\",..: 8 4 4 8 8 8 4 8 4 8 ...\r## $ A8 : num [1:690] 1.25 3.04 1.5 3.75 1.71 ...\r## $ A9 : Factor w/ 2 levels \"FALSE\",\"TRUE\": 2 2 2 2 2 2 2 2 2 2 ...\r## $ A10 : Factor w/ 2 levels \"FALSE\",\"TRUE\": 2 2 1 2 1 1 1 1 1 1 ...\r## $ A11 : num [1:690] 1 6 0 5 0 0 0 0 0 0 ...\r## $ A12 : Factor w/ 2 levels \"FALSE\",\"TRUE\": 1 1 1 2 1 2 2 1 1 2 ...\r## $ A13 : Factor w/ 3 levels \"g\",\"p\",\"s\": 1 1 1 1 3 1 1 1 1 1 ...\r## $ A14 : num [1:690] 202 43 280 100 120 360 164 80 180 52 ...\r## $ A15 : num [1:690] 0 560 824 3 0 ...\r## $ class: Factor w/ 2 levels \"-\",\"+\": 2 2 2 2 2 2 2 2 2 2 ...\rnrow(hw_tb)\r## [1] 690\r#1\r##1. Training ë°ì´í„°ì™€ Test ë°ì´í„°ë¥¼ 50:50ì˜ ë¹„ìœ¨ë¡œ ë¶„í• í•˜ì‹œì˜¤. (ë‹¨, ì‹œë“œë²ˆí˜¸ëŠ” í•™ë²ˆì˜ ë’¤ìë¦¬ìˆ˜ 4ê°œë¥¼ ì‚¬ìš©í•˜ì‹œì˜¤)\nset.seed(2010)\rn = sample(1:nrow(hw_tb), round(nrow(hw_tb)/2)) train = hw_tb[n,] test = hw_tb[-n,]\rc(nrow(train), nrow(test))\r## [1] 345 345\r#2~4\r##2. R í”„ë¡œê·¸ë¨ì˜ â€˜rpartâ€™ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ì‚¬ê²°ì •ë‚˜ë¬´ë¥¼ ìˆ˜í–‰í•˜ê³ ì í•œë‹¤.\r###ë‹¨, hyper-parameterëŠ” ì•„ë˜ì™€ ê°™ì´ ì¡°ì •í•œë‹¤.\r###A. minsplit = 1 ~ 46 (5ì˜ ê°„ê²©ìœ¼ë¡œ)\r###B. cp = 0.001 ~ 0.01 (0.001ì˜ ê°„ê²©ìœ¼ë¡œ)\r###C. xval = 0 ìœ¼ë¡œ ê³ ì • (pruning ì—†ìŒ)\r###D. ê·¸ì™¸ parameter ê°’ë“¤ì€ default ê°’ì„ ì‚¬ìš©\r##3. ìœ„ 2ë²ˆì˜ ì¡°ê±´ì— ë§ëŠ” ì˜ì‚¬ê²°ì •ë‚˜ë¬´ë¥¼ training ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ ìƒì„±í•˜ê³ , test ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ ì˜ˆì¸¡ ì •í™•ë„ë¥¼ ê³„ì‚°í•˜ê³ ì í•œë‹¤. ì´ë•Œ ì˜ˆì¸¡ì •í™•ë„ëŠ” AUROC ê°’ì„ ì‚¬ìš©í•œë‹¤.\r##4. 3ë²ˆì˜ ê²°ê³¼, ì´ 110ê°œì˜ AUROC ê°’ì„ êµ¬í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ minsplitê³¼ cp ê°’ì˜ ì¡°í•©ì— ë”°ë¼ AUROC ê°’ìœ¼ë¡œ 3ì°¨ì› í¬ë¬¼ì„  ê·¸ë˜í”„ë¥¼ ìƒì„±í•˜ì‹œì˜¤. (3D surface plot)\nauc = matrix(NA,nrow=10,ncol=10)\rfor(i1 in 1:10){\rfor(i2 in 1:10){\rtree_control = rpart.control(minsplit = 5*i1-4, cp =0.001*i2, xval=0)\rtemp_tree = assign(paste('tree',5*i1-4,i2,sep='_'), rpart(class ~ . , data=train, method='class', control=tree_control) )\rtemp_prob = assign(paste('prob',5*i1-4,i2,sep='_'), predict(temp_tree, newdata=test, type=\"prob\") )\rtemp_roc = assign(paste('roc',5*i1-4,i2,sep='_'), roc(test$class ~ temp_prob[,2]) )\rauc[i1,i2]=temp_roc$auc\r}\r}\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r## Setting levels: control = -, case = +\r## Setting direction: controls \u003c cases\r2ë²ˆ 3ë²ˆ 4ë²ˆ ì¤‘ê°„ì— ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì€ ê°ì²´ë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ê·¸ ê²°ê³¼ëŠ” ìƒëµí•œë‹¤.\nê°ê°ì˜ ëª¨í˜•(2ë²ˆ) : tree_(minsplitê°’)_(cpê°’*1000) ê°ê°ì˜ ì˜ˆì¸¡(3ë²ˆ) : prob_(minsplitê°’)_(cpê°’*1000) ê°ê°ì˜ roc(4ë²ˆ) : roc_(minsplitê°’)_(cpê°’*1000)\ní•´ë‹¹ aurocë¥¼ ì´ìš©í•˜ì—¬ 3d surface plotì„ ê·¸ë¦¬ë©´ ì•„ë˜ì™€ ê°™ë‹¤.\ncp = 0.001*1:10\rminsplit = 1:10*5-4\rrownames(auc)=cp\rcolnames(auc)=minsplit\rplot_ly(z = auc,x=cp,y=minsplit) %\u003e%\radd_surface() %\u003e%\rlayout(scene = list(\rxaxis = list(title = 'cp',tickvals=cp),\ryaxis = list(title = 'minsplit',tickvals=minsplit),\rzaxis = list(title = 'auc'))\r)\r\r{\"x\":{\"visdat\":{\"13c4489c2f01\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"13c4489c2f01\",\"attrs\":{\"13c4489c2f01\":{\"z\":[[0.775384615384615,0.775384615384615,0.760615384615385,0.712991452991453,0.760581196581196,0.760581196581196,0.866769230769231,0.866769230769231,0.866769230769231,0.876461538461538],[0.757333333333333,0.757333333333333,0.757333333333333,0.757811965811966,0.757811965811966,0.751846153846154,0.814581196581197,0.814581196581197,0.814581196581197,0.876461538461538],[0.878529914529915,0.878529914529915,0.878529914529915,0.878529914529915,0.874905982905983,0.874905982905983,0.873264957264957,0.873264957264957,0.873264957264957,0.888717948717949],[0.873931623931624,0.873931623931624,0.873931623931624,0.873931623931624,0.873931623931624,0.873931623931624,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.891897435897436,0.891897435897436,0.891897435897436,0.891897435897436,0.891897435897436,0.891897435897436,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436]],\"x\":[0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01],\"y\":[1,6,11,16,21,26,31,36,41,46],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"surface\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"xaxis\":{\"title\":\"cp\",\"tickvals\":[0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01]},\"yaxis\":{\"title\":\"minsplit\",\"tickvals\":[1,6,11,16,21,26,31,36,41,46]},\"zaxis\":{\"title\":\"auc\"}},\"hovermode\":\"closest\",\"showlegend\":false,\"legend\":{\"yanchor\":\"top\",\"y\":0.5}},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"colorbar\":{\"title\":\"\",\"ticklen\":2,\"len\":0.5,\"lenmode\":\"fraction\",\"y\":1,\"yanchor\":\"top\"},\"colorscale\":[[\"0\",\"rgba(68,1,84,1)\"],[\"0.0416666666666668\",\"rgba(70,19,97,1)\"],[\"0.0833333333333336\",\"rgba(72,32,111,1)\"],[\"0.125\",\"rgba(71,45,122,1)\"],[\"0.166666666666667\",\"rgba(68,58,128,1)\"],[\"0.208333333333333\",\"rgba(64,70,135,1)\"],[\"0.25\",\"rgba(60,82,138,1)\"],[\"0.291666666666667\",\"rgba(56,93,140,1)\"],[\"0.333333333333333\",\"rgba(49,104,142,1)\"],[\"0.375\",\"rgba(46,114,142,1)\"],[\"0.416666666666667\",\"rgba(42,123,142,1)\"],[\"0.458333333333333\",\"rgba(38,133,141,1)\"],[\"0.5\",\"rgba(37,144,140,1)\"],[\"0.541666666666667\",\"rgba(33,154,138,1)\"],[\"0.583333333333333\",\"rgba(39,164,133,1)\"],[\"0.625\",\"rgba(47,174,127,1)\"],[\"0.666666666666667\",\"rgba(53,183,121,1)\"],[\"0.708333333333333\",\"rgba(79,191,110,1)\"],[\"0.75\",\"rgba(98,199,98,1)\"],[\"0.791666666666667\",\"rgba(119,207,85,1)\"],[\"0.833333333333333\",\"rgba(147,214,70,1)\"],[\"0.875\",\"rgba(172,220,52,1)\"],[\"0.916666666666666\",\"rgba(199,225,42,1)\"],[\"0.958333333333333\",\"rgba(226,228,40,1)\"],[\"1\",\"rgba(253,231,37,1)\"]],\"showscale\":true,\"z\":[[0.775384615384615,0.775384615384615,0.760615384615385,0.712991452991453,0.760581196581196,0.760581196581196,0.866769230769231,0.866769230769231,0.866769230769231,0.876461538461538],[0.757333333333333,0.757333333333333,0.757333333333333,0.757811965811966,0.757811965811966,0.751846153846154,0.814581196581197,0.814581196581197,0.814581196581197,0.876461538461538],[0.878529914529915,0.878529914529915,0.878529914529915,0.878529914529915,0.874905982905983,0.874905982905983,0.873264957264957,0.873264957264957,0.873264957264957,0.888717948717949],[0.873931623931624,0.873931623931624,0.873931623931624,0.873931623931624,0.873931623931624,0.873931623931624,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.891897435897436,0.891897435897436,0.891897435897436,0.891897435897436,0.891897435897436,0.891897435897436,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949,0.888717948717949],[0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436,0.887897435897436]],\"x\":[0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01],\"y\":[1,6,11,16,21,26,31,36,41,46],\"type\":\"surface\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\rê·¸ë˜í”„ëŠ” plotyë¥¼ ì‚¬ìš©í•˜ì˜€ê¸°ì— htmlì—ì„œ ì¢…í•©ì ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. ê³¼ì œ ì œì¶œí•˜ê¸° ìœ„í•´ í•´ë‹¹ ê·¸ë˜í”„ë¥¼ printscreení•´ì„œ ìœ„ì— ì²¨ë¶€í•˜ì˜€ë‹¤.\n#5\r##5. 4ë²ˆì˜ ê²°ê³¼ì—ì„œ ì˜ˆì¸¡ì •í™•ë„ê°€ ê°€ì¥ ë†’ì€ ìµœì ì˜ hyper-parameter ì¡°í•©ì€ ë¬´ì—‡ì¸ì§€ ë°íˆì‹œì˜¤.\në¨¼ì € auc í–‰ë ¬ì„ ì´ìš©í•´ ìµœëŒ“ê°’ì„ ì°¾ìœ¼ë©´ ë‹¤ìŒì˜ ìœ„ì¹˜ì´ë‹¤.\nauc == max(auc)\r## 1 6 11 16 21 26 31 36 41 46\r## 0.001 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\r## 0.002 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\r## 0.003 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\r## 0.004 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\r## 0.005 TRUE TRUE TRUE TRUE TRUE TRUE FALSE FALSE FALSE FALSE\r## 0.006 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\r## 0.007 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\r## 0.008 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\r## 0.009 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\r## 0.01 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\rì¦‰ cpê°€ 0.005ì´ê³  minsplitì´ 1, 6, 11, 16, 21ì¼ë•Œ ê°€ì¥ ì¢‹ì€ aurocë¥¼ ê°€ì§„ë‹¤. ì¦‰ í•´ë‹¹ ì¡°í•©ì´ ìµœì ì˜ hyper-parameterì´ë‹¤.\n","description":"","tags":["R Markdown"],"title":"ë°ì´í„°ë§ˆì´ë‹ - Decision Tree","uri":"/posts/report/2/"},{"categories":null,"content":"History of Blog í•´ë‹¹ ë¸”ë¡œê·¸ëŠ” blogdown packageë¥¼ ë°”íƒ•ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ë³¸ ë¸”ë¡œê·¸ëŠ” ìµœì´ˆ 2020í•™ë…„ë„ 1í•™ê¸° ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤ ì…ë¬¸ ìˆ˜ì—…ì—ì„œ ë°°ìš´ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ë§Œë“¤ì–´ ì¡Œìœ¼ë©°, ì¶”í›„ ê°œì¸ ë¸”ë¡œê·¸ë¡œ í™•ì¥í•  ì˜ˆì •ì…ë‹ˆë‹¤.\nPortfolio ğŸ’» About me  ì´ì²­íŒŒ Lee Chungpa E-mail: leechungpa@gmail.com ì‚¬ìš© ê°€ëŠ¥ ì–¸ì–´ : Python, R, SQL ì—°ì„¸ëŒ€í•™êµ ì‘ìš©í†µê³„í•™ê³¼ 4í•™ë…„ ì¬í•™ì¤‘ ì—°ì„¸ëŒ€í•™êµ ê³µì‹ì–¸ë¡ ì‚¬ ì—°ì„¸ì¶˜ì¶” 116ê¸° (2015.09 ~ 2016.12)  ì‚¬ì§„ë¶€ ê¸°ì   ì—°ì„¸ëŒ€í•™êµ êµ­ì œìº í¼ìŠ¤ ìœ¤ë™ì£¼ í•˜ìš°ìŠ¤ RA (2019.03 ~ 2019.12)  ğŸ“ Study and Project ì£¼ê°„ ìŒì›ì°¨íŠ¸ ì˜ˆì¸¡ Python, R, Machine Learning\nGithub Link\nìŒì› ë°ì´í„°ë¥¼ í™œìš©í•œ ìŒì›ìˆœìœ„ ì˜ˆì¸¡ í”„ë¡œì íŠ¸\n í˜„ì¬ëŠ” ë°ì´í„° í¬ë¡¤ë§ ì§„í–‰ì¤‘ ì¶”í›„ì— ëª¨ë¸ë§ì„ í†µí•´ ì˜ˆì¸¡ ëª¨ë¸ ë§Œë“¤ ì˜ˆì •  ğŸ“š Courses í˜„ì¬ê¹Œì§€ ìˆ˜ê°•í•œ ê³¼ëª© ë¦¬ìŠ¤íŠ¸ì…ë‹ˆë‹¤.\n  ì„ í˜•ëŒ€ìˆ˜\n  ë¯¸ì ë¶„í•™\n  í†µê³„í•™ì…ë¬¸\n  í†µê³„ë°©ë²•ë¡ \n  íšŒê·€ë¶„ì„\n  ì‹œê³„ì—´ë¶„ì„\n  ê¸ˆìœµë¦¬ìŠ¤í¬ê´€ë¦¬ì‹¤ë¬´ì™€í†µê³„í•™\n  ìˆ˜ë¦¬í†µê³„í•™(1)\n  ìˆ˜ë¦¬í†µê³„í•™(2)\n  ì´ë¡ í†µê³„í•™\n  ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤ë¥¼ìœ„í•œí™•ë¥ ê³¼ì •\n  ì»´í“¨í„°ìë£Œì²˜ë¦¬\n  ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤ì…ë¬¸\n  ë”¥ëŸ¬ë‹\n  ë°ì´í„°ë§ˆì´ë‹\n  ","description":"","tags":null,"title":"ì´ë ¥ì„œ","uri":"/about/"},{"categories":["R","data mining"],"content":"\rìë£Œ ë¶ˆëŸ¬ì˜¤ê¸°\rlibrary(readxl)\rairbnb \u003c- read_excel(\"data/airbnb.xlsx\")\rstr(airbnb)\r## tibble [74,111 x 29] (S3: tbl_df/tbl/data.frame)\r## $ id : num [1:74111] 6901257 6304928 7919400 13418779 3808709 ...\r## $ log_price : num [1:74111] 5.01 5.13 4.98 6.62 4.74 ...\r## $ property_type : chr [1:74111] \"Apartment\" \"Apartment\" \"Apartment\" \"House\" ...\r## $ room_type : chr [1:74111] \"Entire home/apt\" \"Entire home/apt\" \"Entire home/apt\" \"Entire home/apt\" ...\r## $ amenities : chr [1:74111] \"{\\\"Wireless Internet\\\",\\\"Air conditioning\\\",Kitchen,Heating,\\\"Family/kid friendly\\\",Essentials,\\\"Hair dryer\\\",I\"| __truncated__ \"{\\\"Wireless Internet\\\",\\\"Air conditioning\\\",Kitchen,Heating,\\\"Family/kid friendly\\\",Washer,Dryer,\\\"Smoke detect\"| __truncated__ \"{TV,\\\"Cable TV\\\",\\\"Wireless Internet\\\",\\\"Air conditioning\\\",Kitchen,Breakfast,\\\"Buzzer/wireless intercom\\\",Heat\"| __truncated__ \"{TV,\\\"Cable TV\\\",Internet,\\\"Wireless Internet\\\",Kitchen,\\\"Indoor fireplace\\\",\\\"Buzzer/wireless intercom\\\",Heati\"| __truncated__ ...\r## $ accommodates : num [1:74111] 3 7 5 4 2 2 3 2 2 2 ...\r## $ bathrooms : num [1:74111] 1 1 1 1 1 1 1 1 1 1 ...\r## $ bed_type : chr [1:74111] \"Real Bed\" \"Real Bed\" \"Real Bed\" \"Real Bed\" ...\r## $ cancellation_policy : chr [1:74111] \"strict\" \"strict\" \"moderate\" \"flexible\" ...\r## $ cleaning_fee : logi [1:74111] TRUE TRUE TRUE TRUE TRUE TRUE ...\r## $ city : chr [1:74111] \"NYC\" \"NYC\" \"NYC\" \"SF\" ...\r## $ description : chr [1:74111] \"Beautiful, sunlit brownstone 1-bedroom in the loveliest neighborhood in Brooklyn. Blocks from the promenade and\"| __truncated__ \"Enjoy travelling during your stay in Manhattan. My place is centrally located near Times Square and Central Par\"| __truncated__ \"The Oasis comes complete with a full backyard with outdoor furniture to make the most of this summer vacation!!\"| __truncated__ \"This light-filled home-away-from-home is super clean and comes with all of the modern amenities travelers could\"| __truncated__ ...\r## $ first_review : POSIXct[1:74111], format: \"2018-06-16\" \"2005-08-17\" ...\r## $ host_has_profile_pic : chr [1:74111] \"t\" \"t\" \"t\" \"t\" ...\r## $ host_identity_verified: chr [1:74111] \"t\" \"f\" \"t\" \"t\" ...\r## $ host_response_rate : num [1:74111] NA 1 1 NA 1 1 1 1 1 1 ...\r## $ host_since : POSIXct[1:74111], format: \"2026-03-12\" \"2019-06-17\" ...\r## $ instant_bookable : chr [1:74111] \"f\" \"t\" \"t\" \"f\" ...\r## $ last_review : POSIXct[1:74111], format: \"2018-07-16\" \"2023-09-17\" ...\r## $ latitude : num [1:74111] 40.7 40.8 40.8 37.8 38.9 ...\r## $ longitude : num [1:74111] -74 -74 -73.9 -122.4 -77 ...\r## $ name : chr [1:74111] \"Beautiful brownstone 1-bedroom\" \"Superb 3BR Apt Located Near Times Square\" \"The Garden Oasis\" \"Beautiful Flat in the Heart of SF!\" ...\r## $ neighbourhood : chr [1:74111] \"Brooklyn Heights\" \"Hell's Kitchen\" \"Harlem\" \"Lower Haight\" ...\r## $ number_of_reviews : num [1:74111] 2 6 10 0 4 3 15 9 159 2 ...\r## $ review_scores_rating : num [1:74111] 100 93 92 NA 40 100 97 93 99 90 ...\r## $ thumbnail_url : chr [1:74111] \"https://a0.muscache.com/im/pictures/6d7cbbf7-c034-459c-bc82-6522c957627c.jpg?aki_policy=small\" \"https://a0.muscache.com/im/pictures/348a55fe-4b65-452a-b48a-bfecb3b58a66.jpg?aki_policy=small\" \"https://a0.muscache.com/im/pictures/6fae5362-9e3a-4fa9-aa54-bbd5ea26538d.jpg?aki_policy=small\" \"https://a0.muscache.com/im/pictures/72208dad-9c86-41ea-a735-43d933111063.jpg?aki_policy=small\" ...\r## $ zipcode : chr [1:74111] \"11201\" \"10019\" \"10027\" \"94117\" ...\r## $ bedrooms : num [1:74111] 1 3 1 2 0 1 1 1 1 1 ...\r## $ beds : num [1:74111] 1 3 3 2 1 1 1 1 1 1 ...\r\rë°ì´í„° ì „ì²˜ë¦¬\râ€œproperty_typeâ€ì€ â€˜Houseâ€™, â€˜Apartmentâ€™, â€™Otherâ€™ ë“±ì˜ 3ë²”ì£¼ë¡œ ë³€í™˜í•˜ì‹œì˜¤.\rattach(airbnb)\rairbnb$property_type[!(property_type=='House'| property_type=='Apartment')] = \"Other\"\rairbnb$property_type \u003c- as.factor(airbnb$property_type)\rlevels(airbnb$property_type)\r## [1] \"Apartment\" \"House\" \"Other\"\r\râ€œbed_typeâ€ì€ â€˜Bedâ€™, â€˜Otherâ€™ ë“±ì˜ 2ë²”ì£¼ë¡œ ë³€í™˜í•˜ì‹œì˜¤.\rReal Bedì™€ Airbed ëŠ” Bedë¡œ, ë‚˜ë¨¸ì§€ëŠ” Otherë¡œ ë³€í™˜í•˜ì˜€ë‹¤.\nairbnb$bed_type[(bed_type=='Airbed'| bed_type=='Real Bed')] = \"Bed\"\rairbnb$bed_type[!(bed_type=='Airbed'| bed_type=='Real Bed')] = \"Other\"\rairbnb$bed_type \u003c- as.factor(airbnb$bed_type)\rlevels(airbnb$bed_type)\r## [1] \"Bed\" \"Other\"\rdetach(airbnb)\r\râ€œnumber_of_reviewsâ€ê°€ 11ê°œ ì´ìƒì¸ ë°ì´í„°ë§Œ ì¶”ì¶œí•´ì„œ ë¶„ì„ì— ì‚¬ìš©í•˜ì‹œì˜¤.\rairbnb \u003c- airbnb[airbnb$number_of_reviews\u003e=11 , 1:ncol(airbnb)]\r\râ€˜ê°€ê²©ë¹„(price_ratio)â€™ ë³€ìˆ˜ë¥¼ ìƒì„±í•˜ì‹œì˜¤.\rairbnb$log_price \u003c- exp(airbnb$log_price)\rmean_price \u003c- aggregate(log_price ~ city, airbnb, mean)\rnames(mean_price) \u003c-c (\"city\",\"mean_price\")\rf_airbnb \u003c- merge(x =airbnb,y=mean_price,by=\"city\",all.x=T)\rf_airbnb$price_ratio \u003c- f_airbnb$log_price/f_airbnb$mean_price*100\r\r\rë°ì´í„° ë¶„ì„\r1. â€œê°€ê²©ë¹„(price_ratio)â€ ë³€ìˆ˜ì˜ í‰ê· ê³¼ í‘œì¤€í¸ì°¨ë¥¼ ë‹µí•˜ì‹œì˜¤.\rmean(f_airbnb$price_ratio)\r## [1] 100\rsd(f_airbnb$price_ratio)\r## [1] 83.72338\r\r2. â€œê°€ê²©ë¹„(price_ratio)â€ë¥¼ ì¢…ì†ë³€ìˆ˜ë¡œ í•˜ì—¬ ì„ í˜•íšŒê·€ë¶„ì„ì„ ìˆ˜í–‰í•˜ì‹œì˜¤.\rë¨¼ì € ì‹œí–‰ì— ì•ì„œ ë¶ˆí•„ìš”í•œ ë³€ìˆ˜ë¥¼ ì œê±°í•œë‹¤. ì œê±°í•œ ê²ƒë“¤ì€ ì•„ë˜ì™€ ê°™ë‹¤.\ramenitiesë‚˜ descriptionì˜ ê²½ìš° ê¸¸ì´ë¡œ ë³€í™˜í•˜ì—¬ ë¶„ì„í•˜ì˜€ìœ¼ë‚˜ í° ì˜ë¯¸ê°€ ì—†ì–´ ì œê±°í•˜ê³  ë¶„ì„í•˜ì˜€ë‹¤.\r(yë³€ìˆ˜ ê³„ì‚°ì— í•„ìš”í–ˆë˜ ê²ƒë“¤ ë° urlì´ë‚˜ ì„¤ëª…ê°™ì´ ì˜ë¯¸ì—†ëŠ” ê²ƒë“¤ì„ ì œì™¸í•œë‹¤.)\n\rdescription\n\ramenities\n\rname\n\rneighbourhood\n\rthumbnail_url\n\rid\n\rlog_price\n\rmean_price\n\r\rf_df \u003c- subset(f_airbnb, select = -c(description, amenities, name, neighbourhood, thumbnail_url, id, log_price, mean_price))\rcharacterë¥¼ factorë¡œ ë³€í™˜í•œë‹¤.\rìˆœì„œê°€ ìˆëŠ” cancellation_policyì˜ ê²½ìš° ìˆœì„œë¥¼ ì¤€ë‹¤.\nfind_char_col\u003c-NA\rfor (i in 1:ncol(f_df)){\rfind_char_col[i] \u003c- is.character(f_df[,i])\r}\rchar_col \u003c- colnames(f_df)[find_char_col]\rf_df[char_col] \u003c- lapply(f_df[char_col] , factor)\rf_df$cleaning_fee \u003c- as.factor(f_df$cleaning_fee)\rcancellation_policyì—ì„œë„ â€œsuper_strict_60â€ëŠ” 2ê°œë¿ì´ë¯€ë¡œâ€œsuper_strict_30â€ì— í¬í•¨ì‹œì¼°ë‹¤. (ì¦‰ super_strict_30ëŠ” super_strict_30+ë¥¼ ì˜ë¯¸í•œë‹¤.)\nwhich(f_df$cancellation_policy == \"super_strict_60\")\r## [1] 6558 13642\rf_df$cancellation_policy[which(f_df$cancellation_policy == \"super_strict_60\")] \u003c- \"super_strict_30\"\rf_df$cancellation_policy \u003c- factor(f_df$cancellation_policy,levels=c(\"flexible\", \"moderate\", \"strict\", \"super_strict_30\"), order=T)\rë¨¼ì € ê°ê°ì˜ plotì„ ê·¸ë ¤ë³¸ë‹¤. (ê²°ê³¼ëŠ” ìƒëµ eval=FALSE)\nfor (i in 1:(ncol(f_df)-1)) {\rplot(f_df$price_ratio~f_df[[i]],xlab=colnames(f_df)[i])\r}\rëŒ€ëµì ìœ¼ë¡œ ëˆˆìœ¼ë¡œ ë³´ê¸°ì— ì°¨ì´ê°€ ë‚˜íƒ€ë‚˜ëŠ” ê²ƒì€ ë‹¤ìŒê³¼ ê°™ë‹¤. (ì§„í•œ ê²ƒì€ ë”ìš± ë‘ë“œëŸ¬ ì§„ ê²ƒ)\n\rroom_type\raccommodates\rbathrooms\rbed_type\rcancellation_policy\rcleaning_fee\rhost_has_profile_pic\rhost_identity_verified\rhost_response_rate\rinstant_bookable\rlatitude\rlongitude\rnumber_of_reviews\rreview_scores_rating\rbedrooms\rbeds\r\rê·¸ëŸ°ë° latitudeì™€ longitudeëŠ” ì‚¬ì‹¤ìƒ zipcodeì— ê·¸ ë°ì´í„°ì— ì˜ë¯¸ê°€ ì–´ëŠì •ë„ í¬í•¨ëœë‹¤ê³  íŒë‹¨í•˜ì—¬ ì œê±°í•˜ì˜€ë‹¤.\në˜í•œ zipcodeëŠ” ë„ˆë¬´ ìì„¸í•˜ë¯€ë¡œ ë¶„ì„ì˜ í¸ì˜ìƒ ì•ì˜ 2ìë¦¬ë§Œ ì‚¬ìš©í•˜ì˜€ë‹¤. (cityëŠ” ì´ zipcodeì— í¬í•¨ë˜ë¯€ë¡œ ìƒëµí•˜ì˜€ë‹¤.)\nê·¸ë¦¬ê³  host_has_profile_picì˜ ê²½ìš° fëŠ” 28ê°œë¿ìœ¼ë¡œ ë§¤ìš° ì ìœ¼ë¯€ë¡œ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.\nsummary( lm( price_ratio ~ latitude, data=f_df))\r## ## Call:\r## lm(formula = price_ratio ~ latitude, data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -92.71 -47.41 -22.56 19.19 1323.76 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) 9.996e+01 6.061e+00 16.492 \u003c2e-16 ***\r## latitude 9.344e-04 1.574e-01 0.006 0.995 ## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 83.72 on 29014 degrees of freedom\r## Multiple R-squared: 1.215e-09, Adjusted R-squared: -3.446e-05 ## F-statistic: 3.525e-05 on 1 and 29014 DF, p-value: 0.9953\rsummary( lm( price_ratio ~ longitude, data=f_df))\r## ## Call:\r## lm(formula = price_ratio ~ longitude, data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -92.67 -47.36 -22.63 19.12 1323.69 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) 99.765008 2.164951 46.082 \u003c2e-16 ***\r## longitude -0.002513 0.022547 -0.111 0.911 ## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 83.72 on 29014 degrees of freedom\r## Multiple R-squared: 4.281e-07, Adjusted R-squared: -3.404e-05 ## F-statistic: 0.01242 on 1 and 29014 DF, p-value: 0.9113\rf_df$zipcode \u003c- as.factor(substr(f_airbnb$zipcode,1,2))\rtable(f_df$host_has_profile_pic)\r## ## f t ## 28 28924\rê·¸ë˜ì„œ ì´ë¥¼ ì œì™¸í•œ ë‹¤ìŒì„ ë¶„ì„ë³€ìˆ˜ë¡œ í•œë‹¤.\n\rroom_type\rproperty_type\raccommodates\rbathrooms\rbed_type\rcancellation_policy\rcleaning_fee\rhost_identity_verified\rhost_response_rate\rinstant_bookable\rfirst_review\rnumber_of_reviews\rhost_since\rreview_scores_rating\rlast_review\rbedrooms\n\rbeds\rzipcode\r\rì •í™•íˆ í•˜ê¸° ìœ„í•´ trellis plotì„ ê·¸ë ¤ë³´ì•˜ë‹¤.\nlibrary(lattice)\rmypanel \u003c- function(x, y) {\rpanel.xyplot(x, y)\rpanel.loess(x, y, col=\"red\", lwd=2, lty=2) }\rxyplot(price_ratio ~ room_type, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ accommodates, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ bathrooms, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ bed_type, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ cancellation_policy, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ cleaning_fee, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ host_identity_verified , data=f_df,panel=mypanel)\rxyplot(price_ratio ~ host_response_rate, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ instant_bookable , data=f_df,panel=mypanel)\rxyplot(price_ratio ~ number_of_reviews, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ review_scores_rating, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ bedrooms, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ beds, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ zipcode, data=f_df,panel=mypanel)\rxyplot(price_ratio ~ last_review , data=f_df,panel=mypanel)\rxyplot(price_ratio ~ host_since , data=f_df,panel=mypanel)\rxyplot(price_ratio ~ first_review , data=f_df,panel=mypanel)\rxyplot(price_ratio ~ property_type , data=f_df,panel=mypanel)\rì´ì œ 18ê°œì˜ ê°’ë“¤ì„ ì´ìš©í•´ ì„ í˜•íšŒê·€ë¶„ì„ì„ ì‹¤ì‹œí•œë‹¤. ê·¸ì „ì— ê²°ì¸¡ì¹˜NAê°€ í¬í•¨ëœ í–‰ì€ ì œê±°í•˜ê³  ì‹¤ì‹œí•œë‹¤.\nf_df = na.omit(f_df)\rlm1 = lm(price_ratio ~ room_type + property_type + accommodates + bathrooms + bed_type + cancellation_policy + cleaning_fee + host_identity_verified + host_response_rate + instant_bookable + first_review + number_of_reviews + host_since + review_scores_rating + last_review + bedrooms + beds + zipcode , data = f_df)\rsummary(lm1)\r## ## Call:\r## lm(formula = price_ratio ~ room_type + property_type + accommodates + ## bathrooms + bed_type + cancellation_policy + cleaning_fee + ## host_identity_verified + host_response_rate + instant_bookable + ## first_review + number_of_reviews + host_since + review_scores_rating + ## last_review + bedrooms + beds + zipcode, data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -310.42 -25.81 -2.43 18.11 995.55 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) -9.898e+01 8.209e+00 -12.058 \u003c 2e-16 ***\r## room_typePrivate room -4.603e+01 8.669e-01 -53.089 \u003c 2e-16 ***\r## room_typeShared room -7.641e+01 2.538e+00 -30.105 \u003c 2e-16 ***\r## property_typeHouse 4.183e+00 9.150e-01 4.572 4.85e-06 ***\r## property_typeOther 6.771e+00 1.112e+00 6.087 1.17e-09 ***\r## accommodates 8.450e+00 3.292e-01 25.671 \u003c 2e-16 ***\r## bathrooms 3.515e+01 7.626e-01 46.087 \u003c 2e-16 ***\r## bed_typeOther 1.908e+00 2.279e+00 0.837 0.402372 ## cancellation_policy.L 5.800e+01 6.962e+00 8.330 \u003c 2e-16 ***\r## cancellation_policy.Q 3.702e+01 5.201e+00 7.117 1.13e-12 ***\r## cancellation_policy.C 1.434e+01 2.375e+00 6.039 1.57e-09 ***\r## cleaning_feeTRUE -3.377e+00 1.006e+00 -3.357 0.000789 ***\r## host_identity_verifiedt 2.158e+00 8.533e-01 2.529 0.011431 * ## host_response_rate -1.935e+01 3.508e+00 -5.516 3.50e-08 ***\r## instant_bookablet -4.545e+00 7.645e-01 -5.944 2.81e-09 ***\r## first_review -3.548e-11 5.496e-10 -0.065 0.948532 ## number_of_reviews -4.118e-02 7.218e-03 -5.705 1.17e-08 ***\r## host_since 1.791e-10 5.406e-10 0.331 0.740412 ## review_scores_rating 2.022e+00 7.722e-02 26.187 \u003c 2e-16 ***\r## last_review 7.622e-10 4.587e-10 1.662 0.096593 . ## bedrooms 2.588e+01 6.572e-01 39.373 \u003c 2e-16 ***\r## beds -3.614e+00 4.786e-01 -7.551 4.46e-14 ***\r## zipcode11 -4.252e+01 1.112e+00 -38.245 \u003c 2e-16 ***\r## zipcode1m -3.478e+01 5.632e+01 -0.617 0.536912 ## zipcode20 -4.165e+01 1.547e+00 -26.924 \u003c 2e-16 ***\r## zipcode21 -3.428e+01 1.739e+00 -19.714 \u003c 2e-16 ***\r## zipcode22 -1.917e+01 8.438e+00 -2.272 0.023073 * ## zipcode24 -4.208e+01 5.633e+01 -0.747 0.454991 ## zipcode60 -4.246e+01 1.562e+00 -27.184 \u003c 2e-16 ***\r## zipcode90 -3.486e+01 1.107e+00 -31.483 \u003c 2e-16 ***\r## zipcode91 -5.649e+01 1.742e+00 -32.428 \u003c 2e-16 ***\r## zipcode92 -6.254e+01 5.634e+01 -1.110 0.266986 ## zipcode93 -7.250e+01 1.567e+01 -4.628 3.71e-06 ***\r## zipcode94 -3.287e+01 1.418e+00 -23.189 \u003c 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 56.31 on 27002 degrees of freedom\r## Multiple R-squared: 0.5462, Adjusted R-squared: 0.5456 ## F-statistic: 984.8 on 33 and 27002 DF, p-value: \u003c 2.2e-16\rìœ„ë¥¼ ë³´ë©´ ìœ ì˜ë¯¸í•˜ì§€ ì•Šì€ p-valueê°€ ë§ë‹¤. ì´ì œ stepwiseë¥¼ í•´ì„œ ì œê±°í•œë‹¤.\nlm2 = step(lm1, direction = 'both')\r## Start: AIC=217990.5\r## price_ratio ~ room_type + property_type + accommodates + bathrooms + ## bed_type + cancellation_policy + cleaning_fee + host_identity_verified + ## host_response_rate + instant_bookable + first_review + number_of_reviews + ## host_since + review_scores_rating + last_review + bedrooms + ## beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## - first_review 1 13 85615864 217989\r## - host_since 1 348 85616199 217989\r## - bed_type 1 2223 85618074 217989\r## \u003cnone\u003e 85615851 217990\r## - last_review 1 8755 85624606 217991\r## - host_identity_verified 1 20286 85636137 217995\r## - cleaning_fee 1 35736 85651586 218000\r## - host_response_rate 1 96468 85712319 218019\r## - number_of_reviews 1 103211 85719062 218021\r## - instant_bookable 1 112043 85727894 218024\r## - property_type 2 144262 85760113 218032\r## - beds 1 180785 85796636 218046\r## - cancellation_policy 3 503380 86119231 218143\r## - accommodates 1 2089553 87705404 218640\r## - review_scores_rating 1 2174363 87790214 218667\r## - bedrooms 1 4915304 90531154 219498\r## - zipcode 12 6500593 92116444 219945\r## - bathrooms 1 6734757 92350607 220036\r## - room_type 2 10116125 95731976 221006\r## ## Step: AIC=217988.5\r## price_ratio ~ room_type + property_type + accommodates + bathrooms + ## bed_type + cancellation_policy + cleaning_fee + host_identity_verified + ## host_response_rate + instant_bookable + number_of_reviews + ## host_since + review_scores_rating + last_review + bedrooms + ## beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## - host_since 1 349 85616213 217987\r## - bed_type 1 2224 85618088 217987\r## \u003cnone\u003e 85615864 217989\r## - last_review 1 8763 85624627 217989\r## + first_review 1 13 85615851 217990\r## - host_identity_verified 1 20283 85636147 217993\r## - cleaning_fee 1 35747 85651611 217998\r## - host_response_rate 1 96497 85712361 218017\r## - number_of_reviews 1 103228 85719092 218019\r## - instant_bookable 1 112052 85727916 218022\r## - property_type 2 144250 85760114 218030\r## - beds 1 180804 85796668 218044\r## - cancellation_policy 3 503371 86119235 218141\r## - accommodates 1 2089584 87705448 218638\r## - review_scores_rating 1 2174743 87790607 218665\r## - bedrooms 1 4915310 90531174 219496\r## - zipcode 12 6500955 92116819 219943\r## - bathrooms 1 6734768 92350632 220034\r## - room_type 2 10116180 95732044 221004\r## ## Step: AIC=217986.6\r## price_ratio ~ room_type + property_type + accommodates + bathrooms + ## bed_type + cancellation_policy + cleaning_fee + host_identity_verified + ## host_response_rate + instant_bookable + number_of_reviews + ## review_scores_rating + last_review + bedrooms + beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## - bed_type 1 2238 85618451 217985\r## \u003cnone\u003e 85616213 217987\r## - last_review 1 8739 85624953 217987\r## + host_since 1 349 85615864 217989\r## + first_review 1 14 85616199 217989\r## - host_identity_verified 1 20254 85636467 217991\r## - cleaning_fee 1 35785 85651998 217996\r## - host_response_rate 1 96522 85712735 218015\r## - number_of_reviews 1 103088 85719301 218017\r## - instant_bookable 1 112180 85728393 218020\r## - property_type 2 144324 85760538 218028\r## - beds 1 180830 85797044 218042\r## - cancellation_policy 3 503161 86119374 218139\r## - accommodates 1 2089343 87705556 218636\r## - review_scores_rating 1 2174719 87790932 218663\r## - bedrooms 1 4916145 90532358 219494\r## - zipcode 12 6500763 92116976 219941\r## - bathrooms 1 6734710 92350923 220032\r## - room_type 2 10120958 95737171 221003\r## ## Step: AIC=217985.3\r## price_ratio ~ room_type + property_type + accommodates + bathrooms + ## cancellation_policy + cleaning_fee + host_identity_verified + ## host_response_rate + instant_bookable + number_of_reviews + ## review_scores_rating + last_review + bedrooms + beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## \u003cnone\u003e 85618451 217985\r## - last_review 1 8687 85627138 217986\r## + bed_type 1 2238 85616213 217987\r## + host_since 1 363 85618088 217987\r## + first_review 1 15 85618435 217987\r## - host_identity_verified 1 20365 85638815 217990\r## - cleaning_fee 1 35751 85654202 217995\r## - host_response_rate 1 96483 85714934 218014\r## - number_of_reviews 1 102833 85721284 218016\r## - instant_bookable 1 113036 85731487 218019\r## - property_type 2 144046 85762497 218027\r## - beds 1 182147 85800598 218041\r## - cancellation_policy 3 501866 86120317 218137\r## - accommodates 1 2090219 87708670 218635\r## - review_scores_rating 1 2175653 87794104 218662\r## - bedrooms 1 4917159 90535610 219493\r## - zipcode 12 6501272 92119723 219940\r## - bathrooms 1 6732473 92350924 220030\r## - room_type 2 10195031 95813482 221023\rsummary(lm2)\r## ## Call:\r## lm(formula = price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + ## host_response_rate + instant_bookable + number_of_reviews + ## review_scores_rating + last_review + bedrooms + beds + zipcode, ## data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -310.29 -25.79 -2.43 18.08 995.53 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) -9.878e+01 8.141e+00 -12.134 \u003c 2e-16 ***\r## room_typePrivate room -4.600e+01 8.659e-01 -53.122 \u003c 2e-16 ***\r## room_typeShared room -7.604e+01 2.499e+00 -30.431 \u003c 2e-16 ***\r## property_typeHouse 4.171e+00 9.148e-01 4.560 5.13e-06 ***\r## property_typeOther 6.772e+00 1.112e+00 6.088 1.16e-09 ***\r## accommodates 8.451e+00 3.291e-01 25.676 \u003c 2e-16 ***\r## bathrooms 3.513e+01 7.624e-01 46.081 \u003c 2e-16 ***\r## cancellation_policy.L 5.795e+01 6.961e+00 8.324 \u003c 2e-16 ***\r## cancellation_policy.Q 3.698e+01 5.200e+00 7.112 1.17e-12 ***\r## cancellation_policy.C 1.434e+01 2.374e+00 6.039 1.57e-09 ***\r## cleaning_feeTRUE -3.377e+00 1.006e+00 -3.358 0.000786 ***\r## host_identity_verifiedt 2.162e+00 8.532e-01 2.534 0.011269 * ## host_response_rate -1.935e+01 3.507e+00 -5.516 3.49e-08 ***\r## instant_bookablet -4.563e+00 7.642e-01 -5.971 2.39e-09 ***\r## number_of_reviews -4.110e-02 7.216e-03 -5.695 1.25e-08 ***\r## review_scores_rating 2.023e+00 7.721e-02 26.196 \u003c 2e-16 ***\r## last_review 7.592e-10 4.587e-10 1.655 0.097875 . ## bedrooms 2.588e+01 6.572e-01 39.382 \u003c 2e-16 ***\r## beds -3.626e+00 4.784e-01 -7.580 3.58e-14 ***\r## zipcode11 -4.252e+01 1.112e+00 -38.246 \u003c 2e-16 ***\r## zipcode1m -3.483e+01 5.632e+01 -0.618 0.536327 ## zipcode20 -4.165e+01 1.547e+00 -26.930 \u003c 2e-16 ***\r## zipcode21 -3.428e+01 1.739e+00 -19.714 \u003c 2e-16 ***\r## zipcode22 -1.922e+01 8.438e+00 -2.278 0.022721 * ## zipcode24 -4.215e+01 5.632e+01 -0.748 0.454229 ## zipcode60 -4.248e+01 1.562e+00 -27.202 \u003c 2e-16 ***\r## zipcode90 -3.486e+01 1.107e+00 -31.487 \u003c 2e-16 ***\r## zipcode91 -5.649e+01 1.742e+00 -32.430 \u003c 2e-16 ***\r## zipcode92 -6.251e+01 5.634e+01 -1.110 0.267158 ## zipcode93 -7.254e+01 1.566e+01 -4.631 3.66e-06 ***\r## zipcode94 -3.287e+01 1.417e+00 -23.192 \u003c 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 56.31 on 27005 degrees of freedom\r## Multiple R-squared: 0.5462, Adjusted R-squared: 0.5457 ## F-statistic: 1083 on 30 and 27005 DF, p-value: \u003c 2.2e-16\rì´í›„ ë¶„ì„ì—ì„œ p-valueê°€ ìœ ì˜ë¯¸í•˜ì§€ ì•Šì€ last_review ë¥¼ ì œê±°í•˜ê³  ì‹¤ì‹œí•œë‹¤.\n\r\ríšŒê·€ì§„ë‹¨\rplot(lm2,which=1)\rplot(lm2,which=2)\rì”ì°¨ì—ì„œ ë©”ê°€í° í˜•íƒœê°€ ë‚˜íƒ€ë‚¨ì„ ì•Œìˆ˜ ìˆë‹¤. ë˜í•œ QQí”Œëë„ ë¬¸ì œê°€ ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. Yë³€ìˆ˜ì˜ ë³€í™˜ì˜ í•„ìš”ì„±ì´ ìˆìœ¼ë¯€ë¡œ Yâ€™=logYë¡œ ë³€í™˜í•˜ì˜€ë‹¤.\nf_df$log_price_ratio \u003c- log(f_df$price_ratio)\rlm3 = lm(log_price_ratio ~ room_type + property_type + accommodates + bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + host_response_rate + instant_bookable + number_of_reviews + review_scores_rating + bedrooms + beds + zipcode, data = f_df)\rlm4 = step(lm3, direction = 'both')\r## Start: AIC=-54314.95\r## log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + ## host_response_rate + instant_bookable + number_of_reviews + ## review_scores_rating + bedrooms + beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## - cleaning_fee 1 0.00 3618.2 -54317\r## - number_of_reviews 1 0.08 3618.2 -54316\r## \u003cnone\u003e 3618.2 -54315\r## - host_identity_verified 1 1.21 3619.4 -54308\r## - host_response_rate 1 4.82 3623.0 -54281\r## - instant_bookable 1 7.14 3625.3 -54264\r## - property_type 2 7.92 3626.1 -54260\r## - cancellation_policy 3 21.45 3639.6 -54161\r## - beds 1 21.10 3639.3 -54160\r## - bathrooms 1 79.59 3697.7 -53729\r## - accommodates 1 131.11 3749.3 -53355\r## - review_scores_rating 1 188.21 3806.4 -52946\r## - bedrooms 1 216.57 3834.7 -52745\r## - zipcode 12 462.42 4080.6 -51087\r## - room_type 2 1779.04 5397.2 -43507\r## ## Step: AIC=-54316.91\r## log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + host_identity_verified + ## host_response_rate + instant_bookable + number_of_reviews + ## review_scores_rating + bedrooms + beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## - number_of_reviews 1 0.08 3618.2 -54318\r## \u003cnone\u003e 3618.2 -54317\r## + cleaning_fee 1 0.00 3618.2 -54315\r## - host_identity_verified 1 1.21 3619.4 -54310\r## - host_response_rate 1 4.84 3623.0 -54283\r## - instant_bookable 1 7.16 3625.3 -54265\r## - property_type 2 7.92 3626.1 -54262\r## - beds 1 21.11 3639.3 -54162\r## - cancellation_policy 3 21.72 3639.9 -54161\r## - bathrooms 1 79.62 3697.8 -53730\r## - accommodates 1 131.42 3749.6 -53354\r## - review_scores_rating 1 188.30 3806.5 -52947\r## - bedrooms 1 216.56 3834.7 -52747\r## - zipcode 12 462.51 4080.7 -51089\r## - room_type 2 1827.08 5445.2 -43269\r## ## Step: AIC=-54318.33\r## log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + host_identity_verified + ## host_response_rate + instant_bookable + review_scores_rating + ## bedrooms + beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## \u003cnone\u003e 3618.2 -54318\r## + number_of_reviews 1 0.08 3618.2 -54317\r## + cleaning_fee 1 0.00 3618.2 -54316\r## - host_identity_verified 1 1.16 3619.4 -54312\r## - host_response_rate 1 4.95 3623.2 -54283\r## - instant_bookable 1 7.27 3625.5 -54266\r## - property_type 2 7.97 3626.2 -54263\r## - cancellation_policy 3 21.66 3639.9 -54163\r## - beds 1 21.15 3639.4 -54163\r## - bathrooms 1 79.88 3698.1 -53730\r## - accommodates 1 131.34 3749.6 -53356\r## - review_scores_rating 1 188.57 3806.8 -52947\r## - bedrooms 1 218.14 3836.4 -52738\r## - zipcode 12 462.64 4080.9 -51089\r## - room_type 2 1828.54 5446.8 -43264\rê·¸ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.\nsummary(lm4)\r## ## Call:\r## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + host_identity_verified + ## host_response_rate + instant_bookable + review_scores_rating + ## bedrooms + beds + zipcode, data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -2.51557 -0.22551 -0.00287 0.22588 2.52586 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) 2.8112298 0.0525988 53.447 \u003c 2e-16 ***\r## room_typePrivate room -0.5855993 0.0055699 -105.136 \u003c 2e-16 ***\r## room_typeShared room -1.1375240 0.0161312 -70.517 \u003c 2e-16 ***\r## property_typeHouse -0.0183360 0.0059407 -3.087 0.00203 ** ## property_typeOther 0.0422432 0.0072288 5.844 5.16e-09 ***\r## accommodates 0.0668736 0.0021358 31.311 \u003c 2e-16 ***\r## bathrooms 0.1209281 0.0049524 24.418 \u003c 2e-16 ***\r## cancellation_policy.L 0.2933262 0.0452494 6.482 9.18e-11 ***\r## cancellation_policy.Q 0.1616865 0.0337823 4.786 1.71e-06 ***\r## cancellation_policy.C 0.0664165 0.0154332 4.303 1.69e-05 ***\r## host_identity_verifiedt 0.0162382 0.0055087 2.948 0.00320 ** ## host_response_rate -0.1381528 0.0227264 -6.079 1.23e-09 ***\r## instant_bookablet -0.0365163 0.0049570 -7.367 1.80e-13 ***\r## review_scores_rating 0.0188152 0.0005015 37.518 \u003c 2e-16 ***\r## bedrooms 0.1719812 0.0042620 40.352 \u003c 2e-16 ***\r## beds -0.0390361 0.0031066 -12.566 \u003c 2e-16 ***\r## zipcode11 -0.3585074 0.0072259 -49.614 \u003c 2e-16 ***\r## zipcode1m -0.3950436 0.3661121 -1.079 0.28059 ## zipcode20 -0.2976181 0.0100374 -29.651 \u003c 2e-16 ***\r## zipcode21 -0.2358253 0.0112927 -20.883 \u003c 2e-16 ***\r## zipcode22 -0.1539659 0.0548451 -2.807 0.00500 ** ## zipcode24 -0.6528374 0.3661251 -1.783 0.07458 . ## zipcode60 -0.3329465 0.0101308 -32.865 \u003c 2e-16 ***\r## zipcode90 -0.2835116 0.0071819 -39.476 \u003c 2e-16 ***\r## zipcode91 -0.5014514 0.0112977 -44.385 \u003c 2e-16 ***\r## zipcode92 -0.8951543 0.3661830 -2.445 0.01451 * ## zipcode93 -0.6850067 0.1017839 -6.730 1.73e-11 ***\r## zipcode94 -0.2315125 0.0091763 -25.229 \u003c 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.366 on 27008 degrees of freedom\r## Multiple R-squared: 0.6588, Adjusted R-squared: 0.6584 ## F-statistic: 1931 on 27 and 27008 DF, p-value: \u003c 2.2e-16\rplot(lm4,which=1)\rplot(lm4,which=2)\r## Warning: not plotting observations with leverage one:\r## 1413, 8437, 20636\rì”ì°¨ì˜ íŒ¨í„´ì´ ì–´ëŠì •ë„ ê°ì†Œí•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.\nsummary(lm3)\r## ## Call:\r## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + ## host_response_rate + instant_bookable + number_of_reviews + ## review_scores_rating + bedrooms + beds + zipcode, data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -2.51722 -0.22532 -0.00299 0.22586 2.52411 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) 2.813e+00 5.270e-02 53.368 \u003c 2e-16 ***\r## room_typePrivate room -5.856e-01 5.629e-03 -104.034 \u003c 2e-16 ***\r## room_typeShared room -1.138e+00 1.624e-02 -70.065 \u003c 2e-16 ***\r## property_typeHouse -1.814e-02 5.946e-03 -3.051 0.00228 ** ## property_typeOther 4.224e-02 7.230e-03 5.842 5.21e-09 ***\r## accommodates 6.693e-02 2.140e-03 31.282 \u003c 2e-16 ***\r## bathrooms 1.208e-01 4.956e-03 24.374 \u003c 2e-16 ***\r## cancellation_policy.L 2.931e-01 4.525e-02 6.477 9.49e-11 ***\r## cancellation_policy.Q 1.610e-01 3.380e-02 4.764 1.91e-06 ***\r## cancellation_policy.C 6.631e-02 1.543e-02 4.296 1.74e-05 ***\r## cleaning_feeTRUE -1.157e-03 6.536e-03 -0.177 0.85946 ## host_identity_verifiedt 1.670e-02 5.546e-03 3.011 0.00261 ** ## host_response_rate -1.368e-01 2.280e-02 -5.998 2.02e-09 ***\r## instant_bookablet -3.627e-02 4.968e-03 -7.301 2.93e-13 ***\r## number_of_reviews -3.647e-05 4.691e-05 -0.778 0.43683 ## review_scores_rating 1.881e-02 5.018e-04 37.481 \u003c 2e-16 ***\r## bedrooms 1.718e-01 4.272e-03 40.205 \u003c 2e-16 ***\r## beds -3.903e-02 3.110e-03 -12.549 \u003c 2e-16 ***\r## zipcode11 -3.585e-01 7.226e-03 -49.616 \u003c 2e-16 ***\r## zipcode1m -3.950e-01 3.661e-01 -1.079 0.28064 ## zipcode20 -2.975e-01 1.004e-02 -29.637 \u003c 2e-16 ***\r## zipcode21 -2.355e-01 1.130e-02 -20.839 \u003c 2e-16 ***\r## zipcode22 -1.539e-01 5.485e-02 -2.805 0.00503 ** ## zipcode24 -6.537e-01 3.661e-01 -1.785 0.07423 . ## zipcode60 -3.330e-01 1.014e-02 -32.848 \u003c 2e-16 ***\r## zipcode90 -2.834e-01 7.186e-03 -39.434 \u003c 2e-16 ***\r## zipcode91 -5.019e-01 1.131e-02 -44.361 \u003c 2e-16 ***\r## zipcode92 -8.944e-01 3.662e-01 -2.442 0.01460 * ## zipcode93 -6.861e-01 1.018e-01 -6.738 1.64e-11 ***\r## zipcode94 -2.309e-01 9.213e-03 -25.062 \u003c 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.366 on 27006 degrees of freedom\r## Multiple R-squared: 0.6588, Adjusted R-squared: 0.6584 ## F-statistic: 1798 on 29 and 27006 DF, p-value: \u003c 2.2e-16\rë‹¤ë§Œ p-valueë¥¼ êµ¬í•´ë³´ë©´ ìœ ì˜ë¯¸í•˜ì§€ ì•Šì€ ë³€ìˆ˜ê°€ ë‹¤ì‹œ ë‚˜íƒ€ë‚˜ë¯€ë¡œ stepwiseë¥¼ ì‹¤ì‹œí•´ ë³¸ë‹¤. ê·¸ì „ì— number_of_reviewsê°€ ìœ ì˜ë¯¸ í•˜ì§€ ì•ŠëŠ” ë‹¤ê³  ë‚˜ì˜¨ë‹¤. í•˜ì§€ë§Œ number_of_reviewsëŠ” ë‹¤ë¥¸ ìˆ«ììë£Œì— ë¹„í•´ ë¶„ì‚°ì´ í¬ë‹¤. ì‹¤ì œë¡œ number_of_reviewsì™€ ë¹„êµí•´ë³´ë©´ 10ë°° ì •ë„ ì°¨ì´ê°€ ë‚œë‹¤. ì´ë¥¼ ë³´ì •í•´ ì£¼ê¸° ìœ„í•´ ë‚˜ëˆˆê°’ì„ í•´ë´ë„ ê²°ê³¼ëŠ” ë™ì¼í•˜ê²Œ ìœ ì˜ë¯¸ í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  ë‚˜ì˜¨ë‹¤.\nsd(f_df$review_scores_rating, na.rm=TRUE)\r## [1] 4.655876\rsd(f_df$number_of_reviews) \r## [1] 48.80326\rf_df$standard_number_of_reviews \u003c- f_df$number_of_reviews/sd(f_df$review_scores_rating, na.rm=TRUE)\rtemp_lm = lm(log_price_ratio ~ room_type + accommodates + bathrooms + cancellation_policy + cleaning_fee + host_response_rate + instant_bookable + standard_number_of_reviews + review_scores_rating + bedrooms + beds, data = f_df)\rsummary(temp_lm)\r## ## Call:\r## lm(formula = log_price_ratio ~ room_type + accommodates + bathrooms + ## cancellation_policy + cleaning_fee + host_response_rate + ## instant_bookable + standard_number_of_reviews + review_scores_rating + ## bedrooms + beds, data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -2.59858 -0.25391 -0.01335 0.24299 2.54936 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) 2.8699063 0.0556688 51.553 \u003c 2e-16 ***\r## room_typePrivate room -0.6022161 0.0057959 -103.904 \u003c 2e-16 ***\r## room_typeShared room -1.1298223 0.0173091 -65.273 \u003c 2e-16 ***\r## accommodates 0.0634022 0.0022744 27.876 \u003c 2e-16 ***\r## bathrooms 0.1074901 0.0052103 20.630 \u003c 2e-16 ***\r## cancellation_policy.L 0.3217257 0.0481716 6.679 2.46e-11 ***\r## cancellation_policy.Q 0.1491561 0.0359783 4.146 3.40e-05 ***\r## cancellation_policy.C 0.0559756 0.0164257 3.408 0.000656 ***\r## cleaning_feeTRUE 0.0046765 0.0069336 0.674 0.500018 ## host_response_rate -0.2032507 0.0242706 -8.374 \u003c 2e-16 ***\r## instant_bookablet -0.0380744 0.0052724 -7.221 5.28e-13 ***\r## standard_number_of_reviews 0.0000952 0.0002299 0.414 0.678769 ## review_scores_rating 0.0166253 0.0005285 31.456 \u003c 2e-16 ***\r## bedrooms 0.1667024 0.0045023 37.026 \u003c 2e-16 ***\r## beds -0.0384741 0.0033131 -11.613 \u003c 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.3907 on 27021 degrees of freedom\r## Multiple R-squared: 0.6111, Adjusted R-squared: 0.6109 ## F-statistic: 3032 on 14 and 27021 DF, p-value: \u003c 2.2e-16\rì´ì œ ê¸°ì¡´ì˜ ë³€ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ stepwiseë¥¼ ì‹¤ì‹œí•´ ë³¸ë‹¤\nlm4 = step(lm3, direction = 'both')\r## Start: AIC=-54314.95\r## log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + ## host_response_rate + instant_bookable + number_of_reviews + ## review_scores_rating + bedrooms + beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## - cleaning_fee 1 0.00 3618.2 -54317\r## - number_of_reviews 1 0.08 3618.2 -54316\r## \u003cnone\u003e 3618.2 -54315\r## - host_identity_verified 1 1.21 3619.4 -54308\r## - host_response_rate 1 4.82 3623.0 -54281\r## - instant_bookable 1 7.14 3625.3 -54264\r## - property_type 2 7.92 3626.1 -54260\r## - cancellation_policy 3 21.45 3639.6 -54161\r## - beds 1 21.10 3639.3 -54160\r## - bathrooms 1 79.59 3697.7 -53729\r## - accommodates 1 131.11 3749.3 -53355\r## - review_scores_rating 1 188.21 3806.4 -52946\r## - bedrooms 1 216.57 3834.7 -52745\r## - zipcode 12 462.42 4080.6 -51087\r## - room_type 2 1779.04 5397.2 -43507\r## ## Step: AIC=-54316.91\r## log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + host_identity_verified + ## host_response_rate + instant_bookable + number_of_reviews + ## review_scores_rating + bedrooms + beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## - number_of_reviews 1 0.08 3618.2 -54318\r## \u003cnone\u003e 3618.2 -54317\r## + cleaning_fee 1 0.00 3618.2 -54315\r## - host_identity_verified 1 1.21 3619.4 -54310\r## - host_response_rate 1 4.84 3623.0 -54283\r## - instant_bookable 1 7.16 3625.3 -54265\r## - property_type 2 7.92 3626.1 -54262\r## - beds 1 21.11 3639.3 -54162\r## - cancellation_policy 3 21.72 3639.9 -54161\r## - bathrooms 1 79.62 3697.8 -53730\r## - accommodates 1 131.42 3749.6 -53354\r## - review_scores_rating 1 188.30 3806.5 -52947\r## - bedrooms 1 216.56 3834.7 -52747\r## - zipcode 12 462.51 4080.7 -51089\r## - room_type 2 1827.08 5445.2 -43269\r## ## Step: AIC=-54318.33\r## log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + host_identity_verified + ## host_response_rate + instant_bookable + review_scores_rating + ## bedrooms + beds + zipcode\r## ## Df Sum of Sq RSS AIC\r## \u003cnone\u003e 3618.2 -54318\r## + number_of_reviews 1 0.08 3618.2 -54317\r## + cleaning_fee 1 0.00 3618.2 -54316\r## - host_identity_verified 1 1.16 3619.4 -54312\r## - host_response_rate 1 4.95 3623.2 -54283\r## - instant_bookable 1 7.27 3625.5 -54266\r## - property_type 2 7.97 3626.2 -54263\r## - cancellation_policy 3 21.66 3639.9 -54163\r## - beds 1 21.15 3639.4 -54163\r## - bathrooms 1 79.88 3698.1 -53730\r## - accommodates 1 131.34 3749.6 -53356\r## - review_scores_rating 1 188.57 3806.8 -52947\r## - bedrooms 1 218.14 3836.4 -52738\r## - zipcode 12 462.64 4080.9 -51089\r## - room_type 2 1828.54 5446.8 -43264\rê·¸ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.\nsummary(lm4)\r## ## Call:\r## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + host_identity_verified + ## host_response_rate + instant_bookable + review_scores_rating + ## bedrooms + beds + zipcode, data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -2.51557 -0.22551 -0.00287 0.22588 2.52586 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) 2.8112298 0.0525988 53.447 \u003c 2e-16 ***\r## room_typePrivate room -0.5855993 0.0055699 -105.136 \u003c 2e-16 ***\r## room_typeShared room -1.1375240 0.0161312 -70.517 \u003c 2e-16 ***\r## property_typeHouse -0.0183360 0.0059407 -3.087 0.00203 ** ## property_typeOther 0.0422432 0.0072288 5.844 5.16e-09 ***\r## accommodates 0.0668736 0.0021358 31.311 \u003c 2e-16 ***\r## bathrooms 0.1209281 0.0049524 24.418 \u003c 2e-16 ***\r## cancellation_policy.L 0.2933262 0.0452494 6.482 9.18e-11 ***\r## cancellation_policy.Q 0.1616865 0.0337823 4.786 1.71e-06 ***\r## cancellation_policy.C 0.0664165 0.0154332 4.303 1.69e-05 ***\r## host_identity_verifiedt 0.0162382 0.0055087 2.948 0.00320 ** ## host_response_rate -0.1381528 0.0227264 -6.079 1.23e-09 ***\r## instant_bookablet -0.0365163 0.0049570 -7.367 1.80e-13 ***\r## review_scores_rating 0.0188152 0.0005015 37.518 \u003c 2e-16 ***\r## bedrooms 0.1719812 0.0042620 40.352 \u003c 2e-16 ***\r## beds -0.0390361 0.0031066 -12.566 \u003c 2e-16 ***\r## zipcode11 -0.3585074 0.0072259 -49.614 \u003c 2e-16 ***\r## zipcode1m -0.3950436 0.3661121 -1.079 0.28059 ## zipcode20 -0.2976181 0.0100374 -29.651 \u003c 2e-16 ***\r## zipcode21 -0.2358253 0.0112927 -20.883 \u003c 2e-16 ***\r## zipcode22 -0.1539659 0.0548451 -2.807 0.00500 ** ## zipcode24 -0.6528374 0.3661251 -1.783 0.07458 . ## zipcode60 -0.3329465 0.0101308 -32.865 \u003c 2e-16 ***\r## zipcode90 -0.2835116 0.0071819 -39.476 \u003c 2e-16 ***\r## zipcode91 -0.5014514 0.0112977 -44.385 \u003c 2e-16 ***\r## zipcode92 -0.8951543 0.3661830 -2.445 0.01451 * ## zipcode93 -0.6850067 0.1017839 -6.730 1.73e-11 ***\r## zipcode94 -0.2315125 0.0091763 -25.229 \u003c 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.366 on 27008 degrees of freedom\r## Multiple R-squared: 0.6588, Adjusted R-squared: 0.6584 ## F-statistic: 1931 on 27 and 27008 DF, p-value: \u003c 2.2e-16\rplot(lm4,which=1)\rplot(lm4,which=2)\r## Warning: not plotting observations with leverage one:\r## 1413, 8437, 20636\rì •ê·œì„±ê³¼ ë“±ë¶„ì‚°ì„±ì— ë¬¸ì œê°€ ì—†ë‹¤. Y ë³€ìˆ˜ê°€ ì•„ë‹Œ ì”ì°¨ë¥¼ ë°”íƒ•ìœ¼ë¡œ trellis plotì„ ê·¸ë ¤ë³´ë©´ í° ë¬¸ì œëŠ” ë³´ì´ì§€ ì•ŠëŠ”ë‹¤. (ê²°ê³¼ëŠ” ìƒëµ eval=FALSE)\nxyplot(lm4$residuals ~ room_type, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ cancellation_policy, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ property_type, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ accommodates, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ bathrooms, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ host_identity_verified, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ host_response_rate, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ instant_bookable , data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ review_scores_rating, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ bedrooms, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ beds, data=f_df,panel=mypanel)\rxyplot(lm4$residuals ~ zipcode, data=f_df,panel=mypanel)\rì¦‰ ìš°ë¦¬ëŠ” êµí˜¸ì‘ìš© ì—†ì´ ì´ 12ê°œì˜ ë³€ìˆ˜ë¥¼ ì´ìš©í•´ íšŒê·€ë¶„ì„ í•˜ì˜€ë‹¤.\n\rroom_type\rproperty_type\raccommodates\rbathrooms\rcancellation_policy\rhost_identity_verified\rhost_response_rate\rinstant_bookable\rreview_scores_rating\rbedrooms\rbeds\rzipcode\r\rì´ì œ ì˜¤ë²„í”¼íŒ…ì„ ë§‰ê¸° ìœ„í•´ ë°ì´í„°ë¥¼ train setê³¼ test setìœ¼ë¡œ ë‚˜ëˆ„ì–´ ëª¨í˜• ë§Œë“¤ì–´ í‰ê°€í•´ ë³´ë„ë¡ í•œë‹¤.\nnobs=nrow(f_df)\rset.seed(1234)\ri = sample(1:nobs, round(nobs*0.6)) #60% for training data, 40% for testdata\rtrain_df = f_df[i,] test_df = f_df[-i,]\rlm5 = lm(log_price_ratio ~ room_type + property_type + accommodates + bathrooms + cancellation_policy + host_identity_verified + host_response_rate + instant_bookable + review_scores_rating + bedrooms + beds + zipcode, data = f_df)\rsummary(lm5)\r## ## Call:\r## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + host_identity_verified + ## host_response_rate + instant_bookable + review_scores_rating + ## bedrooms + beds + zipcode, data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -2.51557 -0.22551 -0.00287 0.22588 2.52586 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) 2.8112298 0.0525988 53.447 \u003c 2e-16 ***\r## room_typePrivate room -0.5855993 0.0055699 -105.136 \u003c 2e-16 ***\r## room_typeShared room -1.1375240 0.0161312 -70.517 \u003c 2e-16 ***\r## property_typeHouse -0.0183360 0.0059407 -3.087 0.00203 ** ## property_typeOther 0.0422432 0.0072288 5.844 5.16e-09 ***\r## accommodates 0.0668736 0.0021358 31.311 \u003c 2e-16 ***\r## bathrooms 0.1209281 0.0049524 24.418 \u003c 2e-16 ***\r## cancellation_policy.L 0.2933262 0.0452494 6.482 9.18e-11 ***\r## cancellation_policy.Q 0.1616865 0.0337823 4.786 1.71e-06 ***\r## cancellation_policy.C 0.0664165 0.0154332 4.303 1.69e-05 ***\r## host_identity_verifiedt 0.0162382 0.0055087 2.948 0.00320 ** ## host_response_rate -0.1381528 0.0227264 -6.079 1.23e-09 ***\r## instant_bookablet -0.0365163 0.0049570 -7.367 1.80e-13 ***\r## review_scores_rating 0.0188152 0.0005015 37.518 \u003c 2e-16 ***\r## bedrooms 0.1719812 0.0042620 40.352 \u003c 2e-16 ***\r## beds -0.0390361 0.0031066 -12.566 \u003c 2e-16 ***\r## zipcode11 -0.3585074 0.0072259 -49.614 \u003c 2e-16 ***\r## zipcode1m -0.3950436 0.3661121 -1.079 0.28059 ## zipcode20 -0.2976181 0.0100374 -29.651 \u003c 2e-16 ***\r## zipcode21 -0.2358253 0.0112927 -20.883 \u003c 2e-16 ***\r## zipcode22 -0.1539659 0.0548451 -2.807 0.00500 ** ## zipcode24 -0.6528374 0.3661251 -1.783 0.07458 . ## zipcode60 -0.3329465 0.0101308 -32.865 \u003c 2e-16 ***\r## zipcode90 -0.2835116 0.0071819 -39.476 \u003c 2e-16 ***\r## zipcode91 -0.5014514 0.0112977 -44.385 \u003c 2e-16 ***\r## zipcode92 -0.8951543 0.3661830 -2.445 0.01451 * ## zipcode93 -0.6850067 0.1017839 -6.730 1.73e-11 ***\r## zipcode94 -0.2315125 0.0091763 -25.229 \u003c 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.366 on 27008 degrees of freedom\r## Multiple R-squared: 0.6588, Adjusted R-squared: 0.6584 ## F-statistic: 1931 on 27 and 27008 DF, p-value: \u003c 2.2e-16\rplot(lm5,which=1)\rplot(lm5,which=2)\r## Warning: not plotting observations with leverage one:\r## 1413, 8437, 20636\rp-valueë„ ìœ ì˜ë¯¸í•˜ë©°(ì¼ë¶€ zipcodeëŠ” ìœ ì˜ë¯¸ í•˜ì§€ ì•Šìœ¼ë‚˜ ëŒ€ë¶€ë¶„ì´ ìœ ì˜ë¯¸í•˜ë¯€ë¡œ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œë‹¤. í•˜ì§€ë§Œ í•´ë‹¹ zipcodeì— ëŒ€í•´ì„œëŠ” í•´ì„ì— ìœ ì˜í•  í•„ìš”ê°€ ìˆë‹¤.), Adjusted R-squaredë„ 0.6584ì´ë‹¤. ì”ì°¨ë„ ë¬¸ì œ ì—†ìœ¼ë¯€ë¡œ testë°ì´í„°ì™€ ë¹„êµë¥¼ í•´ë³¸ë‹¤.\nê·¸ ê²°ê³¼ ì˜ˆì¸¡ê²°ì •ê³„ìˆ˜,í‰ê· ì ˆëŒ€ì˜¤ì°¨, MAPEëŠ” ìˆœì„œëŒ€ë¡œ ë‹¤ìŒê³¼ ê°™ë‹¤.\n## predicted values\rpred = predict(lm5, newdata=test_df, type='response')\r# predictive R^2\rcor(test_df$log_price_ratio, pred)^2\r## [1] 0.6595498\r# MAE\rmean(abs(test_df$log_price_ratio - pred))\r## [1] 0.280805\r# MAPE\rmean(abs(test_df$log_price_ratio - pred)/abs(test_df$log_price_ratio))*100\r## [1] 6.538482\r\rìµœì¢… ê²°ê³¼\rë§ˆì§€ë§‰ìœ¼ë¡œ ìš°ë¦¬ì˜ ìµœì¢… ëª¨í˜•ì„ ì„¤ëª…í•˜ê³ ì í•œë‹¤.\nsummary(lm5)\r## ## Call:\r## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + ## bathrooms + cancellation_policy + host_identity_verified + ## host_response_rate + instant_bookable + review_scores_rating + ## bedrooms + beds + zipcode, data = f_df)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -2.51557 -0.22551 -0.00287 0.22588 2.52586 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u003e|t|) ## (Intercept) 2.8112298 0.0525988 53.447 \u003c 2e-16 ***\r## room_typePrivate room -0.5855993 0.0055699 -105.136 \u003c 2e-16 ***\r## room_typeShared room -1.1375240 0.0161312 -70.517 \u003c 2e-16 ***\r## property_typeHouse -0.0183360 0.0059407 -3.087 0.00203 ** ## property_typeOther 0.0422432 0.0072288 5.844 5.16e-09 ***\r## accommodates 0.0668736 0.0021358 31.311 \u003c 2e-16 ***\r## bathrooms 0.1209281 0.0049524 24.418 \u003c 2e-16 ***\r## cancellation_policy.L 0.2933262 0.0452494 6.482 9.18e-11 ***\r## cancellation_policy.Q 0.1616865 0.0337823 4.786 1.71e-06 ***\r## cancellation_policy.C 0.0664165 0.0154332 4.303 1.69e-05 ***\r## host_identity_verifiedt 0.0162382 0.0055087 2.948 0.00320 ** ## host_response_rate -0.1381528 0.0227264 -6.079 1.23e-09 ***\r## instant_bookablet -0.0365163 0.0049570 -7.367 1.80e-13 ***\r## review_scores_rating 0.0188152 0.0005015 37.518 \u003c 2e-16 ***\r## bedrooms 0.1719812 0.0042620 40.352 \u003c 2e-16 ***\r## beds -0.0390361 0.0031066 -12.566 \u003c 2e-16 ***\r## zipcode11 -0.3585074 0.0072259 -49.614 \u003c 2e-16 ***\r## zipcode1m -0.3950436 0.3661121 -1.079 0.28059 ## zipcode20 -0.2976181 0.0100374 -29.651 \u003c 2e-16 ***\r## zipcode21 -0.2358253 0.0112927 -20.883 \u003c 2e-16 ***\r## zipcode22 -0.1539659 0.0548451 -2.807 0.00500 ** ## zipcode24 -0.6528374 0.3661251 -1.783 0.07458 . ## zipcode60 -0.3329465 0.0101308 -32.865 \u003c 2e-16 ***\r## zipcode90 -0.2835116 0.0071819 -39.476 \u003c 2e-16 ***\r## zipcode91 -0.5014514 0.0112977 -44.385 \u003c 2e-16 ***\r## zipcode92 -0.8951543 0.3661830 -2.445 0.01451 * ## zipcode93 -0.6850067 0.1017839 -6.730 1.73e-11 ***\r## zipcode94 -0.2315125 0.0091763 -25.229 \u003c 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.366 on 27008 degrees of freedom\r## Multiple R-squared: 0.6588, Adjusted R-squared: 0.6584 ## F-statistic: 1931 on 27 and 27008 DF, p-value: \u003c 2.2e-16\rYë³€ìˆ˜ : log_price_ratio (ê°€ê²©ë¹„ì— logë¥¼ ì·¨í•œ ê°’)\r\rXë³€ìˆ˜ : room_type + property_type + accommodates + bathrooms + cancellation_policy + host_identity_verified + host_response_rate + instant_bookable + review_scores_rating + bedrooms + beds + zipcod\rìœ„ì˜ Coefficientsì˜ Estimateë¥¼ ë³´ë©´ ê·¸ ê²°ê³¼ë¥¼ ì•Œ ìˆ˜ ìˆìœ¼ë‚˜ ê°„ë‹¨íˆ ì„¤ëª…í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.\n\rcancellation_policyê°€ â€œsuper_strict_30â€ì—ì„œ â€œflexibleâ€ìœ¼ë¡œ ë³€í•˜ë©´ 0.2750713ë§Œí¼ log_price_ratioê°€ ì¦ê°€í•œë‹¤.\n\rcancellation_policyê°€ â€œsuper_strict_30â€ì—ì„œ â€œmoderateâ€ìœ¼ë¡œ ë³€í•˜ë©´ 0.1480741ë§Œí¼ log_price_ratioê°€ ì¦ê°€í•œë‹¤.\n\rcancellation_policyê°€ â€œsuper_strict_30â€ì—ì„œ â€œstrictâ€ìœ¼ë¡œ ë³€í•˜ë©´ 0.0603244ë§Œí¼ log_price_ratioê°€ ì¦ê°€í•œë‹¤.\n\rroom_typeê°€ Entire home/aptì—ì„œ â€œPrivate roomâ€ìœ¼ë¡œ ë³€í•˜ë©´ 0.5854706ë§Œí¼ log_price_ratioê°€ ê°ì†Œí•œë‹¤.\n\rroom_typeê°€ Entire home/aptì—ì„œ â€œShared roomâ€ìœ¼ë¡œ ë³€í•˜ë©´ 1.1371925ë§Œí¼ log_price_ratioê°€ ê°ì†Œí•œë‹¤.\n\rproperty_typeê°€ â€œApartmentâ€ì—ì„œ â€œHouseâ€ìœ¼ë¡œ ë³€í•˜ë©´ 0.0184556ë§Œí¼ log_price_ratioê°€ ê°ì†Œí•œë‹¤.\n\rproperty_typeê°€ â€œApartmentâ€ì—ì„œ â€œOtherâ€ìœ¼ë¡œ ë³€í•˜ë©´ 0.0422110ë§Œí¼ log_price_ratioê°€ ì¦ê°€í•œë‹¤.\n\rhost_identity_verifiedê°€ â€œfâ€ì—ì„œ â€œtâ€ìœ¼ë¡œ ë³€í•˜ë©´ 0.0162358ë§Œí¼ log_price_ratioê°€ ì¦ê°€í•œë‹¤.\n\rbedroomsì˜ ê°œìˆ˜ê°€ 1ê°œ ì¦ê°€í•  ìˆ˜ë¡ 0.1718274ë§Œí¼ log_price_ratioê°€ ì¦ê°€í•œë‹¤.\n\rbedsì˜ ìˆ˜ê°€ 1ê°œ ì¦ê°€í• ìˆ˜ë¡ 0.0392406ë§Œí¼ log_price_ratioê°€ ê°ì†Œí•œë‹¤.\n\rbathroomsì˜ ê°œìˆ˜ê°€ 1ê°œ ì¦ê°€í•  ìˆ˜ë¡ 0.1208864ë§Œí¼ log_price_ratioê°€ ì¦ê°€í•œë‹¤.\n\raccommodateê°€ 1 ì¦ê°€í•  ìˆ˜ë¡ 0.0670576ë§Œí¼ log_price_ratioê°€ ì¦ê°€í•œë‹¤.\n\rhost_response_rateê°€ 1 ì¦ê°€í•  ìˆ˜ë¡ 0.1385022ë§Œí¼ log_price_ratioê°€ ê°ì†Œí•œë‹¤.\n\rinstant_bookabletê°€ 1 ì¦ê°€í•  ìˆ˜ë¡ 0.0365038ë§Œí¼ log_price_ratioê°€ ê°ì†Œí•œë‹¤.\n\rreview_scores_ratingê°€ 1 ì¦ê°€í•  ìˆ˜ë¡ 0.0188218ë§Œí¼ log_price_ratioê°€ ì¦ê°€í•œë‹¤.\n\rzipcodeì˜ ê²½ìš° 10###ì—ì„œ ê° í•´ë‹¹ ì½”ë“œë¡œ ë³€í–ˆì„ë–„ log_price_ratioê°€ ì–¼ë§ˆë‚˜ ê°ì†Œí–ˆëŠ”ì§€ë¥¼ ì˜ë¯¸í•œë‹¤. ë‹¤ë§Œ zipcode1m###ê³¼ zipcode24###ëŠ” ì„¤ëª…í•˜ì§€ ì•ŠëŠ”ë‹¤.\n\r\r\r\r","description":"","tags":["R Markdown","ë¡œì§€ìŠ¤í‹±"],"title":"ë°ì´í„°ë§ˆì´ë‹ - ë¡œì§€ìŠ¤í‹± íšŒê·€ë¶„ì„","uri":"/posts/report/1/"}]
