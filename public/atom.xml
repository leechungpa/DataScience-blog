<?xml version="1.0" encoding="utf-8"?>


<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-us">
    <title type="text">Leechungpa&#39;s Data Science blog</title>
    <subtitle type="html">Blog for Data Science by Leechungpa.</subtitle>
    <updated>2020-06-12T22:21:16&#43;09:00</updated>
    <id>/</id>
    <link rel="alternate" type="text/html" href="/" />
    <link rel="self" type="application/atom&#43;xml" href="/atom.xml" />
    <author>
            <name>Lee Chung Pa</name>
            <uri>/</uri>
            
                <email>leechungpa@naver.com</email>
            </author>
    <rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights>
    <generator uri="https://gohugo.io/" version="0.71.1">Hugo</generator>
        <entry>
            <title type="text">R 글꼴 변경</title>
            <link rel="alternate" type="text/html" href="/posts/r/3/" />
            <id>/posts/r/3/</id>
            <updated>2020-06-12T22:19:46&#43;09:00</updated>
            <published>2020-06-05T00:00:00&#43;00:00</published>
            <author>
                    <name>Lee Chung Pa</name>
                    <uri>https://leechungpa.netlify.app/</uri>
                    <email>leechungpa@naver.com</email>
                    </author>
            <rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">a.sourceLine { display: inline-block; line-height: 1.25; }a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }a.sourceLine:empty { height: 1.2em; }.sourceCode { overflow: visible; }code.sourceCode { white-space: pre; position: relative; }div.sourceCode { margin: 1em 0; }pre.sourceCode { margin: 0; }@media screen {div.</summary>
            
                <content type="html">
&lt;style type=&#34;text/css&#34;&gt;
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
&lt;/style&gt;

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/3/#글꼴-설치&#34;&gt;글꼴 설치&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/3/#r에-적용&#34;&gt;R에 적용&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/3/#알아볼-패키지&#34;&gt;알아볼 패키지&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/3/#예시&#34;&gt;예시&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;아직 작성중인 내용 –&lt;/p&gt;
&lt;div id=&#34;글꼴-설치&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;글꼴 설치&lt;/h1&gt;
&lt;p&gt;코딩시 주로 사용하는 한글 글꼴&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/naver/d2codingfont&#34;&gt;D2 Coding 글꼴&lt;/a&gt;
&lt;a href=&#34;https://github.com/naver/nanumfont/blob/master/README.md&#34;&gt;네이버 나눔코딩 글꼴&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;트루타입 글꼴 설치 가능&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;r에-적용&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;R에 적용&lt;/h1&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode r&#34;&gt;&lt;code class=&#34;sourceCode r&#34;&gt;&lt;a class=&#34;sourceLine&#34; id=&#34;cb1-1&#34; title=&#34;1&#34;&gt;&lt;span class=&#34;kw&#34;&gt;install.packages&lt;/span&gt;(extrafont)&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb1-2&#34; title=&#34;2&#34;&gt;&lt;span class=&#34;kw&#34;&gt;library&lt;/span&gt;(extrafont)&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb1-3&#34; title=&#34;3&#34;&gt;&lt;span class=&#34;kw&#34;&gt;font_import&lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;pattern =&lt;/span&gt; &lt;span class=&#34;st&#34;&gt;&amp;quot;D2&amp;quot;&lt;/span&gt;)&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;글꼴 적용 후 Tools-global options-Appearence에서 설정 가능&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;알아볼-패키지&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;알아볼 패키지&lt;/h1&gt;
&lt;p&gt;showtext&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;예시&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;예시&lt;/h1&gt;
&lt;p&gt;(오류로 추후 수정 예정)&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb2&#34;&gt;&lt;pre class=&#34;sourceCode r&#34;&gt;&lt;code class=&#34;sourceCode r&#34;&gt;&lt;a class=&#34;sourceLine&#34; id=&#34;cb2-1&#34; title=&#34;1&#34;&gt;&lt;span class=&#34;kw&#34;&gt;install.packages&lt;/span&gt;(&lt;span class=&#34;st&#34;&gt;&amp;quot;KoNLP&amp;quot;&lt;/span&gt;) &lt;span class=&#34;co&#34;&gt;# CRAN에 없으므로 다른 방벙 알아서&lt;/span&gt;&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb2-2&#34; title=&#34;2&#34;&gt;&lt;span class=&#34;kw&#34;&gt;install.packages&lt;/span&gt;(&lt;span class=&#34;st&#34;&gt;&amp;quot;devtools&amp;quot;&lt;/span&gt;)&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb2-3&#34; title=&#34;3&#34;&gt;devtools&lt;span class=&#34;op&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;install_github&lt;/span&gt;(&lt;span class=&#34;st&#34;&gt;&amp;quot;lchiffon/wordcloud2&amp;quot;&lt;/span&gt;)&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb3&#34;&gt;&lt;pre class=&#34;sourceCode r&#34;&gt;&lt;code class=&#34;sourceCode r&#34;&gt;&lt;a class=&#34;sourceLine&#34; id=&#34;cb3-1&#34; title=&#34;1&#34;&gt;&lt;span class=&#34;kw&#34;&gt;library&lt;/span&gt;(KoNLP)&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb3-2&#34; title=&#34;2&#34;&gt;&lt;span class=&#34;kw&#34;&gt;library&lt;/span&gt;(wordcloud2)&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb3-3&#34; title=&#34;3&#34;&gt;&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb3-4&#34; title=&#34;4&#34;&gt;&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb3-5&#34; title=&#34;5&#34;&gt;dt &amp;lt;-&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;readLines&lt;/span&gt;(&lt;span class=&#34;st&#34;&gt;&amp;#39;./data/blog_text.txt&amp;#39;&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;encoding =&lt;/span&gt; &lt;span class=&#34;st&#34;&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;)&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb3-6&#34; title=&#34;6&#34;&gt;&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb3-7&#34; title=&#34;7&#34;&gt;&lt;span class=&#34;co&#34;&gt;# 하다가 포기&lt;/span&gt;&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb3-8&#34; title=&#34;8&#34;&gt;&lt;span class=&#34;kw&#34;&gt;wordcloud2&lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;data=&lt;/span&gt;dt,&lt;span class=&#34;dt&#34;&gt;fontFamily =&lt;/span&gt; &lt;span class=&#34;st&#34;&gt;&amp;#39;나눔바른고딕&amp;#39;&lt;/span&gt;)&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 부분은 추후 수정 예정&lt;/p&gt;
&lt;/div&gt;

</content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="/categories/r/" term="R" label="R" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="/tags/r/" term="R" label="R" />
                            
                        
                            
                            
                            
                                <category scheme="/tags/r-studio/" term="R studio" label="R studio" />
                            
                        
                            
                            
                            
                                <category scheme="/tags/%EA%B8%80%EA%BC%B4/" term="글꼴" label="글꼴" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Data Science를 위한 R 초기 환경</title>
            <link rel="alternate" type="text/html" href="/posts/r/1/" />
            <id>/posts/r/1/</id>
            <updated>2020-06-12T22:21:15&#43;09:00</updated>
            <published>2020-05-29T00:00:00&#43;00:00</published>
            <author>
                    <name>Lee Chung Pa</name>
                    <uri>https://leechungpa.netlify.app/</uri>
                    <email>leechungpa@naver.com</email>
                    </author>
            <rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">a.sourceLine { display: inline-block; line-height: 1.25; }a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }a.sourceLine:empty { height: 1.2em; }.sourceCode { overflow: visible; }code.sourceCode { white-space: pre; position: relative; }div.sourceCode { margin: 1em 0; }pre.sourceCode { margin: 0; }@media screen {div.</summary>
            
                <content type="html">
&lt;style type=&#34;text/css&#34;&gt;
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
&lt;/style&gt;

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/1/#초기-설정&#34;&gt;초기 설정&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/1/#r-설치&#34;&gt;R 설치&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/1/#r-studio-설치&#34;&gt;R studio 설치&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/1/#추가-설치-git-bash-및-우분투-등&#34;&gt;추가 설치 : Git bash 및 우분투 등&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/1/#초기-설정-확인&#34;&gt;초기 설정 확인&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/r/1/#업데이트&#34;&gt;업데이트&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;IDE setting for Data Science&lt;/p&gt;
&lt;p&gt;데이터 사이언스쪽으로 공부하고 싶어서 노트북을 새로 구매헀다. 무려 8년만에. 코드를 작성한다면 애플을 샀어야 했는데, 경제적 여건 상 국내 중소기업인 한성컴퓨터 제품을 구매헀다. &lt;del&gt;매우 쓰레기 였다.&lt;/del&gt;&lt;br /&gt;
구매하고 한달도 안되어서 사용중 셧다운 또는 자동 절전모드로 전환되는 현상이 나타났다. 서비스 센터에 입고를 했더니, 증상이 안나온다고 다시 보냈다. 직접 증상이 나오는 것을 촬영하고 보냈더니 포맷한번 하고 보냈다. 내가 보내기 전에 포맷은 수도 없이 많이 했는데. 결국 3번 보내고 나서 SSD교체를 해주었다. 문제는 터치패드 근처에 아이패드를 가져다 되면 노트북이 꺼질 수 있다는 것이다. 신재품에서도 동일하게 나타나므로 주의를 요구한다고 말했다. 내가 컴퓨터 하루이틀 만진것도 아니고, 데스크탑은 직접 부품을 사서 다 조립도 할 수 있는데 고작 그 약한 자성떄문에 꺼지는게 당연하다고… 한성은 쓰레기다. 돈 벌면 바로 애플 살것이다.&lt;br /&gt;
여튼 그래서 포맷을 수도없이 많이 했다. 즉 R과 Rstudio 등등 수도없이 반복해서 설치해보면서 나에게 익숙한 개발환경이 무엇인지 찾았다. 이제 본론으로 가자.&lt;/p&gt;
&lt;hr /&gt;
&lt;div id=&#34;초기-설정&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;초기 설정&lt;/h1&gt;
&lt;div id=&#34;r-설치&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;R 설치&lt;/h2&gt;
&lt;p&gt;먼저 R을 설치한다. 설치시 유의할 점은 아래와 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;64-bit만 설치&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;설치 경로는 모두 영어로, 폴더명에 띄어쓰기는 지양하자&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;한국어 보다는 영어를 기본언어로 설정하자&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;r-studio-설치&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;R studio 설치&lt;/h2&gt;
&lt;p&gt;이제 IDE인 R studio를 설치하면 된다. R studio를 설치하고 설정할 환경이 많다. &lt;del&gt;(사실 이부분을 정리하고자 쓴거다.)&lt;/del&gt;&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Tools - Global Options&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;General-Basic : Default working directory 변경&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;General-Basic : Workspace에서 .RData 사용하지 않음(never) 설정 및 시작시 자동 불러오기 미사용&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Code-Saving : encoding을 UTF-8로 변경&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Appearance : 테마 변경, 눈이 안좋으므로 zoom 125%에 Tommorrow Night Bright를 선호&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Terminal : Bash(Windows Subsystem for Linux), 참고로 우분트 등 설치후 가능&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;기타&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;마크다운 : Preview in Viewr Pane 체크&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;마크다운 : Chunk Ouptput in Console 체크&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div id=&#34;추가-설치-git-bash-및-우분투-등&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;추가 설치 : Git bash 및 우분투 등&lt;/h2&gt;
&lt;p&gt;참고로 윈도우10 기준 개발환경이다. 에플을 사야하는 이유가 이것이다. 지금부터는 에플이라면 필요없는 설치이기 때문이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;windows 기능 켜기/끄기에서 Linux용 Windows 하위 시스템 체크&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;우분투 설치&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;파일 관리를 위한 git bash(&lt;a href=&#34;https://git-scm.com/&#34; class=&#34;uri&#34;&gt;https://git-scm.com/&lt;/a&gt;) 설치&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pdf 마트다운을 위한 TeX 설치&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;초기-설정-확인&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;초기 설정 확인&lt;/h1&gt;
&lt;p&gt;이렇게 설치를 완료했다면 설치 및 설정이 잘되었는지 확인해 보자.&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode r&#34;&gt;&lt;code class=&#34;sourceCode r&#34;&gt;&lt;a class=&#34;sourceLine&#34; id=&#34;cb1-1&#34; title=&#34;1&#34;&gt;&lt;span class=&#34;kw&#34;&gt;sessionInfo&lt;/span&gt;()&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;## R version 4.0.0 (2020-04-24)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 18363)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=Korean_Korea.949  LC_CTYPE=Korean_Korea.949   
## [3] LC_MONETARY=Korean_Korea.949 LC_NUMERIC=C                
## [5] LC_TIME=Korean_Korea.949    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## loaded via a namespace (and not attached):
##  [1] compiler_4.0.0  magrittr_1.5    bookdown_0.19   tools_4.0.0    
##  [5] htmltools_0.4.0 yaml_2.2.1      Rcpp_1.0.4.6    stringi_1.4.6  
##  [9] rmarkdown_2.1   blogdown_0.19   knitr_1.28      stringr_1.4.0  
## [13] digest_0.6.25   xfun_0.14       rlang_0.4.6     evaluate_0.14&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb3&#34;&gt;&lt;pre class=&#34;sourceCode r&#34;&gt;&lt;code class=&#34;sourceCode r&#34;&gt;&lt;a class=&#34;sourceLine&#34; id=&#34;cb3-1&#34; title=&#34;1&#34;&gt;&lt;span class=&#34;kw&#34;&gt;getwd&lt;/span&gt;()&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;C:/Users/User/Documents/git/blog/content/posts&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;경고표시나 중간중간 한글을 사용하면 문제가 많다. 그러는 경우 locale을 바꿔야 한다.&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb5&#34;&gt;&lt;pre class=&#34;sourceCode r&#34;&gt;&lt;code class=&#34;sourceCode r&#34;&gt;&lt;a class=&#34;sourceLine&#34; id=&#34;cb5-1&#34; title=&#34;1&#34;&gt;&lt;span class=&#34;kw&#34;&gt;Sys.getlocale&lt;/span&gt;()&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;LC_COLLATE=Korean_Korea.949;LC_CTYPE=Korean_Korea.949;LC_MONETARY=Korean_Korea.949;LC_NUMERIC=C;LC_TIME=Korean_Korea.949&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Sys.setlocale() 로 원하는 설정을 할 수 있다.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;업데이트&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;업데이트&lt;/h1&gt;
&lt;p&gt;초기 설정 이후 시간이 지나면 R과 R studio 업데이트가 필요 할 수 있다. 먼저 R은 다음의 코드를 이용하면 된다.&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb7&#34;&gt;&lt;pre class=&#34;sourceCode r&#34;&gt;&lt;code class=&#34;sourceCode r&#34;&gt;&lt;a class=&#34;sourceLine&#34; id=&#34;cb7-1&#34; title=&#34;1&#34;&gt;&lt;span class=&#34;co&#34;&gt;# install.packages(&amp;#39;installr&amp;#39;)&lt;/span&gt;&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb7-2&#34; title=&#34;2&#34;&gt;installr&lt;span class=&#34;op&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;check.for.updates.R&lt;/span&gt;()&lt;/a&gt;
&lt;a class=&#34;sourceLine&#34; id=&#34;cb7-3&#34; title=&#34;3&#34;&gt;installr&lt;span class=&#34;op&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;install.R&lt;/span&gt;()&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;R studio의 경우 Help-Check for Update 를 확인해 보면된다.&lt;/p&gt;
&lt;p&gt;마지막으로 설치된 packages를 업데이트 해주면 된다.&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb8&#34;&gt;&lt;pre class=&#34;sourceCode r&#34;&gt;&lt;code class=&#34;sourceCode r&#34;&gt;&lt;a class=&#34;sourceLine&#34; id=&#34;cb8-1&#34; title=&#34;1&#34;&gt;&lt;span class=&#34;kw&#34;&gt;update.packages&lt;/span&gt;()&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;

</content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="/categories/r/" term="R" label="R" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="/tags/r/" term="R" label="R" />
                            
                        
                            
                            
                            
                                <category scheme="/tags/rstudio/" term="Rstudio" label="Rstudio" />
                            
                        
                            
                            
                            
                                <category scheme="/tags/ide/" term="IDE" label="IDE" />
                            
                        
                            
                            
                            
                                <category scheme="/tags/git/" term="Git" label="Git" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">데이터마이닝 - Random Forest</title>
            <link rel="alternate" type="text/html" href="/posts/data_mining/3/" />
            <id>/posts/data_mining/3/</id>
            <updated>2020-06-09T14:49:01&#43;09:00</updated>
            <published>2020-05-24T00:00:00&#43;00:00</published>
            <author>
                    <name>Lee Chung Pa</name>
                    <uri>https://leechungpa.netlify.app/</uri>
                    <email>leechungpa@naver.com</email>
                    </author>
            <rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">데이터마이닝 연습으로 Random Forest을 사용한 예제이다.
먼저 전처리에서 사용한 packages이다.
library(tidyverse)library(skimr)그 다음 모형을 만들고자 하는 데이터를 불러왔다. 해당 데이터는 카글에서 가지고 온 데이터다.
raw_data=read_csv(&amp;#39;./data/ausraindata.csv&amp;#39;,col_types = cols(Evaporation = col_double(),Sunshine = col_double()) )해당 데이터는 오늘의 날씨를 바탕으로 내일의 강수유무를 예측해 보는 데이터 이다.</summary>
            
                <content type="html">
&lt;script src=&#34;/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-binding/plotly.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/typedarray/typedarray.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/jquery/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/crosstalk/css/crosstalk.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/crosstalk/js/crosstalk.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-main/plotly-latest.min.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;데이터마이닝 연습으로 Random Forest을 사용한 예제이다.&lt;/p&gt;
&lt;p&gt;먼저 전처리에서 사용한 packages이다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)
library(skimr)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;그 다음 모형을 만들고자 하는 데이터를 불러왔다. 해당 데이터는 &lt;a href=&#34;https://www.kaggle.com/kalpakchepurwar/ausrain&#34;&gt;카글&lt;/a&gt;에서 가지고 온 데이터다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;raw_data=read_csv(&amp;#39;./data/ausraindata.csv&amp;#39;,col_types = cols(Evaporation = col_double(),
  Sunshine = col_double()) )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;해당 데이터는 오늘의 날씨를 바탕으로 내일의 강수유무를 예측해 보는 데이터 이다. 이 자료는 수많은 Australian weather stations의 자료가 포함되어 있다. 총 24개의 열로 구성되어 있으며 각 열별 데이터의 의미는 아래와 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Date : The date of observation&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Location : weather station의 위치&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MinTemp : minimum temperature in degrees Celsius&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MaxTemp : The maximum temperature in degrees Celsius&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rainfall : 당일 강수량 (mm)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Evaporation : Class A pan evaporation (mm) in the 24 hours to 9am&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sunshine : The number of hours of bright sunshine in the day.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WindGustDir : The direction of the strongest wind gust in the 24 hours to midnight&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WindGustSpeed : The speed (km/h) of the strongest wind gust in the 24 hours to midnight&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WindDir9am : Direction of the wind at 9am&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WindDir3pm : Direction of the wind at 3pm&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WindSpeed9am : Wind speed (km/hr) averaged over 10 minutes prior to 9am&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WindSpeed3pm : Wind speed (km/hr) averaged over 10 minutes prior to 3pm&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Humidity9am : Humidity (percent) at 9am&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Humidity3pm : Humidity (percent) at 3pm&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pressure9am : Atmospheric pressure (hpa) reduced to mean sea level at 9am&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pressure3pm : Atmospheric pressure (hpa) reduced to mean sea level at 3pm&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Cloud9am : Fraction of sky obscured by cloud at 9am. This is measured in “oktas”, which are a unit of eigths. It records how many eigths of the sky are obscured by cloud. A 0 measure indicates completely clear sky whilst an 8 indicates that it is completely overcast.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Cloud3pm : Fraction of sky obscured by cloud at 3pm. This is measured in “oktas”, which are a unit of eigths. It records how many eigths of the sky are obscured by cloud. A 0 measure indicates completely clear sky whilst an 8 indicates that it is completely overcast.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Temp9am : Temperature (degrees C) at 9am&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Temp3pm : Temperature (degrees C) at 3pm&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;RainToday : Boolean: 1 if precipitation (mm) in the 24 hours to 9am exceeds 1mm, otherwise 0&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;RISK_MM : 다음날의 강수량(mm)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;RainTomorrow : 우리의 목표변수로 다음날 강수 유무&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;전처리&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;전처리&lt;/h1&gt;
&lt;p&gt;분석에 앞서, 실제 데이터 구성을 직접 보면서 전처리를 시행한다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;glimpse(raw_data)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Rows: 142,193
## Columns: 24
## $ Date          &amp;lt;date&amp;gt; 2008-12-01, 2008-12-02, 2008-12-03, 2008-12-04, 2008...
## $ Location      &amp;lt;chr&amp;gt; &amp;quot;Albury&amp;quot;, &amp;quot;Albury&amp;quot;, &amp;quot;Albury&amp;quot;, &amp;quot;Albury&amp;quot;, &amp;quot;Albury&amp;quot;, &amp;quot;Al...
## $ MinTemp       &amp;lt;dbl&amp;gt; 13.4, 7.4, 12.9, 9.2, 17.5, 14.6, 14.3, 7.7, 9.7, 13....
## $ MaxTemp       &amp;lt;dbl&amp;gt; 22.9, 25.1, 25.7, 28.0, 32.3, 29.7, 25.0, 26.7, 31.9,...
## $ Rainfall      &amp;lt;dbl&amp;gt; 0.6, 0.0, 0.0, 0.0, 1.0, 0.2, 0.0, 0.0, 0.0, 1.4, 0.0...
## $ Evaporation   &amp;lt;dbl&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
## $ Sunshine      &amp;lt;dbl&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
## $ WindGustDir   &amp;lt;chr&amp;gt; &amp;quot;W&amp;quot;, &amp;quot;WNW&amp;quot;, &amp;quot;WSW&amp;quot;, &amp;quot;NE&amp;quot;, &amp;quot;W&amp;quot;, &amp;quot;WNW&amp;quot;, &amp;quot;W&amp;quot;, &amp;quot;W&amp;quot;, &amp;quot;NNW&amp;quot;,...
## $ WindGustSpeed &amp;lt;dbl&amp;gt; 44, 44, 46, 24, 41, 56, 50, 35, 80, 28, 30, 31, 61, 4...
## $ WindDir9am    &amp;lt;chr&amp;gt; &amp;quot;W&amp;quot;, &amp;quot;NNW&amp;quot;, &amp;quot;W&amp;quot;, &amp;quot;SE&amp;quot;, &amp;quot;ENE&amp;quot;, &amp;quot;W&amp;quot;, &amp;quot;SW&amp;quot;, &amp;quot;SSE&amp;quot;, &amp;quot;SE&amp;quot;,...
## $ WindDir3pm    &amp;lt;chr&amp;gt; &amp;quot;WNW&amp;quot;, &amp;quot;WSW&amp;quot;, &amp;quot;WSW&amp;quot;, &amp;quot;E&amp;quot;, &amp;quot;NW&amp;quot;, &amp;quot;W&amp;quot;, &amp;quot;W&amp;quot;, &amp;quot;W&amp;quot;, &amp;quot;NW&amp;quot;, ...
## $ WindSpeed9am  &amp;lt;dbl&amp;gt; 20, 4, 19, 11, 7, 19, 20, 6, 7, 15, 17, 15, 28, 24, N...
## $ WindSpeed3pm  &amp;lt;dbl&amp;gt; 24, 22, 26, 9, 20, 24, 24, 17, 28, 11, 6, 13, 28, 20,...
## $ Humidity9am   &amp;lt;dbl&amp;gt; 71, 44, 38, 45, 82, 55, 49, 48, 42, 58, 48, 89, 76, 6...
## $ Humidity3pm   &amp;lt;dbl&amp;gt; 22, 25, 30, 16, 33, 23, 19, 19, 9, 27, 22, 91, 93, 43...
## $ Pressure9am   &amp;lt;dbl&amp;gt; 1007.7, 1010.6, 1007.6, 1017.6, 1010.8, 1009.2, 1009....
## $ Pressure3pm   &amp;lt;dbl&amp;gt; 1007.1, 1007.8, 1008.7, 1012.8, 1006.0, 1005.4, 1008....
## $ Cloud9am      &amp;lt;dbl&amp;gt; 8, NA, NA, NA, 7, NA, 1, NA, NA, NA, NA, 8, 8, NA, 0,...
## $ Cloud3pm      &amp;lt;dbl&amp;gt; NA, NA, 2, NA, 8, NA, NA, NA, NA, NA, NA, 8, 8, 7, NA...
## $ Temp9am       &amp;lt;dbl&amp;gt; 16.9, 17.2, 21.0, 18.1, 17.8, 20.6, 18.1, 16.3, 18.3,...
## $ Temp3pm       &amp;lt;dbl&amp;gt; 21.8, 24.3, 23.2, 26.5, 29.7, 28.9, 24.6, 25.5, 30.2,...
## $ RainToday     &amp;lt;chr&amp;gt; &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;,...
## $ RISK_MM       &amp;lt;dbl&amp;gt; 0.0, 0.0, 0.0, 1.0, 0.2, 0.0, 0.0, 0.0, 1.4, 0.0, 2.2...
## $ RainTomorrow  &amp;lt;chr&amp;gt; &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;No&amp;quot;, &amp;quot;Yes&amp;quot;...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;먼저 이 데이터는 2008-12-01 부터 2017-06-24 까지의 데이터이다. 해당 날짜의 모든 데이터를 가지고 있는 시계열 자료로 볼 수 있으나, 뉴럴네트워크를 사용하기에 해당 Date 변수는 사용하지 않는다.&lt;/p&gt;
&lt;p&gt;또한 우리는 분류를 해야하므로 내일 강수량이 아닌 강수유무를 목적변수로 한다. 따라서 내일 강수량인 RISK_MM도 제외한다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;raw_data %&amp;gt;% filter(is.na(Evaporation)) %&amp;gt;% 
  count() / nrow(raw_data)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##           n
## 1 0.4278903&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;raw_data %&amp;gt;% filter(is.na(Sunshine)) %&amp;gt;% 
  count() / nrow(raw_data)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##           n
## 1 0.4769292&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;raw_data %&amp;gt;% filter(is.na(Cloud9am)) %&amp;gt;% 
  count() / nrow(raw_data)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##           n
## 1 0.3773533&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;raw_data %&amp;gt;% filter(is.na(Cloud3pm)) %&amp;gt;% 
  count() / nrow(raw_data)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##           n
## 1 0.4015247&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;또한 위에서 볼 수있듯이 4개의 열들은 결측치의 값이 높은 것을 알 수 있다. 해당 행을 `na.omit을 이용해 삭제하였다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;nrow( raw_data %&amp;gt;% distinct(Location) )&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 49&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;nrow( raw_data %&amp;gt;% distinct(WindGustDir) )&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 17&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;nrow( raw_data %&amp;gt;% distinct(WindDir9am) )&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 17&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;nrow( raw_data %&amp;gt;% distinct(WindDir3pm) )&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 17&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;또한 49개로 그 범주의 개수가 다양한 Location과 16개(NA 1개포함) 방향변수들도 제거하였다.&lt;/p&gt;
&lt;p&gt;앞서 언급한 열들을 제거하고, na인 행을 제거하고, 비가 온 경우(‘Yes’)를 1로 변환하였다. factor형으로 만들었다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp_data = raw_data %&amp;gt;%
  select(
    -Date, -RISK_MM,
    # -Evaporation, -Sunshine, -Cloud9am, -Cloud3pm,
    -Location, -WindGustDir,-WindDir9am, -WindDir3pm
    ) %&amp;gt;%
  na.omit() %&amp;gt;%
  mutate(
    RainToday = as.numeric(RainToday==&amp;#39;Yes&amp;#39;),
    RainTomorrow = as.factor(as.numeric(RainTomorrow==&amp;#39;Yes&amp;#39;))
  )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;총 58090개의 관측지가 있다. 그 결과를 skimr 패키지를 이용해 간략히 보였다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;skim(temp_data) # skimr 패키지&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-7&#34;&gt;Table 1: &lt;/span&gt;Data summary&lt;/caption&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Name&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;temp_data&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of rows&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;58090&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of columns&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;18&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;_______________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Column type frequency:&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;factor&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;numeric&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;________________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Group variables&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;None&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: factor&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;ordered&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;top_counts&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RainTomorrow&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;0: 45361, 1: 12729&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: numeric&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p25&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p50&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p75&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p100&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;hist&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;MinTemp&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.34&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.47&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31.4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▅▇▆▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;MaxTemp&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.97&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▇▇▅▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Rainfall&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.99&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;206.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Evaporation&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.45&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.69&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Sunshine&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.70&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.77&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14.5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▃▃▅▇▃&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;WindGustSpeed&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40.56&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.38&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;124.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▃▇▂▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;WindSpeed9am&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.24&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.58&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;67.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▆▂▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;WindSpeed3pm&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.58&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.56&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;76.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▆▇▂▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Humidity9am&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;66.22&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.63&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;55.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;67.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▂▅▇▅&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Humidity3pm&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;49.70&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.22&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▂▅▇▅▂&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Pressure9am&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1017.33&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.94&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;980.5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1012.7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1017.3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1022.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1040.4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▁▇▇▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Pressure3pm&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1014.88&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.90&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;977.1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1010.1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1014.8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1019.5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1038.9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▁▇▇▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Cloud9am&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.80&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▆▃▁▃▇&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Cloud3pm&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.33&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▆▃▃▇▂&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Temp9am&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.09&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.60&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12.9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39.4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▇▇▅▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Temp3pm&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.63&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.84&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46.1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▇▇▃▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RainToday&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.22&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.41&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▂&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;이상 전처리를 완료하였다.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;training-데이터와-test-데이터를-5050의-비율로-분할하시오.&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;1. Training 데이터와 Test 데이터를 50:50의 비율로 분할하시오.&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(1234)
sp_n = sample(1:nrow(temp_data), round(nrow(temp_data)/2)) 
train = temp_data[sp_n,]
test = temp_data[-sp_n,]
nrow(train);nrow(test)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 29045&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 29045&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;r-프로그램의-randomforest-명령어를-사용하여-랜덤포레스트-분석을-수행하고자-한다.-단-hyper-parameter는-아래와-같이-조정한다.&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;2. R 프로그램의 ‘randomForest’ 명령어를 사용하여 랜덤포레스트 분석을 수행하고자 한다. 단, hyper-parameter는 아래와 같이 조정한다.&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;A. ntree=100 을 사용하고,&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;B. mtry = (0.1&lt;em&gt;p, 0.2&lt;/em&gt;p, … , 1.0*p)을 내림하여 사용한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;C. nodesize = (1, 0.01&lt;em&gt;n, 0.02&lt;/em&gt;n, … , 0.10*n) 을 반올림하여 사용한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;D. 그외 parameter 값들은 default 값을 사용한다.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;먼저 17개의 변수로 RainTomorrow를 예측하므로 p는 17이 된다. 따라서 B의 조건에 따른 mtry를 구할 수 있다. 또한 train 데이터의 수는 29045개 이므로 n은 29045가 된다. 따라서 C조건에 따른 nodesize를 구할 수 있다. 각각은 다음과 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;( para_mtry = floor(17 * 1:10 / 10) )&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1]  1  3  5  6  8 10 11 13 15 17&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;( para_ndsz = c(1, round( nrow(train) * 1:10 / 100 ) ) )&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1]    1  290  581  871 1162 1452 1743 2033 2324 2614 2904&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;이제 코드를 돌리면 아래와 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(randomForest)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## randomForest 4.6-14&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Type rfNews() to see new features/changes/bug fixes.&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;randomForest&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:dplyr&amp;#39;:
## 
##     combine&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:ggplot2&amp;#39;:
## 
##     margin&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(pROC)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Type &amp;#39;citation(&amp;quot;pROC&amp;quot;)&amp;#39; for a citation.&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;pROC&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following objects are masked from &amp;#39;package:stats&amp;#39;:
## 
##     cov, smooth, var&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;for(mt in para_mtry){
  for(nd in para_ndsz){
    print(paste(&amp;#39;rf&amp;#39;,mt,nd,sep=&amp;#39;_&amp;#39;))
    set.seed(2010)
    assign(
      paste(&amp;#39;rf&amp;#39;,mt,nd,sep=&amp;#39;_&amp;#39;),
      randomForest(RainTomorrow ~ ., data = train, ntree=100, mtry=mt, nodesize=nd)
      )
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;rf_1_1&amp;quot;
## [1] &amp;quot;rf_1_290&amp;quot;
## [1] &amp;quot;rf_1_581&amp;quot;
## [1] &amp;quot;rf_1_871&amp;quot;
## [1] &amp;quot;rf_1_1162&amp;quot;
## [1] &amp;quot;rf_1_1452&amp;quot;
## [1] &amp;quot;rf_1_1743&amp;quot;
## [1] &amp;quot;rf_1_2033&amp;quot;
## [1] &amp;quot;rf_1_2324&amp;quot;
## [1] &amp;quot;rf_1_2614&amp;quot;
## [1] &amp;quot;rf_1_2904&amp;quot;
## [1] &amp;quot;rf_3_1&amp;quot;
## [1] &amp;quot;rf_3_290&amp;quot;
## [1] &amp;quot;rf_3_581&amp;quot;
## [1] &amp;quot;rf_3_871&amp;quot;
## [1] &amp;quot;rf_3_1162&amp;quot;
## [1] &amp;quot;rf_3_1452&amp;quot;
## [1] &amp;quot;rf_3_1743&amp;quot;
## [1] &amp;quot;rf_3_2033&amp;quot;
## [1] &amp;quot;rf_3_2324&amp;quot;
## [1] &amp;quot;rf_3_2614&amp;quot;
## [1] &amp;quot;rf_3_2904&amp;quot;
## [1] &amp;quot;rf_5_1&amp;quot;
## [1] &amp;quot;rf_5_290&amp;quot;
## [1] &amp;quot;rf_5_581&amp;quot;
## [1] &amp;quot;rf_5_871&amp;quot;
## [1] &amp;quot;rf_5_1162&amp;quot;
## [1] &amp;quot;rf_5_1452&amp;quot;
## [1] &amp;quot;rf_5_1743&amp;quot;
## [1] &amp;quot;rf_5_2033&amp;quot;
## [1] &amp;quot;rf_5_2324&amp;quot;
## [1] &amp;quot;rf_5_2614&amp;quot;
## [1] &amp;quot;rf_5_2904&amp;quot;
## [1] &amp;quot;rf_6_1&amp;quot;
## [1] &amp;quot;rf_6_290&amp;quot;
## [1] &amp;quot;rf_6_581&amp;quot;
## [1] &amp;quot;rf_6_871&amp;quot;
## [1] &amp;quot;rf_6_1162&amp;quot;
## [1] &amp;quot;rf_6_1452&amp;quot;
## [1] &amp;quot;rf_6_1743&amp;quot;
## [1] &amp;quot;rf_6_2033&amp;quot;
## [1] &amp;quot;rf_6_2324&amp;quot;
## [1] &amp;quot;rf_6_2614&amp;quot;
## [1] &amp;quot;rf_6_2904&amp;quot;
## [1] &amp;quot;rf_8_1&amp;quot;
## [1] &amp;quot;rf_8_290&amp;quot;
## [1] &amp;quot;rf_8_581&amp;quot;
## [1] &amp;quot;rf_8_871&amp;quot;
## [1] &amp;quot;rf_8_1162&amp;quot;
## [1] &amp;quot;rf_8_1452&amp;quot;
## [1] &amp;quot;rf_8_1743&amp;quot;
## [1] &amp;quot;rf_8_2033&amp;quot;
## [1] &amp;quot;rf_8_2324&amp;quot;
## [1] &amp;quot;rf_8_2614&amp;quot;
## [1] &amp;quot;rf_8_2904&amp;quot;
## [1] &amp;quot;rf_10_1&amp;quot;
## [1] &amp;quot;rf_10_290&amp;quot;
## [1] &amp;quot;rf_10_581&amp;quot;
## [1] &amp;quot;rf_10_871&amp;quot;
## [1] &amp;quot;rf_10_1162&amp;quot;
## [1] &amp;quot;rf_10_1452&amp;quot;
## [1] &amp;quot;rf_10_1743&amp;quot;
## [1] &amp;quot;rf_10_2033&amp;quot;
## [1] &amp;quot;rf_10_2324&amp;quot;
## [1] &amp;quot;rf_10_2614&amp;quot;
## [1] &amp;quot;rf_10_2904&amp;quot;
## [1] &amp;quot;rf_11_1&amp;quot;
## [1] &amp;quot;rf_11_290&amp;quot;
## [1] &amp;quot;rf_11_581&amp;quot;
## [1] &amp;quot;rf_11_871&amp;quot;
## [1] &amp;quot;rf_11_1162&amp;quot;
## [1] &amp;quot;rf_11_1452&amp;quot;
## [1] &amp;quot;rf_11_1743&amp;quot;
## [1] &amp;quot;rf_11_2033&amp;quot;
## [1] &amp;quot;rf_11_2324&amp;quot;
## [1] &amp;quot;rf_11_2614&amp;quot;
## [1] &amp;quot;rf_11_2904&amp;quot;
## [1] &amp;quot;rf_13_1&amp;quot;
## [1] &amp;quot;rf_13_290&amp;quot;
## [1] &amp;quot;rf_13_581&amp;quot;
## [1] &amp;quot;rf_13_871&amp;quot;
## [1] &amp;quot;rf_13_1162&amp;quot;
## [1] &amp;quot;rf_13_1452&amp;quot;
## [1] &amp;quot;rf_13_1743&amp;quot;
## [1] &amp;quot;rf_13_2033&amp;quot;
## [1] &amp;quot;rf_13_2324&amp;quot;
## [1] &amp;quot;rf_13_2614&amp;quot;
## [1] &amp;quot;rf_13_2904&amp;quot;
## [1] &amp;quot;rf_15_1&amp;quot;
## [1] &amp;quot;rf_15_290&amp;quot;
## [1] &amp;quot;rf_15_581&amp;quot;
## [1] &amp;quot;rf_15_871&amp;quot;
## [1] &amp;quot;rf_15_1162&amp;quot;
## [1] &amp;quot;rf_15_1452&amp;quot;
## [1] &amp;quot;rf_15_1743&amp;quot;
## [1] &amp;quot;rf_15_2033&amp;quot;
## [1] &amp;quot;rf_15_2324&amp;quot;
## [1] &amp;quot;rf_15_2614&amp;quot;
## [1] &amp;quot;rf_15_2904&amp;quot;
## [1] &amp;quot;rf_17_1&amp;quot;
## [1] &amp;quot;rf_17_290&amp;quot;
## [1] &amp;quot;rf_17_581&amp;quot;
## [1] &amp;quot;rf_17_871&amp;quot;
## [1] &amp;quot;rf_17_1162&amp;quot;
## [1] &amp;quot;rf_17_1452&amp;quot;
## [1] &amp;quot;rf_17_1743&amp;quot;
## [1] &amp;quot;rf_17_2033&amp;quot;
## [1] &amp;quot;rf_17_2324&amp;quot;
## [1] &amp;quot;rf_17_2614&amp;quot;
## [1] &amp;quot;rf_17_2904&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;각각의 parameter별 모형은 **rf_(mtry값)_(nodesize값)** 라는 객체에 저장되었다. 즉 mtry가 1이고 nodesize가 290인 모형은 rf_1_290라는 객체 저장되어 있다.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;위-2번의-조건에-맞는-랜덤포레스트를-training-데이터를-이용하여-생성하고-test-데이터를-이용하여-예측-정확도를-계산하고자-한다.-이때-예측정확도는-auroc-값을-사용한다.&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;3. 위 2번의 조건에 맞는 랜덤포레스트를 training 데이터를 이용하여 생성하고, test 데이터를 이용하여 예측 정확도를 계산하고자 한다. 이때 예측정확도는 AUROC 값을 사용한다.&lt;/h1&gt;
&lt;p&gt;앞서 random forest를 생성하였다. auroc를 test 데이터를 이용해 계산하면 아래와 같다. (message=F)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;for( md in ls(pattern = &amp;quot;^rf_&amp;quot;) ){
  assign(
      paste(&amp;#39;pred&amp;#39;,md ,sep=&amp;#39;_&amp;#39;),
      predict( get(md), newdata=test , type=&amp;quot;prob&amp;quot;)
      )
  assign(
      paste(&amp;#39;roc&amp;#39;,md ,sep=&amp;#39;_&amp;#39;),
      roc(test$RainTomorrow ~ get(paste(&amp;#39;pred&amp;#39;,md ,sep=&amp;#39;_&amp;#39;))[,2])
      )
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;test 데이터를 이용하여 각각의 예측 정확도auroc값을 계산한 결과는 아래와 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;auc_matrix = matrix(nrow=10,ncol=11)
for( md in ls(pattern = &amp;quot;^roc_&amp;quot;) ){
  temp_mt = strsplit(md,split=&amp;#39;_&amp;#39;)[[1]][3]
  temp_ns = strsplit(md,split=&amp;#39;_&amp;#39;)[[1]][4]
  cat(&amp;#39;mtry값:&amp;#39;,temp_mt,&amp;#39;\t&amp;#39;,
      &amp;#39;nodesize값:&amp;#39;,temp_ns,&amp;#39;\n&amp;#39;,
      sep =&amp;quot;&amp;quot;)
  temp_auc = get(md)$auc 
  print(temp_auc)
  cat(&amp;#39;\n&amp;#39;)

  auc_matrix[which(para_mtry ==temp_mt),which(para_ndsz ==temp_ns)] = temp_auc
}&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## mtry값:1  nodesize값:1
## Area under the curve: 0.8798
## 
## mtry값:1  nodesize값:1162
## Area under the curve: 0.853
## 
## mtry값:1  nodesize값:1452
## Area under the curve: 0.8509
## 
## mtry값:1  nodesize값:1743
## Area under the curve: 0.8466
## 
## mtry값:1  nodesize값:2033
## Area under the curve: 0.849
## 
## mtry값:1  nodesize값:2324
## Area under the curve: 0.8509
## 
## mtry값:1  nodesize값:2614
## Area under the curve: 0.8466
## 
## mtry값:1  nodesize값:290
## Area under the curve: 0.8572
## 
## mtry값:1  nodesize값:2904
## Area under the curve: 0.8424
## 
## mtry값:1  nodesize값:581
## Area under the curve: 0.8548
## 
## mtry값:1  nodesize값:871
## Area under the curve: 0.8542
## 
## mtry값:10 nodesize값:1
## Area under the curve: 0.8886
## 
## mtry값:10 nodesize값:1162
## Area under the curve: 0.8393
## 
## mtry값:10 nodesize값:1452
## Area under the curve: 0.8436
## 
## mtry값:10 nodesize값:1743
## Area under the curve: 0.8351
## 
## mtry값:10 nodesize값:2033
## Area under the curve: 0.8312
## 
## mtry값:10 nodesize값:2324
## Area under the curve: 0.8316
## 
## mtry값:10 nodesize값:2614
## Area under the curve: 0.8313
## 
## mtry값:10 nodesize값:290
## Area under the curve: 0.859
## 
## mtry값:10 nodesize값:2904
## Area under the curve: 0.8306
## 
## mtry값:10 nodesize값:581
## Area under the curve: 0.8465
## 
## mtry값:10 nodesize값:871
## Area under the curve: 0.8466
## 
## mtry값:11 nodesize값:1
## Area under the curve: 0.888
## 
## mtry값:11 nodesize값:1162
## Area under the curve: 0.8392
## 
## mtry값:11 nodesize값:1452
## Area under the curve: 0.8365
## 
## mtry값:11 nodesize값:1743
## Area under the curve: 0.8294
## 
## mtry값:11 nodesize값:2033
## Area under the curve: 0.8265
## 
## mtry값:11 nodesize값:2324
## Area under the curve: 0.8334
## 
## mtry값:11 nodesize값:2614
## Area under the curve: 0.8274
## 
## mtry값:11 nodesize값:290
## Area under the curve: 0.8599
## 
## mtry값:11 nodesize값:2904
## Area under the curve: 0.8289
## 
## mtry값:11 nodesize값:581
## Area under the curve: 0.8479
## 
## mtry값:11 nodesize값:871
## Area under the curve: 0.8373
## 
## mtry값:13 nodesize값:1
## Area under the curve: 0.887
## 
## mtry값:13 nodesize값:1162
## Area under the curve: 0.8391
## 
## mtry값:13 nodesize값:1452
## Area under the curve: 0.831
## 
## mtry값:13 nodesize값:1743
## Area under the curve: 0.8314
## 
## mtry값:13 nodesize값:2033
## Area under the curve: 0.8231
## 
## mtry값:13 nodesize값:2324
## Area under the curve: 0.823
## 
## mtry값:13 nodesize값:2614
## Area under the curve: 0.8182
## 
## mtry값:13 nodesize값:290
## Area under the curve: 0.8557
## 
## mtry값:13 nodesize값:2904
## Area under the curve: 0.8207
## 
## mtry값:13 nodesize값:581
## Area under the curve: 0.8423
## 
## mtry값:13 nodesize값:871
## Area under the curve: 0.8393
## 
## mtry값:15 nodesize값:1
## Area under the curve: 0.8856
## 
## mtry값:15 nodesize값:1162
## Area under the curve: 0.8333
## 
## mtry값:15 nodesize값:1452
## Area under the curve: 0.8302
## 
## mtry값:15 nodesize값:1743
## Area under the curve: 0.8219
## 
## mtry값:15 nodesize값:2033
## Area under the curve: 0.8201
## 
## mtry값:15 nodesize값:2324
## Area under the curve: 0.8177
## 
## mtry값:15 nodesize값:2614
## Area under the curve: 0.8135
## 
## mtry값:15 nodesize값:290
## Area under the curve: 0.8576
## 
## mtry값:15 nodesize값:2904
## Area under the curve: 0.8134
## 
## mtry값:15 nodesize값:581
## Area under the curve: 0.8329
## 
## mtry값:15 nodesize값:871
## Area under the curve: 0.8343
## 
## mtry값:17 nodesize값:1
## Area under the curve: 0.8852
## 
## mtry값:17 nodesize값:1162
## Area under the curve: 0.8248
## 
## mtry값:17 nodesize값:1452
## Area under the curve: 0.8245
## 
## mtry값:17 nodesize값:1743
## Area under the curve: 0.8235
## 
## mtry값:17 nodesize값:2033
## Area under the curve: 0.815
## 
## mtry값:17 nodesize값:2324
## Area under the curve: 0.8085
## 
## mtry값:17 nodesize값:2614
## Area under the curve: 0.8077
## 
## mtry값:17 nodesize값:290
## Area under the curve: 0.8545
## 
## mtry값:17 nodesize값:2904
## Area under the curve: 0.7965
## 
## mtry값:17 nodesize값:581
## Area under the curve: 0.8312
## 
## mtry값:17 nodesize값:871
## Area under the curve: 0.827
## 
## mtry값:3  nodesize값:1
## Area under the curve: 0.89
## 
## mtry값:3  nodesize값:1162
## Area under the curve: 0.8507
## 
## mtry값:3  nodesize값:1452
## Area under the curve: 0.8467
## 
## mtry값:3  nodesize값:1743
## Area under the curve: 0.8435
## 
## mtry값:3  nodesize값:2033
## Area under the curve: 0.8476
## 
## mtry값:3  nodesize값:2324
## Area under the curve: 0.8467
## 
## mtry값:3  nodesize값:2614
## Area under the curve: 0.8396
## 
## mtry값:3  nodesize값:290
## Area under the curve: 0.8589
## 
## mtry값:3  nodesize값:2904
## Area under the curve: 0.8432
## 
## mtry값:3  nodesize값:581
## Area under the curve: 0.8547
## 
## mtry값:3  nodesize값:871
## Area under the curve: 0.8531
## 
## mtry값:5  nodesize값:1
## Area under the curve: 0.8902
## 
## mtry값:5  nodesize값:1162
## Area under the curve: 0.842
## 
## mtry값:5  nodesize값:1452
## Area under the curve: 0.8445
## 
## mtry값:5  nodesize값:1743
## Area under the curve: 0.8416
## 
## mtry값:5  nodesize값:2033
## Area under the curve: 0.8336
## 
## mtry값:5  nodesize값:2324
## Area under the curve: 0.8358
## 
## mtry값:5  nodesize값:2614
## Area under the curve: 0.8394
## 
## mtry값:5  nodesize값:290
## Area under the curve: 0.8624
## 
## mtry값:5  nodesize값:2904
## Area under the curve: 0.837
## 
## mtry값:5  nodesize값:581
## Area under the curve: 0.8525
## 
## mtry값:5  nodesize값:871
## Area under the curve: 0.8487
## 
## mtry값:6  nodesize값:1
## Area under the curve: 0.8896
## 
## mtry값:6  nodesize값:1162
## Area under the curve: 0.8495
## 
## mtry값:6  nodesize값:1452
## Area under the curve: 0.8422
## 
## mtry값:6  nodesize값:1743
## Area under the curve: 0.8427
## 
## mtry값:6  nodesize값:2033
## Area under the curve: 0.8414
## 
## mtry값:6  nodesize값:2324
## Area under the curve: 0.8394
## 
## mtry값:6  nodesize값:2614
## Area under the curve: 0.8389
## 
## mtry값:6  nodesize값:290
## Area under the curve: 0.8598
## 
## mtry값:6  nodesize값:2904
## Area under the curve: 0.8303
## 
## mtry값:6  nodesize값:581
## Area under the curve: 0.8477
## 
## mtry값:6  nodesize값:871
## Area under the curve: 0.8476
## 
## mtry값:8  nodesize값:1
## Area under the curve: 0.8891
## 
## mtry값:8  nodesize값:1162
## Area under the curve: 0.844
## 
## mtry값:8  nodesize값:1452
## Area under the curve: 0.8441
## 
## mtry값:8  nodesize값:1743
## Area under the curve: 0.8379
## 
## mtry값:8  nodesize값:2033
## Area under the curve: 0.8389
## 
## mtry값:8  nodesize값:2324
## Area under the curve: 0.8368
## 
## mtry값:8  nodesize값:2614
## Area under the curve: 0.8314
## 
## mtry값:8  nodesize값:290
## Area under the curve: 0.8596
## 
## mtry값:8  nodesize값:2904
## Area under the curve: 0.8304
## 
## mtry값:8  nodesize값:581
## Area under the curve: 0.8494
## 
## mtry값:8  nodesize값:871
## Area under the curve: 0.8464&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;행렬로도 보여주면 아래와 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rownames(auc_matrix) = para_mtry
colnames(auc_matrix) = para_ndsz
auc_matrix&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##            1       290       581       871      1162      1452      1743
## 1  0.8797539 0.8572112 0.8548120 0.8541534 0.8530406 0.8508504 0.8465923
## 3  0.8899524 0.8589102 0.8546948 0.8531171 0.8507239 0.8466689 0.8434589
## 5  0.8901695 0.8624353 0.8525360 0.8486703 0.8419568 0.8445128 0.8416349
## 6  0.8895977 0.8597663 0.8477312 0.8476448 0.8495143 0.8421653 0.8426893
## 8  0.8890539 0.8596478 0.8494105 0.8464140 0.8439507 0.8441229 0.8379413
## 10 0.8885989 0.8589943 0.8464877 0.8465859 0.8392590 0.8435724 0.8351362
## 11 0.8880276 0.8599148 0.8479312 0.8372760 0.8392385 0.8365081 0.8294359
## 13 0.8869692 0.8557121 0.8423401 0.8392755 0.8390583 0.8309899 0.8313972
## 15 0.8855846 0.8575909 0.8329103 0.8342663 0.8333442 0.8302059 0.8218959
## 17 0.8851665 0.8544948 0.8311615 0.8269814 0.8248338 0.8244663 0.8234599
##         2033      2324      2614      2904
## 1  0.8489772 0.8509397 0.8465913 0.8424482
## 3  0.8475778 0.8466515 0.8395814 0.8431646
## 5  0.8336063 0.8358320 0.8394180 0.8369673
## 6  0.8413764 0.8393648 0.8389086 0.8302772
## 8  0.8388660 0.8367690 0.8313858 0.8303713
## 10 0.8311746 0.8315563 0.8313170 0.8306044
## 11 0.8264946 0.8333505 0.8274361 0.8288907
## 13 0.8231113 0.8229738 0.8182062 0.8207216
## 15 0.8200801 0.8176567 0.8134933 0.8133673
## 17 0.8149581 0.8084856 0.8076712 0.7964592&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;번의-결과-총-110개의-auroc-값을-구할-수-있다.-이를-mtry-값과-nodesize-값의-조합에-따라-auroc-값으로-3차원-포물선-그래프를-생성하시오.-3d-surface-plot&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;4. 3번의 결과, 총 110개의 AUROC 값을 구할 수 있다. 이를 mtry 값과 nodesize 값의 조합에 따라 AUROC 값으로 3차원 포물선 그래프를 생성하시오. (3D surface plot)&lt;/h1&gt;
&lt;p&gt;해당 auroc를 이용하여 3d surface plot을 그리면 아래와 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(plotly)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;plotly&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:ggplot2&amp;#39;:
## 
##     last_plot&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:stats&amp;#39;:
## 
##     filter&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:graphics&amp;#39;:
## 
##     layout&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot_ly(z = auc_matrix,x=para_mtry,y=para_ndsz) %&amp;gt;%
        add_surface() %&amp;gt;%
        layout(scene = list(
                xaxis = list(title = &amp;#39;mtry&amp;#39;,tickvals=para_mtry),
                yaxis = list(title = &amp;#39;nodesize&amp;#39;,tickvals=para_ndsz),
                zaxis = list(title = &amp;#39;auc&amp;#39;))
               )&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:672px;height:480px;&#34; class=&#34;plotly html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;visdat&#34;:{&#34;12d85a685ec2&#34;:[&#34;function () &#34;,&#34;plotlyVisDat&#34;]},&#34;cur_data&#34;:&#34;12d85a685ec2&#34;,&#34;attrs&#34;:{&#34;12d85a685ec2&#34;:{&#34;z&#34;:[[0.879753909191365,0.857211175123725,0.854811972002102,0.854153366076446,0.853040569816661,0.850850435213139,0.8465923363023,0.848977171104065,0.85093973905314,0.846591314172719,0.842448227209508],[0.889952446264445,0.858910185067677,0.854694788459305,0.853117105640692,0.850723894194487,0.846668909982982,0.843458934405753,0.847577824085869,0.846651513131034,0.839581429057744,0.843164571411155],[0.890169523185017,0.862435269084319,0.852536040461079,0.848670332622165,0.841956789372187,0.844512815391848,0.84163488394314,0.833606324527615,0.835831958345349,0.839417960596678,0.836967272429525],[0.889597657171627,0.859766323557383,0.847731184821085,0.847644789060193,0.84951433633443,0.842165327897173,0.842689349986571,0.841376360872615,0.839364847715151,0.838908599355807,0.830277172771134],[0.889053873910343,0.859647839122393,0.849410492098883,0.846413993618855,0.843950716394448,0.844122909092841,0.837941293089318,0.838865972766641,0.836768979290939,0.831385784150213,0.830371274081287],[0.888598898911082,0.858994257806795,0.846487690194052,0.846585924762205,0.83925898331104,0.84357238046463,0.835136180629803,0.831174609425703,0.831556287065361,0.831316984849066,0.830604440078586],[0.888027628279568,0.859914766369467,0.847931205599569,0.837275996860954,0.839238516628837,0.836508133198641,0.829435942918943,0.826494625670199,0.833350530577485,0.827436120583648,0.828890655716155],[0.886969249235017,0.855712079271332,0.842340132704494,0.839275478486389,0.839058267346781,0.830989855202164,0.831397240949449,0.823111256306281,0.822973819455133,0.818206173461681,0.820721624034365],[0.885584556182319,0.857590863568442,0.832910302464593,0.834266265760601,0.833344236048857,0.830205861164958,0.821895937352226,0.820080125873503,0.817656653196995,0.813493268185754,0.813367301899896],[0.885166481093363,0.85449475735628,0.831161473167763,0.826981365841266,0.824833819970259,0.824466293835094,0.823459909180104,0.814958114093421,0.808485552518443,0.807671235303687,0.796459206849747]],&#34;x&#34;:[1,3,5,6,8,10,11,13,15,17],&#34;y&#34;:[1,290,581,871,1162,1452,1743,2033,2324,2614,2904],&#34;alpha_stroke&#34;:1,&#34;sizes&#34;:[10,100],&#34;spans&#34;:[1,20],&#34;type&#34;:&#34;surface&#34;,&#34;inherit&#34;:true}},&#34;layout&#34;:{&#34;margin&#34;:{&#34;b&#34;:40,&#34;l&#34;:60,&#34;t&#34;:25,&#34;r&#34;:10},&#34;scene&#34;:{&#34;xaxis&#34;:{&#34;title&#34;:&#34;mtry&#34;,&#34;tickvals&#34;:[1,3,5,6,8,10,11,13,15,17]},&#34;yaxis&#34;:{&#34;title&#34;:&#34;nodesize&#34;,&#34;tickvals&#34;:[1,290,581,871,1162,1452,1743,2033,2324,2614,2904]},&#34;zaxis&#34;:{&#34;title&#34;:&#34;auc&#34;}},&#34;hovermode&#34;:&#34;closest&#34;,&#34;showlegend&#34;:false,&#34;legend&#34;:{&#34;yanchor&#34;:&#34;top&#34;,&#34;y&#34;:0.5}},&#34;source&#34;:&#34;A&#34;,&#34;config&#34;:{&#34;showSendToCloud&#34;:false},&#34;data&#34;:[{&#34;colorbar&#34;:{&#34;title&#34;:&#34;&#34;,&#34;ticklen&#34;:2,&#34;len&#34;:0.5,&#34;lenmode&#34;:&#34;fraction&#34;,&#34;y&#34;:1,&#34;yanchor&#34;:&#34;top&#34;},&#34;colorscale&#34;:[[&#34;0&#34;,&#34;rgba(68,1,84,1)&#34;],[&#34;0.0416666666666665&#34;,&#34;rgba(70,19,97,1)&#34;],[&#34;0.0833333333333329&#34;,&#34;rgba(72,32,111,1)&#34;],[&#34;0.125000000000001&#34;,&#34;rgba(71,45,122,1)&#34;],[&#34;0.166666666666667&#34;,&#34;rgba(68,58,128,1)&#34;],[&#34;0.208333333333334&#34;,&#34;rgba(64,70,135,1)&#34;],[&#34;0.25&#34;,&#34;rgba(60,82,138,1)&#34;],[&#34;0.291666666666666&#34;,&#34;rgba(56,93,140,1)&#34;],[&#34;0.333333333333333&#34;,&#34;rgba(49,104,142,1)&#34;],[&#34;0.374999999999999&#34;,&#34;rgba(46,114,142,1)&#34;],[&#34;0.416666666666667&#34;,&#34;rgba(42,123,142,1)&#34;],[&#34;0.458333333333334&#34;,&#34;rgba(38,133,141,1)&#34;],[&#34;0.5&#34;,&#34;rgba(37,144,140,1)&#34;],[&#34;0.541666666666667&#34;,&#34;rgba(33,154,138,1)&#34;],[&#34;0.583333333333333&#34;,&#34;rgba(39,164,133,1)&#34;],[&#34;0.625000000000001&#34;,&#34;rgba(47,174,127,1)&#34;],[&#34;0.666666666666667&#34;,&#34;rgba(53,183,121,1)&#34;],[&#34;0.708333333333333&#34;,&#34;rgba(79,191,110,1)&#34;],[&#34;0.75&#34;,&#34;rgba(98,199,98,1)&#34;],[&#34;0.791666666666667&#34;,&#34;rgba(119,207,85,1)&#34;],[&#34;0.833333333333333&#34;,&#34;rgba(147,214,70,1)&#34;],[&#34;0.874999999999999&#34;,&#34;rgba(172,220,52,1)&#34;],[&#34;0.916666666666667&#34;,&#34;rgba(199,225,42,1)&#34;],[&#34;0.958333333333333&#34;,&#34;rgba(226,228,40,1)&#34;],[&#34;1&#34;,&#34;rgba(253,231,37,1)&#34;]],&#34;showscale&#34;:true,&#34;z&#34;:[[0.879753909191365,0.857211175123725,0.854811972002102,0.854153366076446,0.853040569816661,0.850850435213139,0.8465923363023,0.848977171104065,0.85093973905314,0.846591314172719,0.842448227209508],[0.889952446264445,0.858910185067677,0.854694788459305,0.853117105640692,0.850723894194487,0.846668909982982,0.843458934405753,0.847577824085869,0.846651513131034,0.839581429057744,0.843164571411155],[0.890169523185017,0.862435269084319,0.852536040461079,0.848670332622165,0.841956789372187,0.844512815391848,0.84163488394314,0.833606324527615,0.835831958345349,0.839417960596678,0.836967272429525],[0.889597657171627,0.859766323557383,0.847731184821085,0.847644789060193,0.84951433633443,0.842165327897173,0.842689349986571,0.841376360872615,0.839364847715151,0.838908599355807,0.830277172771134],[0.889053873910343,0.859647839122393,0.849410492098883,0.846413993618855,0.843950716394448,0.844122909092841,0.837941293089318,0.838865972766641,0.836768979290939,0.831385784150213,0.830371274081287],[0.888598898911082,0.858994257806795,0.846487690194052,0.846585924762205,0.83925898331104,0.84357238046463,0.835136180629803,0.831174609425703,0.831556287065361,0.831316984849066,0.830604440078586],[0.888027628279568,0.859914766369467,0.847931205599569,0.837275996860954,0.839238516628837,0.836508133198641,0.829435942918943,0.826494625670199,0.833350530577485,0.827436120583648,0.828890655716155],[0.886969249235017,0.855712079271332,0.842340132704494,0.839275478486389,0.839058267346781,0.830989855202164,0.831397240949449,0.823111256306281,0.822973819455133,0.818206173461681,0.820721624034365],[0.885584556182319,0.857590863568442,0.832910302464593,0.834266265760601,0.833344236048857,0.830205861164958,0.821895937352226,0.820080125873503,0.817656653196995,0.813493268185754,0.813367301899896],[0.885166481093363,0.85449475735628,0.831161473167763,0.826981365841266,0.824833819970259,0.824466293835094,0.823459909180104,0.814958114093421,0.808485552518443,0.807671235303687,0.796459206849747]],&#34;x&#34;:[1,3,5,6,8,10,11,13,15,17],&#34;y&#34;:[1,290,581,871,1162,1452,1743,2033,2324,2614,2904],&#34;type&#34;:&#34;surface&#34;,&#34;frame&#34;:null}],&#34;highlight&#34;:{&#34;on&#34;:&#34;plotly_click&#34;,&#34;persistent&#34;:false,&#34;dynamic&#34;:false,&#34;selectize&#34;:false,&#34;opacityDim&#34;:0.2,&#34;selected&#34;:{&#34;opacity&#34;:1},&#34;debounce&#34;:0},&#34;shinyEvents&#34;:[&#34;plotly_hover&#34;,&#34;plotly_click&#34;,&#34;plotly_selected&#34;,&#34;plotly_relayout&#34;,&#34;plotly_brushed&#34;,&#34;plotly_brushing&#34;,&#34;plotly_clickannotation&#34;,&#34;plotly_doubleclick&#34;,&#34;plotly_deselect&#34;,&#34;plotly_afterplot&#34;,&#34;plotly_sunburstclick&#34;],&#34;base_url&#34;:&#34;https://plot.ly&#34;},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;번의-결과에서-예측정확도가-가장-높은-최적의-hyper-parameter-조합은-무엇인지-밝히시오.&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;5. 4번의 결과에서 예측정확도가 가장 높은 최적의 hyper-parameter 조합은 무엇인지 밝히시오.&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;auc_matrix == max(auc_matrix)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##        1   290   581   871  1162  1452  1743  2033  2324  2614  2904
## 1  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 3  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 5   TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 6  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 8  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 10 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 11 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 13 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 15 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 17 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;즉 &lt;strong&gt;mtry가 3&lt;/strong&gt;이고, &lt;strong&gt;node size 가 1&lt;/strong&gt;일 떄 가장 예측정확도가 높은 조합이다.&lt;/p&gt;
&lt;/div&gt;
</content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="/categories/r/" term="R" label="R" />
                            
                        
                            
                            
                            
                                <category scheme="/categories/data-mining/" term="data mining" label="data mining" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="/tags/data-mining/" term="data mining" label="data mining" />
                            
                        
                            
                            
                            
                                <category scheme="/tags/random-forest/" term="random forest" label="random forest" />
                            
                        
                            
                            
                            
                                <category scheme="/tags/decision-tree/" term="decision tree" label="decision tree" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">데이터마이닝 - Decision Tree</title>
            <link rel="alternate" type="text/html" href="/posts/data_mining/2/" />
            <id>/posts/data_mining/2/</id>
            <updated>2020-06-05T15:45:17&#43;09:00</updated>
            <published>2020-05-15T00:00:00&#43;00:00</published>
            <author>
                    <name>Lee Chung Pa</name>
                    <uri>https://leechungpa.netlify.app/</uri>
                    <email>leechungpa@naver.com</email>
                    </author>
            <rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">데이터마이닝 연습으로 Decision Tree 모델을 사용한 예제이다.
먼저 사용한 페키지이다.
library(tidyverse)## -- Attaching packages --------------------------------------------------------------- tidyverse 1.3.0 --## √ ggplot2 3.3.1 √ purrr 0.3.4## √ tibble 3.0.1 √ dplyr 1.0.0## √ tidyr 1.</summary>
            
                <content type="html">
&lt;script src=&#34;/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-binding/plotly.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/typedarray/typedarray.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/jquery/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/crosstalk/css/crosstalk.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/crosstalk/js/crosstalk.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-main/plotly-latest.min.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;데이터마이닝 연습으로 Decision Tree 모델을 사용한 예제이다.&lt;/p&gt;
&lt;p&gt;먼저 사용한 페키지이다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## -- Attaching packages --------------------------------------------------------------- tidyverse 1.3.0 --&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## √ ggplot2 3.3.1     √ purrr   0.3.4
## √ tibble  3.0.1     √ dplyr   1.0.0
## √ tidyr   1.1.0     √ stringr 1.4.0
## √ readr   1.3.1     √ forcats 0.5.0&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## -- Conflicts ------------------------------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(rpart)
library(rpart.plot)
library(pROC)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Type &amp;#39;citation(&amp;quot;pROC&amp;quot;)&amp;#39; for a citation.&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;pROC&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following objects are masked from &amp;#39;package:stats&amp;#39;:
## 
##     cov, smooth, var&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(plotly)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;plotly&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:ggplot2&amp;#39;:
## 
##     last_plot&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:stats&amp;#39;:
## 
##     filter&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:graphics&amp;#39;:
## 
##     layout&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;다음으로 우리가 사용할 데이터이다. 데이터는 &lt;a href=&#34;https://www.openml.org/d/29&#34; class=&#34;uri&#34;&gt;https://www.openml.org/d/29&lt;/a&gt; 에서 가져왔다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;raw_hw_tb = read_csv(&amp;quot;data/dataset_29_credit-a.csv&amp;quot;,na=&amp;quot;?&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Parsed with column specification:
## cols(
##   A1 = col_character(),
##   A2 = col_double(),
##   A3 = col_double(),
##   A4 = col_character(),
##   A5 = col_character(),
##   A6 = col_character(),
##   A7 = col_character(),
##   A8 = col_double(),
##   A9 = col_logical(),
##   A10 = col_logical(),
##   A11 = col_character(),
##   A12 = col_logical(),
##   A13 = col_character(),
##   A14 = col_character(),
##   A15 = col_double(),
##   class = col_character()
## )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;해당자료는 Credit Approval로 credit card applications와 관련된 자료이다. Ross Quinlan의 자료로, 1987년 UCI에 공개된 자료이다. 모든 자료는 보안을 위해 다른 단어로 변경되었다. 정확히 각각의 변수가 의미하는 바는 알 수 없느나 홈페이지를 통해 각 변수들의 특성을 파악할 수 있다. 먼저 A1, A4, A5, A6, A7, A9, A10, A12, A13는 명목형 자료이다. 대부분은 2개의 범주로 구성되어 있으나, A6과 같은경우 15개의 범주로 구성되어 있다. 반면 A2, A3, A8, A11, A14, A15는 숫자형 범주이다. read_csv에서 보면 그 특성과 다르게 가져왔기에 이에 맞게 변수를 변환하였다. 또한 중간중간 NA가 있으나 나무모형을 사용하기에 그대로 사용하였다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hw_tb = raw_hw_tb %&amp;gt;% mutate(
    A1=as.factor(A1), A4=as.factor(A4), A5=as.factor(A5), A6=as.factor(A6), A7=as.factor(A7),
    A9=as.factor(A9), A10=as.factor(A10), A12=as.factor(A12), A13=as.factor(A13),
    
    A2=as.numeric(A2), A3=as.numeric(A3), A8=as.numeric(A8), A11=as.numeric(A11),
    A14=as.numeric(A14), A15=as.numeric(A15),
    
    class=as.factor(class)
  )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;자료의 구조와 총 개수를 보면 다음과 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;str(hw_tb)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## tibble [690 x 16] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ A1   : Factor w/ 2 levels &amp;quot;a&amp;quot;,&amp;quot;b&amp;quot;: 2 1 1 2 2 2 2 1 2 2 ...
##  $ A2   : num [1:690] 30.8 58.7 24.5 27.8 20.2 ...
##  $ A3   : num [1:690] 0 4.46 0.5 1.54 5.62 ...
##  $ A4   : Factor w/ 3 levels &amp;quot;l&amp;quot;,&amp;quot;u&amp;quot;,&amp;quot;y&amp;quot;: 2 2 2 2 2 2 2 2 3 3 ...
##  $ A5   : Factor w/ 3 levels &amp;quot;g&amp;quot;,&amp;quot;gg&amp;quot;,&amp;quot;p&amp;quot;: 1 1 1 1 1 1 1 1 3 3 ...
##  $ A6   : Factor w/ 14 levels &amp;quot;aa&amp;quot;,&amp;quot;c&amp;quot;,&amp;quot;cc&amp;quot;,..: 13 11 11 13 13 10 12 3 9 13 ...
##  $ A7   : Factor w/ 9 levels &amp;quot;bb&amp;quot;,&amp;quot;dd&amp;quot;,&amp;quot;ff&amp;quot;,..: 8 4 4 8 8 8 4 8 4 8 ...
##  $ A8   : num [1:690] 1.25 3.04 1.5 3.75 1.71 ...
##  $ A9   : Factor w/ 2 levels &amp;quot;FALSE&amp;quot;,&amp;quot;TRUE&amp;quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ A10  : Factor w/ 2 levels &amp;quot;FALSE&amp;quot;,&amp;quot;TRUE&amp;quot;: 2 2 1 2 1 1 1 1 1 1 ...
##  $ A11  : num [1:690] 1 6 0 5 0 0 0 0 0 0 ...
##  $ A12  : Factor w/ 2 levels &amp;quot;FALSE&amp;quot;,&amp;quot;TRUE&amp;quot;: 1 1 1 2 1 2 2 1 1 2 ...
##  $ A13  : Factor w/ 3 levels &amp;quot;g&amp;quot;,&amp;quot;p&amp;quot;,&amp;quot;s&amp;quot;: 1 1 1 1 3 1 1 1 1 1 ...
##  $ A14  : num [1:690] 202 43 280 100 120 360 164 80 180 52 ...
##  $ A15  : num [1:690] 0 560 824 3 0 ...
##  $ class: Factor w/ 2 levels &amp;quot;-&amp;quot;,&amp;quot;+&amp;quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  - attr(*, &amp;quot;spec&amp;quot;)=
##   .. cols(
##   ..   A1 = col_character(),
##   ..   A2 = col_double(),
##   ..   A3 = col_double(),
##   ..   A4 = col_character(),
##   ..   A5 = col_character(),
##   ..   A6 = col_character(),
##   ..   A7 = col_character(),
##   ..   A8 = col_double(),
##   ..   A9 = col_logical(),
##   ..   A10 = col_logical(),
##   ..   A11 = col_character(),
##   ..   A12 = col_logical(),
##   ..   A13 = col_character(),
##   ..   A14 = col_character(),
##   ..   A15 = col_double(),
##   ..   class = col_character()
##   .. )&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;nrow(hw_tb)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 690&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#1. Training 데이터와 Test 데이터를 50:50의 비율로 분할하시오.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(1234)
n = sample(1:nrow(hw_tb), round(nrow(hw_tb)/2)) 
train = hw_tb[n,] 
test = hw_tb[-n,]
c(nrow(train), nrow(test))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 345 345&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;#2. R 프로그램의 ‘rpart’ 명령어를 사용하여 의사결정나무를 수행하고자 한다. 단, hyper-parameter는 아래와 같이 조정한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;A. minsplit = 1 ~ 46 (5의 간격으로)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;B. cp = 0.001 ~ 0.01 (0.001의 간격으로)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;C. xval = 0 으로 고정 (pruning 없음)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;D. 그외 parameter 값들은 default 값을 사용&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;위-2번의-조건에-맞는-의사결정나무를-training-데이터를-이용하여-생성하고-test-데이터를-이용하여-예측-정확도를-계산하고자-한다.-이때-예측정확도는-auroc-값을-사용한다.-그-결과-총-110개의-auroc-값을-구할-수-있다.-이를-minsplit과-cp-값의-조합에-따라-auroc-값으로-3차원-포물선-그래프3d-surface-plot를-생성하시오.&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;3. 위 2번의 조건에 맞는 의사결정나무를 training 데이터를 이용하여 생성하고, test 데이터를 이용하여 예측 정확도를 계산하고자 한다. 이때 예측정확도는 AUROC 값을 사용한다. 그 결과, 총 110개의 AUROC 값을 구할 수 있다. 이를 minsplit과 cp 값의 조합에 따라 AUROC 값으로 3차원 포물선 그래프(3D surface plot)를 생성하시오.&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;auc = matrix(NA,nrow=10,ncol=10)

for(i1 in 1:10){
  for(i2 in 1:10){
    tree_control = rpart.control(minsplit = 5*i1-4, cp =0.001*i2, xval=0)
    temp_tree = assign(paste(&amp;#39;tree&amp;#39;,5*i1-4,i2,sep=&amp;#39;_&amp;#39;), rpart(class ~ . , data=train, method=&amp;#39;class&amp;#39;, control=tree_control) )
    temp_prob = assign(paste(&amp;#39;prob&amp;#39;,5*i1-4,i2,sep=&amp;#39;_&amp;#39;), predict(temp_tree, newdata=test, type=&amp;quot;prob&amp;quot;)  )
    temp_roc = assign(paste(&amp;#39;roc&amp;#39;,5*i1-4,i2,sep=&amp;#39;_&amp;#39;), roc(test$class ~ temp_prob[,2])  )
    auc[i1,i2]=temp_roc$auc
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting levels: control = -, case = +&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Setting direction: controls &amp;lt; cases&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;코드 실행 결과는 아래와 같은 객체를 통해 확인할 수 있다. 자세한 내용은 생략한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;각각의 모형 : tree_(minsplit값)_(cp값*1000)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;각각의 예측 : prob_(minsplit값)_(cp값*1000)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;각각의 roc(4번) : roc_(minsplit값)_(cp값*1000)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;해당 auroc를 이용하여 3d surface plot을 그리면 아래와 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;cp = 0.001*1:10
minsplit = 1:10*5-4
rownames(auc)=cp
colnames(auc)=minsplit

plot_ly(z = auc,x=cp,y=minsplit) %&amp;gt;%
        add_surface() %&amp;gt;%
        layout(scene = list(
                xaxis = list(title = &amp;#39;cp&amp;#39;,tickvals=cp),
                yaxis = list(title = &amp;#39;minsplit&amp;#39;,tickvals=minsplit),
                zaxis = list(title = &amp;#39;auc&amp;#39;))
               )&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:672px;height:480px;&#34; class=&#34;plotly html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;visdat&#34;:{&#34;1eac4dcb311e&#34;:[&#34;function () &#34;,&#34;plotlyVisDat&#34;]},&#34;cur_data&#34;:&#34;1eac4dcb311e&#34;,&#34;attrs&#34;:{&#34;1eac4dcb311e&#34;:{&#34;z&#34;:[[0.834699453551913,0.834699453551913,0.834429602644539,0.805538689873845,0.873372461714903,0.873372461714903,0.904118599473791,0.904118599473791,0.904118599473791,0.904118599473791],[0.88477366255144,0.88477366255144,0.88477366255144,0.88477366255144,0.88477366255144,0.88477366255144,0.897473520879714,0.897473520879714,0.897473520879714,0.897473520879714],[0.90627740673278,0.90627740673278,0.90627740673278,0.90627740673278,0.90627740673278,0.90627740673278,0.899986507454631,0.899986507454631,0.899986507454631,0.899986507454631],[0.920343385279633,0.920343385279633,0.920343385279633,0.920343385279633,0.920343385279633,0.920343385279633,0.916261890305606,0.916261890305606,0.916261890305606,0.916261890305606],[0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003],[0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654],[0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228],[0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228],[0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228],[0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228]],&#34;x&#34;:[0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01],&#34;y&#34;:[1,6,11,16,21,26,31,36,41,46],&#34;alpha_stroke&#34;:1,&#34;sizes&#34;:[10,100],&#34;spans&#34;:[1,20],&#34;type&#34;:&#34;surface&#34;,&#34;inherit&#34;:true}},&#34;layout&#34;:{&#34;margin&#34;:{&#34;b&#34;:40,&#34;l&#34;:60,&#34;t&#34;:25,&#34;r&#34;:10},&#34;scene&#34;:{&#34;xaxis&#34;:{&#34;title&#34;:&#34;cp&#34;,&#34;tickvals&#34;:[0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01]},&#34;yaxis&#34;:{&#34;title&#34;:&#34;minsplit&#34;,&#34;tickvals&#34;:[1,6,11,16,21,26,31,36,41,46]},&#34;zaxis&#34;:{&#34;title&#34;:&#34;auc&#34;}},&#34;hovermode&#34;:&#34;closest&#34;,&#34;showlegend&#34;:false,&#34;legend&#34;:{&#34;yanchor&#34;:&#34;top&#34;,&#34;y&#34;:0.5}},&#34;source&#34;:&#34;A&#34;,&#34;config&#34;:{&#34;showSendToCloud&#34;:false},&#34;data&#34;:[{&#34;colorbar&#34;:{&#34;title&#34;:&#34;&#34;,&#34;ticklen&#34;:2,&#34;len&#34;:0.5,&#34;lenmode&#34;:&#34;fraction&#34;,&#34;y&#34;:1,&#34;yanchor&#34;:&#34;top&#34;},&#34;colorscale&#34;:[[&#34;0&#34;,&#34;rgba(68,1,84,1)&#34;],[&#34;0.0416666666666664&#34;,&#34;rgba(70,19,97,1)&#34;],[&#34;0.0833333333333337&#34;,&#34;rgba(72,32,111,1)&#34;],[&#34;0.125&#34;,&#34;rgba(71,45,122,1)&#34;],[&#34;0.166666666666667&#34;,&#34;rgba(68,58,128,1)&#34;],[&#34;0.208333333333333&#34;,&#34;rgba(64,70,135,1)&#34;],[&#34;0.25&#34;,&#34;rgba(60,82,138,1)&#34;],[&#34;0.291666666666667&#34;,&#34;rgba(56,93,140,1)&#34;],[&#34;0.333333333333333&#34;,&#34;rgba(49,104,142,1)&#34;],[&#34;0.375&#34;,&#34;rgba(46,114,142,1)&#34;],[&#34;0.416666666666667&#34;,&#34;rgba(42,123,142,1)&#34;],[&#34;0.458333333333333&#34;,&#34;rgba(38,133,141,1)&#34;],[&#34;0.5&#34;,&#34;rgba(37,144,140,1)&#34;],[&#34;0.541666666666667&#34;,&#34;rgba(33,154,138,1)&#34;],[&#34;0.583333333333333&#34;,&#34;rgba(39,164,133,1)&#34;],[&#34;0.625&#34;,&#34;rgba(47,174,127,1)&#34;],[&#34;0.666666666666667&#34;,&#34;rgba(53,183,121,1)&#34;],[&#34;0.708333333333333&#34;,&#34;rgba(79,191,110,1)&#34;],[&#34;0.75&#34;,&#34;rgba(98,199,98,1)&#34;],[&#34;0.791666666666667&#34;,&#34;rgba(119,207,85,1)&#34;],[&#34;0.833333333333333&#34;,&#34;rgba(147,214,70,1)&#34;],[&#34;0.875&#34;,&#34;rgba(172,220,52,1)&#34;],[&#34;0.916666666666666&#34;,&#34;rgba(199,225,42,1)&#34;],[&#34;0.958333333333334&#34;,&#34;rgba(226,228,40,1)&#34;],[&#34;1&#34;,&#34;rgba(253,231,37,1)&#34;]],&#34;showscale&#34;:true,&#34;z&#34;:[[0.834699453551913,0.834699453551913,0.834429602644539,0.805538689873845,0.873372461714903,0.873372461714903,0.904118599473791,0.904118599473791,0.904118599473791,0.904118599473791],[0.88477366255144,0.88477366255144,0.88477366255144,0.88477366255144,0.88477366255144,0.88477366255144,0.897473520879714,0.897473520879714,0.897473520879714,0.897473520879714],[0.90627740673278,0.90627740673278,0.90627740673278,0.90627740673278,0.90627740673278,0.90627740673278,0.899986507454631,0.899986507454631,0.899986507454631,0.899986507454631],[0.920343385279633,0.920343385279633,0.920343385279633,0.920343385279633,0.920343385279633,0.920343385279633,0.916261890305606,0.916261890305606,0.916261890305606,0.916261890305606],[0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003,0.915013829859003],[0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654,0.916025770761654],[0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228],[0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228],[0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228],[0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228,0.91435606827228]],&#34;x&#34;:[0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01],&#34;y&#34;:[1,6,11,16,21,26,31,36,41,46],&#34;type&#34;:&#34;surface&#34;,&#34;frame&#34;:null}],&#34;highlight&#34;:{&#34;on&#34;:&#34;plotly_click&#34;,&#34;persistent&#34;:false,&#34;dynamic&#34;:false,&#34;selectize&#34;:false,&#34;opacityDim&#34;:0.2,&#34;selected&#34;:{&#34;opacity&#34;:1},&#34;debounce&#34;:0},&#34;shinyEvents&#34;:[&#34;plotly_hover&#34;,&#34;plotly_click&#34;,&#34;plotly_selected&#34;,&#34;plotly_relayout&#34;,&#34;plotly_brushed&#34;,&#34;plotly_brushing&#34;,&#34;plotly_clickannotation&#34;,&#34;plotly_doubleclick&#34;,&#34;plotly_deselect&#34;,&#34;plotly_afterplot&#34;,&#34;plotly_sunburstclick&#34;],&#34;base_url&#34;:&#34;https://plot.ly&#34;},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;그래프는 ploty를 사용하였기에 html에서 종합적으로 볼 수 있다.&lt;/p&gt;
&lt;p&gt;#4. 위의 결과에서 예측정확도가 가장 높은 최적의 hyper-parameter 조합은 무엇인지 밝히시오.&lt;/p&gt;
&lt;p&gt;먼저 auc 행렬을 이용해 최댓값을 찾으면 다음의 위치이다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;auc == max(auc)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##           1     6    11    16    21    26    31    36    41    46
## 0.001 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 0.002 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 0.003 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 0.004  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE
## 0.005 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 0.006 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 0.007 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 0.008 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 0.009 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 0.01  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;즉 cp가 0.005이고 minsplit이 1, 6, 11, 16, 21일때 가장 좋은 auroc를 가진다. 즉 해당 조합이 최적의 hyper-parameter이다.&lt;/p&gt;
&lt;/div&gt;
</content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="/categories/r/" term="R" label="R" />
                            
                        
                            
                            
                            
                                <category scheme="/categories/data-mining/" term="data mining" label="data mining" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="/tags/data-mining/" term="data mining" label="data mining" />
                            
                        
                            
                            
                            
                                <category scheme="/tags/decision-tree/" term="decision tree" label="decision tree" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">데이터마이닝 - 로지스틱 회귀분석</title>
            <link rel="alternate" type="text/html" href="/posts/data_mining/1/" />
            <id>/posts/data_mining/1/</id>
            <updated>2020-06-09T14:40:21&#43;09:00</updated>
            <published>2020-04-05T00:00:00&#43;00:00</published>
            <author>
                    <name>Lee Chung Pa</name>
                    <uri>https://leechungpa.netlify.app/</uri>
                    <email>leechungpa@naver.com</email>
                    </author>
            <rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">데이터마이닝 연습으로 로지스틱 회귀분석을 사용한 예제이다.
자료 불러오기library(readxl)airbnb &amp;lt;- read_excel(&amp;quot;data/airbnb.xlsx&amp;quot;)str(airbnb)## tibble [74,111 x 29] (S3: tbl_df/tbl/data.frame)## $ id : num [1:74111] 6901257 6304928 7919400 13418779 3808709 ...## $ log_price : num [1:74111] 5.01 5.13 4.98 6.</summary>
            
                <content type="html">


&lt;p&gt;데이터마이닝 연습으로 로지스틱 회귀분석을 사용한 예제이다.&lt;/p&gt;
&lt;div id=&#34;자료-불러오기&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;자료 불러오기&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(readxl)
airbnb &amp;lt;- read_excel(&amp;quot;data/airbnb.xlsx&amp;quot;)
str(airbnb)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## tibble [74,111 x 29] (S3: tbl_df/tbl/data.frame)
##  $ id                    : num [1:74111] 6901257 6304928 7919400 13418779 3808709 ...
##  $ log_price             : num [1:74111] 5.01 5.13 4.98 6.62 4.74 ...
##  $ property_type         : chr [1:74111] &amp;quot;Apartment&amp;quot; &amp;quot;Apartment&amp;quot; &amp;quot;Apartment&amp;quot; &amp;quot;House&amp;quot; ...
##  $ room_type             : chr [1:74111] &amp;quot;Entire home/apt&amp;quot; &amp;quot;Entire home/apt&amp;quot; &amp;quot;Entire home/apt&amp;quot; &amp;quot;Entire home/apt&amp;quot; ...
##  $ amenities             : chr [1:74111] &amp;quot;{\&amp;quot;Wireless Internet\&amp;quot;,\&amp;quot;Air conditioning\&amp;quot;,Kitchen,Heating,\&amp;quot;Family/kid friendly\&amp;quot;,Essentials,\&amp;quot;Hair dryer\&amp;quot;,I&amp;quot;| __truncated__ &amp;quot;{\&amp;quot;Wireless Internet\&amp;quot;,\&amp;quot;Air conditioning\&amp;quot;,Kitchen,Heating,\&amp;quot;Family/kid friendly\&amp;quot;,Washer,Dryer,\&amp;quot;Smoke detect&amp;quot;| __truncated__ &amp;quot;{TV,\&amp;quot;Cable TV\&amp;quot;,\&amp;quot;Wireless Internet\&amp;quot;,\&amp;quot;Air conditioning\&amp;quot;,Kitchen,Breakfast,\&amp;quot;Buzzer/wireless intercom\&amp;quot;,Heat&amp;quot;| __truncated__ &amp;quot;{TV,\&amp;quot;Cable TV\&amp;quot;,Internet,\&amp;quot;Wireless Internet\&amp;quot;,Kitchen,\&amp;quot;Indoor fireplace\&amp;quot;,\&amp;quot;Buzzer/wireless intercom\&amp;quot;,Heati&amp;quot;| __truncated__ ...
##  $ accommodates          : num [1:74111] 3 7 5 4 2 2 3 2 2 2 ...
##  $ bathrooms             : num [1:74111] 1 1 1 1 1 1 1 1 1 1 ...
##  $ bed_type              : chr [1:74111] &amp;quot;Real Bed&amp;quot; &amp;quot;Real Bed&amp;quot; &amp;quot;Real Bed&amp;quot; &amp;quot;Real Bed&amp;quot; ...
##  $ cancellation_policy   : chr [1:74111] &amp;quot;strict&amp;quot; &amp;quot;strict&amp;quot; &amp;quot;moderate&amp;quot; &amp;quot;flexible&amp;quot; ...
##  $ cleaning_fee          : logi [1:74111] TRUE TRUE TRUE TRUE TRUE TRUE ...
##  $ city                  : chr [1:74111] &amp;quot;NYC&amp;quot; &amp;quot;NYC&amp;quot; &amp;quot;NYC&amp;quot; &amp;quot;SF&amp;quot; ...
##  $ description           : chr [1:74111] &amp;quot;Beautiful, sunlit brownstone 1-bedroom in the loveliest neighborhood in Brooklyn. Blocks from the promenade and&amp;quot;| __truncated__ &amp;quot;Enjoy travelling during your stay in Manhattan. My place is centrally located near Times Square and Central Par&amp;quot;| __truncated__ &amp;quot;The Oasis comes complete with a full backyard with outdoor furniture to make the most of this summer vacation!!&amp;quot;| __truncated__ &amp;quot;This light-filled home-away-from-home is super clean and comes with all of the modern amenities travelers could&amp;quot;| __truncated__ ...
##  $ first_review          : POSIXct[1:74111], format: &amp;quot;2018-06-16&amp;quot; &amp;quot;2005-08-17&amp;quot; ...
##  $ host_has_profile_pic  : chr [1:74111] &amp;quot;t&amp;quot; &amp;quot;t&amp;quot; &amp;quot;t&amp;quot; &amp;quot;t&amp;quot; ...
##  $ host_identity_verified: chr [1:74111] &amp;quot;t&amp;quot; &amp;quot;f&amp;quot; &amp;quot;t&amp;quot; &amp;quot;t&amp;quot; ...
##  $ host_response_rate    : num [1:74111] NA 1 1 NA 1 1 1 1 1 1 ...
##  $ host_since            : POSIXct[1:74111], format: &amp;quot;2026-03-12&amp;quot; &amp;quot;2019-06-17&amp;quot; ...
##  $ instant_bookable      : chr [1:74111] &amp;quot;f&amp;quot; &amp;quot;t&amp;quot; &amp;quot;t&amp;quot; &amp;quot;f&amp;quot; ...
##  $ last_review           : POSIXct[1:74111], format: &amp;quot;2018-07-16&amp;quot; &amp;quot;2023-09-17&amp;quot; ...
##  $ latitude              : num [1:74111] 40.7 40.8 40.8 37.8 38.9 ...
##  $ longitude             : num [1:74111] -74 -74 -73.9 -122.4 -77 ...
##  $ name                  : chr [1:74111] &amp;quot;Beautiful brownstone 1-bedroom&amp;quot; &amp;quot;Superb 3BR Apt Located Near Times Square&amp;quot; &amp;quot;The Garden Oasis&amp;quot; &amp;quot;Beautiful Flat in the Heart of SF!&amp;quot; ...
##  $ neighbourhood         : chr [1:74111] &amp;quot;Brooklyn Heights&amp;quot; &amp;quot;Hell&amp;#39;s Kitchen&amp;quot; &amp;quot;Harlem&amp;quot; &amp;quot;Lower Haight&amp;quot; ...
##  $ number_of_reviews     : num [1:74111] 2 6 10 0 4 3 15 9 159 2 ...
##  $ review_scores_rating  : num [1:74111] 100 93 92 NA 40 100 97 93 99 90 ...
##  $ thumbnail_url         : chr [1:74111] &amp;quot;https://a0.muscache.com/im/pictures/6d7cbbf7-c034-459c-bc82-6522c957627c.jpg?aki_policy=small&amp;quot; &amp;quot;https://a0.muscache.com/im/pictures/348a55fe-4b65-452a-b48a-bfecb3b58a66.jpg?aki_policy=small&amp;quot; &amp;quot;https://a0.muscache.com/im/pictures/6fae5362-9e3a-4fa9-aa54-bbd5ea26538d.jpg?aki_policy=small&amp;quot; &amp;quot;https://a0.muscache.com/im/pictures/72208dad-9c86-41ea-a735-43d933111063.jpg?aki_policy=small&amp;quot; ...
##  $ zipcode               : chr [1:74111] &amp;quot;11201&amp;quot; &amp;quot;10019&amp;quot; &amp;quot;10027&amp;quot; &amp;quot;94117&amp;quot; ...
##  $ bedrooms              : num [1:74111] 1 3 1 2 0 1 1 1 1 1 ...
##  $ beds                  : num [1:74111] 1 3 3 2 1 1 1 1 1 1 ...&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;데이터-전처리&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;데이터 전처리&lt;/h1&gt;
&lt;div id=&#34;property_type은-house-apartment-other-등의-3범주로-변환하시오.&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;“property_type”은 ‘House’, ‘Apartment’, ’Other’ 등의 3범주로 변환하시오.&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;attach(airbnb)
airbnb$property_type[!(property_type==&amp;#39;House&amp;#39;| property_type==&amp;#39;Apartment&amp;#39;)] = &amp;quot;Other&amp;quot;
airbnb$property_type &amp;lt;- as.factor(airbnb$property_type)
levels(airbnb$property_type)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Apartment&amp;quot; &amp;quot;House&amp;quot;     &amp;quot;Other&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;bed_type은-bed-other-등의-2범주로-변환하시오.&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;“bed_type”은 ‘Bed’, ‘Other’ 등의 2범주로 변환하시오.&lt;/h3&gt;
&lt;p&gt;Real Bed와 Airbed 는 Bed로, 나머지는 Other로 변환하였다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;airbnb$bed_type[(bed_type==&amp;#39;Airbed&amp;#39;| bed_type==&amp;#39;Real Bed&amp;#39;)] = &amp;quot;Bed&amp;quot;
airbnb$bed_type[!(bed_type==&amp;#39;Airbed&amp;#39;| bed_type==&amp;#39;Real Bed&amp;#39;)] = &amp;quot;Other&amp;quot;
airbnb$bed_type &amp;lt;- as.factor(airbnb$bed_type)
levels(airbnb$bed_type)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Bed&amp;quot;   &amp;quot;Other&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;detach(airbnb)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;number_of_reviews가-11개-이상인-데이터만-추출해서-분석에-사용하시오.&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;“number_of_reviews”가 11개 이상인 데이터만 추출해서 분석에 사용하시오.&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;airbnb &amp;lt;- airbnb[airbnb$number_of_reviews&amp;gt;=11 , 1:ncol(airbnb)]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;가격비price_ratio-변수를-생성하시오.&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;‘가격비(price_ratio)’ 변수를 생성하시오.&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;airbnb$log_price &amp;lt;- exp(airbnb$log_price)
mean_price &amp;lt;- aggregate(log_price ~ city, airbnb, mean)
names(mean_price) &amp;lt;-c (&amp;quot;city&amp;quot;,&amp;quot;mean_price&amp;quot;)
f_airbnb &amp;lt;- merge(x =airbnb,y=mean_price,by=&amp;quot;city&amp;quot;,all.x=T)
f_airbnb$price_ratio &amp;lt;- f_airbnb$log_price/f_airbnb$mean_price*100&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;데이터-분석&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;데이터 분석&lt;/h1&gt;
&lt;div id=&#34;가격비price_ratio-변수의-평균과-표준편차를-답하시오.&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;1. “가격비(price_ratio)” 변수의 평균과 표준편차를 답하시오.&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mean(f_airbnb$price_ratio)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 100&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sd(f_airbnb$price_ratio)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 83.72338&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;가격비price_ratio를-종속변수로-하여-선형회귀분석을-수행하시오.&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;2. “가격비(price_ratio)”를 종속변수로 하여 선형회귀분석을 수행하시오.&lt;/h2&gt;
&lt;p&gt;먼저 시행에 앞서 불필요한 변수를 제거한다. 제거한 것들은 아래와 같다. &lt;em&gt;amenities나 description의 경우 길이로 변환하여 분석하였으나 큰 의미가 없어 제거하고 분석하였다.&lt;/em&gt; (y변수 계산에 필요했던 것들 및 url이나 설명같이 의미없는 것들을 제외한다.)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;description&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;amenities&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;name&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;neighbourhood&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;thumbnail_url&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;id&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;log_price&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;mean_price&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;f_df &amp;lt;- subset(f_airbnb, select = -c(description, amenities, name, neighbourhood, thumbnail_url, id, log_price, mean_price))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;character를 factor로 변환한다. 순서가 있는 cancellation_policy의 경우 순서를 준다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;find_char_col&amp;lt;-NA
for (i in 1:ncol(f_df)){
  find_char_col[i] &amp;lt;- is.character(f_df[,i])
}
char_col &amp;lt;- colnames(f_df)[find_char_col]
f_df[char_col] &amp;lt;- lapply(f_df[char_col] , factor)

f_df$cleaning_fee &amp;lt;- as.factor(f_df$cleaning_fee)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;cancellation_policy에서도 “super_strict_60”는 2개뿐이므로“super_strict_30”에 포함시켰다. (즉 super_strict_30는 super_strict_30+를 의미한다.)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;which(f_df$cancellation_policy == &amp;quot;super_strict_60&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1]  6558 13642&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;f_df$cancellation_policy[which(f_df$cancellation_policy == &amp;quot;super_strict_60&amp;quot;)] &amp;lt;- &amp;quot;super_strict_30&amp;quot;
f_df$cancellation_policy &amp;lt;- factor(f_df$cancellation_policy,levels=c(&amp;quot;flexible&amp;quot;, &amp;quot;moderate&amp;quot;, &amp;quot;strict&amp;quot;, &amp;quot;super_strict_30&amp;quot;), order=T)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;먼저 각각의 plot을 그려본다. (결과는 생략 eval=FALSE)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;for (i in 1:(ncol(f_df)-1)) {
plot(f_df$price_ratio~f_df[[i]],xlab=colnames(f_df)[i])
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;대략적으로 눈으로 보기에 차이가 나타나는 것은 다음과 같다. (진한 것은 더욱 두드러 진 것)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;room_type&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;accommodates&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;bathrooms&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;bed_type&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;cancellation_policy&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;cleaning_fee&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;host_has_profile_pic&lt;/li&gt;
&lt;li&gt;host_identity_verified&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;host_response_rate&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;instant_bookable&lt;/li&gt;
&lt;li&gt;latitude&lt;/li&gt;
&lt;li&gt;longitude&lt;/li&gt;
&lt;li&gt;number_of_reviews&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;review_scores_rating&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;bedrooms&lt;/li&gt;
&lt;li&gt;beds&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그런데 latitude와 longitude는 사실상 zipcode에 그 데이터에 의미가 어느정도 포함된다고 판단하여 제거하였다.&lt;/p&gt;
&lt;p&gt;또한 zipcode는 너무 자세하므로 분석의 편의상 앞의 2자리만 사용하였다. (city는 이 zipcode에 포함되므로 생략하였다.)&lt;/p&gt;
&lt;p&gt;그리고 host_has_profile_pic의 경우 f는 28개뿐으로 매우 적으므로 변수를 사용하지 않는다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary( lm( price_ratio ~ latitude, data=f_df))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = price_ratio ~ latitude, data = f_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
##  -92.71  -47.41  -22.56   19.19 1323.76 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept) 9.996e+01  6.061e+00  16.492   &amp;lt;2e-16 ***
## latitude    9.344e-04  1.574e-01   0.006    0.995    
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 83.72 on 29014 degrees of freedom
## Multiple R-squared:  1.215e-09,  Adjusted R-squared:  -3.446e-05 
## F-statistic: 3.525e-05 on 1 and 29014 DF,  p-value: 0.9953&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary( lm( price_ratio ~ longitude, data=f_df))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = price_ratio ~ longitude, data = f_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
##  -92.67  -47.36  -22.63   19.12 1323.69 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept) 99.765008   2.164951  46.082   &amp;lt;2e-16 ***
## longitude   -0.002513   0.022547  -0.111    0.911    
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 83.72 on 29014 degrees of freedom
## Multiple R-squared:  4.281e-07,  Adjusted R-squared:  -3.404e-05 
## F-statistic: 0.01242 on 1 and 29014 DF,  p-value: 0.9113&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;f_df$zipcode &amp;lt;- as.factor(substr(f_airbnb$zipcode,1,2))

table(f_df$host_has_profile_pic)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
##     f     t 
##    28 28924&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;그래서 이를 제외한 다음을 분석변수로 한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;room_type&lt;/li&gt;
&lt;li&gt;property_type&lt;/li&gt;
&lt;li&gt;accommodates&lt;/li&gt;
&lt;li&gt;bathrooms&lt;/li&gt;
&lt;li&gt;bed_type&lt;/li&gt;
&lt;li&gt;cancellation_policy&lt;/li&gt;
&lt;li&gt;cleaning_fee&lt;/li&gt;
&lt;li&gt;host_identity_verified&lt;/li&gt;
&lt;li&gt;host_response_rate&lt;/li&gt;
&lt;li&gt;instant_bookable&lt;/li&gt;
&lt;li&gt;first_review&lt;/li&gt;
&lt;li&gt;number_of_reviews&lt;/li&gt;
&lt;li&gt;host_since&lt;/li&gt;
&lt;li&gt;review_scores_rating&lt;/li&gt;
&lt;li&gt;last_review&lt;/li&gt;
&lt;li&gt;bedrooms&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;beds&lt;/li&gt;
&lt;li&gt;zipcode&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;정확히 하기 위해 trellis plot을 그려보았다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(lattice)
mypanel &amp;lt;- function(x, y) {
  panel.xyplot(x, y)
  panel.loess(x, y, col=&amp;quot;red&amp;quot;, lwd=2, lty=2) 
}

xyplot(price_ratio ~ room_type, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ accommodates, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ bathrooms, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ bed_type, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-4.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ cancellation_policy, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-5.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ cleaning_fee, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-6.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ host_identity_verified , data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-7.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ host_response_rate, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-8.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ instant_bookable , data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-9.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ number_of_reviews, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-10.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ review_scores_rating, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-11.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ bedrooms, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-12.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ beds, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-13.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ zipcode, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-14.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ last_review , data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-15.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ host_since , data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-16.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ first_review , data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-17.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(price_ratio ~ property_type , data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-12-18.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;이제 18개의 값들을 이용해 선형회귀분석을 실시한다. 그전에 결측치NA가 포함된 행은 제거하고 실시한다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;f_df = na.omit(f_df)

lm1 = lm(price_ratio ~ room_type + property_type + accommodates + bathrooms + bed_type + cancellation_policy + cleaning_fee + host_identity_verified + host_response_rate + instant_bookable + first_review + number_of_reviews + host_since + review_scores_rating + last_review + bedrooms  + beds + zipcode , data = f_df)

summary(lm1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + bed_type + cancellation_policy + cleaning_fee + 
##     host_identity_verified + host_response_rate + instant_bookable + 
##     first_review + number_of_reviews + host_since + review_scores_rating + 
##     last_review + bedrooms + beds + zipcode, data = f_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -310.42  -25.81   -2.43   18.11  995.55 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)             -9.898e+01  8.209e+00 -12.058  &amp;lt; 2e-16 ***
## room_typePrivate room   -4.603e+01  8.669e-01 -53.089  &amp;lt; 2e-16 ***
## room_typeShared room    -7.641e+01  2.538e+00 -30.105  &amp;lt; 2e-16 ***
## property_typeHouse       4.183e+00  9.150e-01   4.572 4.85e-06 ***
## property_typeOther       6.771e+00  1.112e+00   6.087 1.17e-09 ***
## accommodates             8.450e+00  3.292e-01  25.671  &amp;lt; 2e-16 ***
## bathrooms                3.515e+01  7.626e-01  46.087  &amp;lt; 2e-16 ***
## bed_typeOther            1.908e+00  2.279e+00   0.837 0.402372    
## cancellation_policy.L    5.800e+01  6.962e+00   8.330  &amp;lt; 2e-16 ***
## cancellation_policy.Q    3.702e+01  5.201e+00   7.117 1.13e-12 ***
## cancellation_policy.C    1.434e+01  2.375e+00   6.039 1.57e-09 ***
## cleaning_feeTRUE        -3.377e+00  1.006e+00  -3.357 0.000789 ***
## host_identity_verifiedt  2.158e+00  8.533e-01   2.529 0.011431 *  
## host_response_rate      -1.935e+01  3.508e+00  -5.516 3.50e-08 ***
## instant_bookablet       -4.545e+00  7.645e-01  -5.944 2.81e-09 ***
## first_review            -3.548e-11  5.496e-10  -0.065 0.948532    
## number_of_reviews       -4.118e-02  7.218e-03  -5.705 1.17e-08 ***
## host_since               1.791e-10  5.406e-10   0.331 0.740412    
## review_scores_rating     2.022e+00  7.722e-02  26.187  &amp;lt; 2e-16 ***
## last_review              7.622e-10  4.587e-10   1.662 0.096593 .  
## bedrooms                 2.588e+01  6.572e-01  39.373  &amp;lt; 2e-16 ***
## beds                    -3.614e+00  4.786e-01  -7.551 4.46e-14 ***
## zipcode11               -4.252e+01  1.112e+00 -38.245  &amp;lt; 2e-16 ***
## zipcode1m               -3.478e+01  5.632e+01  -0.617 0.536912    
## zipcode20               -4.165e+01  1.547e+00 -26.924  &amp;lt; 2e-16 ***
## zipcode21               -3.428e+01  1.739e+00 -19.714  &amp;lt; 2e-16 ***
## zipcode22               -1.917e+01  8.438e+00  -2.272 0.023073 *  
## zipcode24               -4.208e+01  5.633e+01  -0.747 0.454991    
## zipcode60               -4.246e+01  1.562e+00 -27.184  &amp;lt; 2e-16 ***
## zipcode90               -3.486e+01  1.107e+00 -31.483  &amp;lt; 2e-16 ***
## zipcode91               -5.649e+01  1.742e+00 -32.428  &amp;lt; 2e-16 ***
## zipcode92               -6.254e+01  5.634e+01  -1.110 0.266986    
## zipcode93               -7.250e+01  1.567e+01  -4.628 3.71e-06 ***
## zipcode94               -3.287e+01  1.418e+00 -23.189  &amp;lt; 2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 56.31 on 27002 degrees of freedom
## Multiple R-squared:  0.5462, Adjusted R-squared:  0.5456 
## F-statistic: 984.8 on 33 and 27002 DF,  p-value: &amp;lt; 2.2e-16&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;위를 보면 유의미하지 않은 p-value가 많다. 이제 stepwise를 해서 제거한다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;lm2 = step(lm1, direction = &amp;#39;both&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Start:  AIC=217990.5
## price_ratio ~ room_type + property_type + accommodates + bathrooms + 
##     bed_type + cancellation_policy + cleaning_fee + host_identity_verified + 
##     host_response_rate + instant_bookable + first_review + number_of_reviews + 
##     host_since + review_scores_rating + last_review + bedrooms + 
##     beds + zipcode
## 
##                          Df Sum of Sq      RSS    AIC
## - first_review            1        13 85615864 217989
## - host_since              1       348 85616199 217989
## - bed_type                1      2223 85618074 217989
## &amp;lt;none&amp;gt;                                85615851 217990
## - last_review             1      8755 85624606 217991
## - host_identity_verified  1     20286 85636137 217995
## - cleaning_fee            1     35736 85651586 218000
## - host_response_rate      1     96468 85712319 218019
## - number_of_reviews       1    103211 85719062 218021
## - instant_bookable        1    112043 85727894 218024
## - property_type           2    144262 85760113 218032
## - beds                    1    180785 85796636 218046
## - cancellation_policy     3    503380 86119231 218143
## - accommodates            1   2089553 87705404 218640
## - review_scores_rating    1   2174363 87790214 218667
## - bedrooms                1   4915304 90531154 219498
## - zipcode                12   6500593 92116444 219945
## - bathrooms               1   6734757 92350607 220036
## - room_type               2  10116125 95731976 221006
## 
## Step:  AIC=217988.5
## price_ratio ~ room_type + property_type + accommodates + bathrooms + 
##     bed_type + cancellation_policy + cleaning_fee + host_identity_verified + 
##     host_response_rate + instant_bookable + number_of_reviews + 
##     host_since + review_scores_rating + last_review + bedrooms + 
##     beds + zipcode
## 
##                          Df Sum of Sq      RSS    AIC
## - host_since              1       349 85616213 217987
## - bed_type                1      2224 85618088 217987
## &amp;lt;none&amp;gt;                                85615864 217989
## - last_review             1      8763 85624627 217989
## + first_review            1        13 85615851 217990
## - host_identity_verified  1     20283 85636147 217993
## - cleaning_fee            1     35747 85651611 217998
## - host_response_rate      1     96497 85712361 218017
## - number_of_reviews       1    103228 85719092 218019
## - instant_bookable        1    112052 85727916 218022
## - property_type           2    144250 85760114 218030
## - beds                    1    180804 85796668 218044
## - cancellation_policy     3    503371 86119235 218141
## - accommodates            1   2089584 87705448 218638
## - review_scores_rating    1   2174743 87790607 218665
## - bedrooms                1   4915310 90531174 219496
## - zipcode                12   6500955 92116819 219943
## - bathrooms               1   6734768 92350632 220034
## - room_type               2  10116180 95732044 221004
## 
## Step:  AIC=217986.6
## price_ratio ~ room_type + property_type + accommodates + bathrooms + 
##     bed_type + cancellation_policy + cleaning_fee + host_identity_verified + 
##     host_response_rate + instant_bookable + number_of_reviews + 
##     review_scores_rating + last_review + bedrooms + beds + zipcode
## 
##                          Df Sum of Sq      RSS    AIC
## - bed_type                1      2238 85618451 217985
## &amp;lt;none&amp;gt;                                85616213 217987
## - last_review             1      8739 85624953 217987
## + host_since              1       349 85615864 217989
## + first_review            1        14 85616199 217989
## - host_identity_verified  1     20254 85636467 217991
## - cleaning_fee            1     35785 85651998 217996
## - host_response_rate      1     96522 85712735 218015
## - number_of_reviews       1    103088 85719301 218017
## - instant_bookable        1    112180 85728393 218020
## - property_type           2    144324 85760538 218028
## - beds                    1    180830 85797044 218042
## - cancellation_policy     3    503161 86119374 218139
## - accommodates            1   2089343 87705556 218636
## - review_scores_rating    1   2174719 87790932 218663
## - bedrooms                1   4916145 90532358 219494
## - zipcode                12   6500763 92116976 219941
## - bathrooms               1   6734710 92350923 220032
## - room_type               2  10120958 95737171 221003
## 
## Step:  AIC=217985.3
## price_ratio ~ room_type + property_type + accommodates + bathrooms + 
##     cancellation_policy + cleaning_fee + host_identity_verified + 
##     host_response_rate + instant_bookable + number_of_reviews + 
##     review_scores_rating + last_review + bedrooms + beds + zipcode
## 
##                          Df Sum of Sq      RSS    AIC
## &amp;lt;none&amp;gt;                                85618451 217985
## - last_review             1      8687 85627138 217986
## + bed_type                1      2238 85616213 217987
## + host_since              1       363 85618088 217987
## + first_review            1        15 85618435 217987
## - host_identity_verified  1     20365 85638815 217990
## - cleaning_fee            1     35751 85654202 217995
## - host_response_rate      1     96483 85714934 218014
## - number_of_reviews       1    102833 85721284 218016
## - instant_bookable        1    113036 85731487 218019
## - property_type           2    144046 85762497 218027
## - beds                    1    182147 85800598 218041
## - cancellation_policy     3    501866 86120317 218137
## - accommodates            1   2090219 87708670 218635
## - review_scores_rating    1   2175653 87794104 218662
## - bedrooms                1   4917159 90535610 219493
## - zipcode                12   6501272 92119723 219940
## - bathrooms               1   6732473 92350924 220030
## - room_type               2  10195031 95813482 221023&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(lm2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + 
##     host_response_rate + instant_bookable + number_of_reviews + 
##     review_scores_rating + last_review + bedrooms + beds + zipcode, 
##     data = f_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -310.29  -25.79   -2.43   18.08  995.53 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)             -9.878e+01  8.141e+00 -12.134  &amp;lt; 2e-16 ***
## room_typePrivate room   -4.600e+01  8.659e-01 -53.122  &amp;lt; 2e-16 ***
## room_typeShared room    -7.604e+01  2.499e+00 -30.431  &amp;lt; 2e-16 ***
## property_typeHouse       4.171e+00  9.148e-01   4.560 5.13e-06 ***
## property_typeOther       6.772e+00  1.112e+00   6.088 1.16e-09 ***
## accommodates             8.451e+00  3.291e-01  25.676  &amp;lt; 2e-16 ***
## bathrooms                3.513e+01  7.624e-01  46.081  &amp;lt; 2e-16 ***
## cancellation_policy.L    5.795e+01  6.961e+00   8.324  &amp;lt; 2e-16 ***
## cancellation_policy.Q    3.698e+01  5.200e+00   7.112 1.17e-12 ***
## cancellation_policy.C    1.434e+01  2.374e+00   6.039 1.57e-09 ***
## cleaning_feeTRUE        -3.377e+00  1.006e+00  -3.358 0.000786 ***
## host_identity_verifiedt  2.162e+00  8.532e-01   2.534 0.011269 *  
## host_response_rate      -1.935e+01  3.507e+00  -5.516 3.49e-08 ***
## instant_bookablet       -4.563e+00  7.642e-01  -5.971 2.39e-09 ***
## number_of_reviews       -4.110e-02  7.216e-03  -5.695 1.25e-08 ***
## review_scores_rating     2.023e+00  7.721e-02  26.196  &amp;lt; 2e-16 ***
## last_review              7.592e-10  4.587e-10   1.655 0.097875 .  
## bedrooms                 2.588e+01  6.572e-01  39.382  &amp;lt; 2e-16 ***
## beds                    -3.626e+00  4.784e-01  -7.580 3.58e-14 ***
## zipcode11               -4.252e+01  1.112e+00 -38.246  &amp;lt; 2e-16 ***
## zipcode1m               -3.483e+01  5.632e+01  -0.618 0.536327    
## zipcode20               -4.165e+01  1.547e+00 -26.930  &amp;lt; 2e-16 ***
## zipcode21               -3.428e+01  1.739e+00 -19.714  &amp;lt; 2e-16 ***
## zipcode22               -1.922e+01  8.438e+00  -2.278 0.022721 *  
## zipcode24               -4.215e+01  5.632e+01  -0.748 0.454229    
## zipcode60               -4.248e+01  1.562e+00 -27.202  &amp;lt; 2e-16 ***
## zipcode90               -3.486e+01  1.107e+00 -31.487  &amp;lt; 2e-16 ***
## zipcode91               -5.649e+01  1.742e+00 -32.430  &amp;lt; 2e-16 ***
## zipcode92               -6.251e+01  5.634e+01  -1.110 0.267158    
## zipcode93               -7.254e+01  1.566e+01  -4.631 3.66e-06 ***
## zipcode94               -3.287e+01  1.417e+00 -23.192  &amp;lt; 2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 56.31 on 27005 degrees of freedom
## Multiple R-squared:  0.5462, Adjusted R-squared:  0.5457 
## F-statistic:  1083 on 30 and 27005 DF,  p-value: &amp;lt; 2.2e-16&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;이후 분석에서 p-value가 유의미하지 않은 last_review 를 제거하고 실시한다.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;회귀진단&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;회귀진단&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(lm2,which=1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-15-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(lm2,which=2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-15-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;잔차에서 메가폰 형태가 나타남을 알수 있다. 또한 QQ플랏도 문제가 있음을 알 수 있다. Y변수의 변환의 필요성이 있으므로 Y’=logY로 변환하였다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;f_df$log_price_ratio &amp;lt;- log(f_df$price_ratio)

lm3 = lm(log_price_ratio ~ room_type + property_type + accommodates + 
    bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + 
    host_response_rate + instant_bookable + number_of_reviews + 
    review_scores_rating + bedrooms + beds + zipcode, 
    data = f_df)

lm4 = step(lm3, direction = &amp;#39;both&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Start:  AIC=-54314.95
## log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + 
##     host_response_rate + instant_bookable + number_of_reviews + 
##     review_scores_rating + bedrooms + beds + zipcode
## 
##                          Df Sum of Sq    RSS    AIC
## - cleaning_fee            1      0.00 3618.2 -54317
## - number_of_reviews       1      0.08 3618.2 -54316
## &amp;lt;none&amp;gt;                                3618.2 -54315
## - host_identity_verified  1      1.21 3619.4 -54308
## - host_response_rate      1      4.82 3623.0 -54281
## - instant_bookable        1      7.14 3625.3 -54264
## - property_type           2      7.92 3626.1 -54260
## - cancellation_policy     3     21.45 3639.6 -54161
## - beds                    1     21.10 3639.3 -54160
## - bathrooms               1     79.59 3697.7 -53729
## - accommodates            1    131.11 3749.3 -53355
## - review_scores_rating    1    188.21 3806.4 -52946
## - bedrooms                1    216.57 3834.7 -52745
## - zipcode                12    462.42 4080.6 -51087
## - room_type               2   1779.04 5397.2 -43507
## 
## Step:  AIC=-54316.91
## log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + host_identity_verified + 
##     host_response_rate + instant_bookable + number_of_reviews + 
##     review_scores_rating + bedrooms + beds + zipcode
## 
##                          Df Sum of Sq    RSS    AIC
## - number_of_reviews       1      0.08 3618.2 -54318
## &amp;lt;none&amp;gt;                                3618.2 -54317
## + cleaning_fee            1      0.00 3618.2 -54315
## - host_identity_verified  1      1.21 3619.4 -54310
## - host_response_rate      1      4.84 3623.0 -54283
## - instant_bookable        1      7.16 3625.3 -54265
## - property_type           2      7.92 3626.1 -54262
## - beds                    1     21.11 3639.3 -54162
## - cancellation_policy     3     21.72 3639.9 -54161
## - bathrooms               1     79.62 3697.8 -53730
## - accommodates            1    131.42 3749.6 -53354
## - review_scores_rating    1    188.30 3806.5 -52947
## - bedrooms                1    216.56 3834.7 -52747
## - zipcode                12    462.51 4080.7 -51089
## - room_type               2   1827.08 5445.2 -43269
## 
## Step:  AIC=-54318.33
## log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + host_identity_verified + 
##     host_response_rate + instant_bookable + review_scores_rating + 
##     bedrooms + beds + zipcode
## 
##                          Df Sum of Sq    RSS    AIC
## &amp;lt;none&amp;gt;                                3618.2 -54318
## + number_of_reviews       1      0.08 3618.2 -54317
## + cleaning_fee            1      0.00 3618.2 -54316
## - host_identity_verified  1      1.16 3619.4 -54312
## - host_response_rate      1      4.95 3623.2 -54283
## - instant_bookable        1      7.27 3625.5 -54266
## - property_type           2      7.97 3626.2 -54263
## - cancellation_policy     3     21.66 3639.9 -54163
## - beds                    1     21.15 3639.4 -54163
## - bathrooms               1     79.88 3698.1 -53730
## - accommodates            1    131.34 3749.6 -53356
## - review_scores_rating    1    188.57 3806.8 -52947
## - bedrooms                1    218.14 3836.4 -52738
## - zipcode                12    462.64 4080.9 -51089
## - room_type               2   1828.54 5446.8 -43264&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;그 결과는 아래와 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(lm4)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + host_identity_verified + 
##     host_response_rate + instant_bookable + review_scores_rating + 
##     bedrooms + beds + zipcode, data = f_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.51557 -0.22551 -0.00287  0.22588  2.52586 
## 
## Coefficients:
##                           Estimate Std. Error  t value Pr(&amp;gt;|t|)    
## (Intercept)              2.8112298  0.0525988   53.447  &amp;lt; 2e-16 ***
## room_typePrivate room   -0.5855993  0.0055699 -105.136  &amp;lt; 2e-16 ***
## room_typeShared room    -1.1375240  0.0161312  -70.517  &amp;lt; 2e-16 ***
## property_typeHouse      -0.0183360  0.0059407   -3.087  0.00203 ** 
## property_typeOther       0.0422432  0.0072288    5.844 5.16e-09 ***
## accommodates             0.0668736  0.0021358   31.311  &amp;lt; 2e-16 ***
## bathrooms                0.1209281  0.0049524   24.418  &amp;lt; 2e-16 ***
## cancellation_policy.L    0.2933262  0.0452494    6.482 9.18e-11 ***
## cancellation_policy.Q    0.1616865  0.0337823    4.786 1.71e-06 ***
## cancellation_policy.C    0.0664165  0.0154332    4.303 1.69e-05 ***
## host_identity_verifiedt  0.0162382  0.0055087    2.948  0.00320 ** 
## host_response_rate      -0.1381528  0.0227264   -6.079 1.23e-09 ***
## instant_bookablet       -0.0365163  0.0049570   -7.367 1.80e-13 ***
## review_scores_rating     0.0188152  0.0005015   37.518  &amp;lt; 2e-16 ***
## bedrooms                 0.1719812  0.0042620   40.352  &amp;lt; 2e-16 ***
## beds                    -0.0390361  0.0031066  -12.566  &amp;lt; 2e-16 ***
## zipcode11               -0.3585074  0.0072259  -49.614  &amp;lt; 2e-16 ***
## zipcode1m               -0.3950436  0.3661121   -1.079  0.28059    
## zipcode20               -0.2976181  0.0100374  -29.651  &amp;lt; 2e-16 ***
## zipcode21               -0.2358253  0.0112927  -20.883  &amp;lt; 2e-16 ***
## zipcode22               -0.1539659  0.0548451   -2.807  0.00500 ** 
## zipcode24               -0.6528374  0.3661251   -1.783  0.07458 .  
## zipcode60               -0.3329465  0.0101308  -32.865  &amp;lt; 2e-16 ***
## zipcode90               -0.2835116  0.0071819  -39.476  &amp;lt; 2e-16 ***
## zipcode91               -0.5014514  0.0112977  -44.385  &amp;lt; 2e-16 ***
## zipcode92               -0.8951543  0.3661830   -2.445  0.01451 *  
## zipcode93               -0.6850067  0.1017839   -6.730 1.73e-11 ***
## zipcode94               -0.2315125  0.0091763  -25.229  &amp;lt; 2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.366 on 27008 degrees of freedom
## Multiple R-squared:  0.6588, Adjusted R-squared:  0.6584 
## F-statistic:  1931 on 27 and 27008 DF,  p-value: &amp;lt; 2.2e-16&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(lm4,which=1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-17-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(lm4,which=2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: not plotting observations with leverage one:
##   1413, 8437, 20636&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-17-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;잔차의 패턴이 어느정도 감소함을 알 수 있다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(lm3)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + 
##     host_response_rate + instant_bookable + number_of_reviews + 
##     review_scores_rating + bedrooms + beds + zipcode, data = f_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.51722 -0.22532 -0.00299  0.22586  2.52411 
## 
## Coefficients:
##                           Estimate Std. Error  t value Pr(&amp;gt;|t|)    
## (Intercept)              2.813e+00  5.270e-02   53.368  &amp;lt; 2e-16 ***
## room_typePrivate room   -5.856e-01  5.629e-03 -104.034  &amp;lt; 2e-16 ***
## room_typeShared room    -1.138e+00  1.624e-02  -70.065  &amp;lt; 2e-16 ***
## property_typeHouse      -1.814e-02  5.946e-03   -3.051  0.00228 ** 
## property_typeOther       4.224e-02  7.230e-03    5.842 5.21e-09 ***
## accommodates             6.693e-02  2.140e-03   31.282  &amp;lt; 2e-16 ***
## bathrooms                1.208e-01  4.956e-03   24.374  &amp;lt; 2e-16 ***
## cancellation_policy.L    2.931e-01  4.525e-02    6.477 9.49e-11 ***
## cancellation_policy.Q    1.610e-01  3.380e-02    4.764 1.91e-06 ***
## cancellation_policy.C    6.631e-02  1.543e-02    4.296 1.74e-05 ***
## cleaning_feeTRUE        -1.157e-03  6.536e-03   -0.177  0.85946    
## host_identity_verifiedt  1.670e-02  5.546e-03    3.011  0.00261 ** 
## host_response_rate      -1.368e-01  2.280e-02   -5.998 2.02e-09 ***
## instant_bookablet       -3.627e-02  4.968e-03   -7.301 2.93e-13 ***
## number_of_reviews       -3.647e-05  4.691e-05   -0.778  0.43683    
## review_scores_rating     1.881e-02  5.018e-04   37.481  &amp;lt; 2e-16 ***
## bedrooms                 1.718e-01  4.272e-03   40.205  &amp;lt; 2e-16 ***
## beds                    -3.903e-02  3.110e-03  -12.549  &amp;lt; 2e-16 ***
## zipcode11               -3.585e-01  7.226e-03  -49.616  &amp;lt; 2e-16 ***
## zipcode1m               -3.950e-01  3.661e-01   -1.079  0.28064    
## zipcode20               -2.975e-01  1.004e-02  -29.637  &amp;lt; 2e-16 ***
## zipcode21               -2.355e-01  1.130e-02  -20.839  &amp;lt; 2e-16 ***
## zipcode22               -1.539e-01  5.485e-02   -2.805  0.00503 ** 
## zipcode24               -6.537e-01  3.661e-01   -1.785  0.07423 .  
## zipcode60               -3.330e-01  1.014e-02  -32.848  &amp;lt; 2e-16 ***
## zipcode90               -2.834e-01  7.186e-03  -39.434  &amp;lt; 2e-16 ***
## zipcode91               -5.019e-01  1.131e-02  -44.361  &amp;lt; 2e-16 ***
## zipcode92               -8.944e-01  3.662e-01   -2.442  0.01460 *  
## zipcode93               -6.861e-01  1.018e-01   -6.738 1.64e-11 ***
## zipcode94               -2.309e-01  9.213e-03  -25.062  &amp;lt; 2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.366 on 27006 degrees of freedom
## Multiple R-squared:  0.6588, Adjusted R-squared:  0.6584 
## F-statistic:  1798 on 29 and 27006 DF,  p-value: &amp;lt; 2.2e-16&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;다만 p-value를 구해보면 유의미하지 않은 변수가 다시 나타나므로 stepwise를 실시해 본다. 그전에 number_of_reviews가 유의미 하지 않는 다고 나온다. 하지만 number_of_reviews는 다른 숫자자료에 비해 분산이 크다. 실제로 number_of_reviews와 비교해보면 10배 정도 차이가 난다. 이를 보정해 주기 위해 나눈값을 해봐도 결과는 동일하게 유의미 하지 않는다고 나온다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sd(f_df$review_scores_rating, na.rm=TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 4.655876&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sd(f_df$number_of_reviews) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 48.80326&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;f_df$standard_number_of_reviews &amp;lt;- f_df$number_of_reviews/sd(f_df$review_scores_rating, na.rm=TRUE)


temp_lm = lm(log_price_ratio ~ room_type + accommodates + bathrooms + 
    cancellation_policy + cleaning_fee + host_response_rate + 
    instant_bookable + standard_number_of_reviews + review_scores_rating + 
    bedrooms + beds, data = f_df)

summary(temp_lm)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = log_price_ratio ~ room_type + accommodates + bathrooms + 
##     cancellation_policy + cleaning_fee + host_response_rate + 
##     instant_bookable + standard_number_of_reviews + review_scores_rating + 
##     bedrooms + beds, data = f_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.59858 -0.25391 -0.01335  0.24299  2.54936 
## 
## Coefficients:
##                              Estimate Std. Error  t value Pr(&amp;gt;|t|)    
## (Intercept)                 2.8699063  0.0556688   51.553  &amp;lt; 2e-16 ***
## room_typePrivate room      -0.6022161  0.0057959 -103.904  &amp;lt; 2e-16 ***
## room_typeShared room       -1.1298223  0.0173091  -65.273  &amp;lt; 2e-16 ***
## accommodates                0.0634022  0.0022744   27.876  &amp;lt; 2e-16 ***
## bathrooms                   0.1074901  0.0052103   20.630  &amp;lt; 2e-16 ***
## cancellation_policy.L       0.3217257  0.0481716    6.679 2.46e-11 ***
## cancellation_policy.Q       0.1491561  0.0359783    4.146 3.40e-05 ***
## cancellation_policy.C       0.0559756  0.0164257    3.408 0.000656 ***
## cleaning_feeTRUE            0.0046765  0.0069336    0.674 0.500018    
## host_response_rate         -0.2032507  0.0242706   -8.374  &amp;lt; 2e-16 ***
## instant_bookablet          -0.0380744  0.0052724   -7.221 5.28e-13 ***
## standard_number_of_reviews  0.0000952  0.0002299    0.414 0.678769    
## review_scores_rating        0.0166253  0.0005285   31.456  &amp;lt; 2e-16 ***
## bedrooms                    0.1667024  0.0045023   37.026  &amp;lt; 2e-16 ***
## beds                       -0.0384741  0.0033131  -11.613  &amp;lt; 2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.3907 on 27021 degrees of freedom
## Multiple R-squared:  0.6111, Adjusted R-squared:  0.6109 
## F-statistic:  3032 on 14 and 27021 DF,  p-value: &amp;lt; 2.2e-16&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;이제 기존의 변수를 활용하여 stepwise를 실시해 본다&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;lm4 = step(lm3, direction = &amp;#39;both&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Start:  AIC=-54314.95
## log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + cleaning_fee + host_identity_verified + 
##     host_response_rate + instant_bookable + number_of_reviews + 
##     review_scores_rating + bedrooms + beds + zipcode
## 
##                          Df Sum of Sq    RSS    AIC
## - cleaning_fee            1      0.00 3618.2 -54317
## - number_of_reviews       1      0.08 3618.2 -54316
## &amp;lt;none&amp;gt;                                3618.2 -54315
## - host_identity_verified  1      1.21 3619.4 -54308
## - host_response_rate      1      4.82 3623.0 -54281
## - instant_bookable        1      7.14 3625.3 -54264
## - property_type           2      7.92 3626.1 -54260
## - cancellation_policy     3     21.45 3639.6 -54161
## - beds                    1     21.10 3639.3 -54160
## - bathrooms               1     79.59 3697.7 -53729
## - accommodates            1    131.11 3749.3 -53355
## - review_scores_rating    1    188.21 3806.4 -52946
## - bedrooms                1    216.57 3834.7 -52745
## - zipcode                12    462.42 4080.6 -51087
## - room_type               2   1779.04 5397.2 -43507
## 
## Step:  AIC=-54316.91
## log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + host_identity_verified + 
##     host_response_rate + instant_bookable + number_of_reviews + 
##     review_scores_rating + bedrooms + beds + zipcode
## 
##                          Df Sum of Sq    RSS    AIC
## - number_of_reviews       1      0.08 3618.2 -54318
## &amp;lt;none&amp;gt;                                3618.2 -54317
## + cleaning_fee            1      0.00 3618.2 -54315
## - host_identity_verified  1      1.21 3619.4 -54310
## - host_response_rate      1      4.84 3623.0 -54283
## - instant_bookable        1      7.16 3625.3 -54265
## - property_type           2      7.92 3626.1 -54262
## - beds                    1     21.11 3639.3 -54162
## - cancellation_policy     3     21.72 3639.9 -54161
## - bathrooms               1     79.62 3697.8 -53730
## - accommodates            1    131.42 3749.6 -53354
## - review_scores_rating    1    188.30 3806.5 -52947
## - bedrooms                1    216.56 3834.7 -52747
## - zipcode                12    462.51 4080.7 -51089
## - room_type               2   1827.08 5445.2 -43269
## 
## Step:  AIC=-54318.33
## log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + host_identity_verified + 
##     host_response_rate + instant_bookable + review_scores_rating + 
##     bedrooms + beds + zipcode
## 
##                          Df Sum of Sq    RSS    AIC
## &amp;lt;none&amp;gt;                                3618.2 -54318
## + number_of_reviews       1      0.08 3618.2 -54317
## + cleaning_fee            1      0.00 3618.2 -54316
## - host_identity_verified  1      1.16 3619.4 -54312
## - host_response_rate      1      4.95 3623.2 -54283
## - instant_bookable        1      7.27 3625.5 -54266
## - property_type           2      7.97 3626.2 -54263
## - cancellation_policy     3     21.66 3639.9 -54163
## - beds                    1     21.15 3639.4 -54163
## - bathrooms               1     79.88 3698.1 -53730
## - accommodates            1    131.34 3749.6 -53356
## - review_scores_rating    1    188.57 3806.8 -52947
## - bedrooms                1    218.14 3836.4 -52738
## - zipcode                12    462.64 4080.9 -51089
## - room_type               2   1828.54 5446.8 -43264&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;그 결과는 다음과 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(lm4)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + host_identity_verified + 
##     host_response_rate + instant_bookable + review_scores_rating + 
##     bedrooms + beds + zipcode, data = f_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.51557 -0.22551 -0.00287  0.22588  2.52586 
## 
## Coefficients:
##                           Estimate Std. Error  t value Pr(&amp;gt;|t|)    
## (Intercept)              2.8112298  0.0525988   53.447  &amp;lt; 2e-16 ***
## room_typePrivate room   -0.5855993  0.0055699 -105.136  &amp;lt; 2e-16 ***
## room_typeShared room    -1.1375240  0.0161312  -70.517  &amp;lt; 2e-16 ***
## property_typeHouse      -0.0183360  0.0059407   -3.087  0.00203 ** 
## property_typeOther       0.0422432  0.0072288    5.844 5.16e-09 ***
## accommodates             0.0668736  0.0021358   31.311  &amp;lt; 2e-16 ***
## bathrooms                0.1209281  0.0049524   24.418  &amp;lt; 2e-16 ***
## cancellation_policy.L    0.2933262  0.0452494    6.482 9.18e-11 ***
## cancellation_policy.Q    0.1616865  0.0337823    4.786 1.71e-06 ***
## cancellation_policy.C    0.0664165  0.0154332    4.303 1.69e-05 ***
## host_identity_verifiedt  0.0162382  0.0055087    2.948  0.00320 ** 
## host_response_rate      -0.1381528  0.0227264   -6.079 1.23e-09 ***
## instant_bookablet       -0.0365163  0.0049570   -7.367 1.80e-13 ***
## review_scores_rating     0.0188152  0.0005015   37.518  &amp;lt; 2e-16 ***
## bedrooms                 0.1719812  0.0042620   40.352  &amp;lt; 2e-16 ***
## beds                    -0.0390361  0.0031066  -12.566  &amp;lt; 2e-16 ***
## zipcode11               -0.3585074  0.0072259  -49.614  &amp;lt; 2e-16 ***
## zipcode1m               -0.3950436  0.3661121   -1.079  0.28059    
## zipcode20               -0.2976181  0.0100374  -29.651  &amp;lt; 2e-16 ***
## zipcode21               -0.2358253  0.0112927  -20.883  &amp;lt; 2e-16 ***
## zipcode22               -0.1539659  0.0548451   -2.807  0.00500 ** 
## zipcode24               -0.6528374  0.3661251   -1.783  0.07458 .  
## zipcode60               -0.3329465  0.0101308  -32.865  &amp;lt; 2e-16 ***
## zipcode90               -0.2835116  0.0071819  -39.476  &amp;lt; 2e-16 ***
## zipcode91               -0.5014514  0.0112977  -44.385  &amp;lt; 2e-16 ***
## zipcode92               -0.8951543  0.3661830   -2.445  0.01451 *  
## zipcode93               -0.6850067  0.1017839   -6.730 1.73e-11 ***
## zipcode94               -0.2315125  0.0091763  -25.229  &amp;lt; 2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.366 on 27008 degrees of freedom
## Multiple R-squared:  0.6588, Adjusted R-squared:  0.6584 
## F-statistic:  1931 on 27 and 27008 DF,  p-value: &amp;lt; 2.2e-16&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(lm4,which=1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-21-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(lm4,which=2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: not plotting observations with leverage one:
##   1413, 8437, 20636&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-21-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;정규성과 등분산성에 문제가 없다. Y 변수가 아닌 잔차를 바탕으로 trellis plot을 그려보면 큰 문제는 보이지 않는다. (결과는 생략 eval=FALSE)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xyplot(lm4$residuals ~ room_type, data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ cancellation_policy, data=f_df,panel=mypanel)

xyplot(lm4$residuals ~ property_type, data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ accommodates, data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ bathrooms, data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ host_identity_verified, data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ host_response_rate, data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ instant_bookable , data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ review_scores_rating, data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ bedrooms, data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ beds, data=f_df,panel=mypanel)
xyplot(lm4$residuals ~ zipcode, data=f_df,panel=mypanel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;즉 우리는 교호작용 없이 총 12개의 변수를 이용해 회귀분석 하였다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;room_type&lt;/li&gt;
&lt;li&gt;property_type&lt;/li&gt;
&lt;li&gt;accommodates&lt;/li&gt;
&lt;li&gt;bathrooms&lt;/li&gt;
&lt;li&gt;cancellation_policy&lt;/li&gt;
&lt;li&gt;host_identity_verified&lt;/li&gt;
&lt;li&gt;host_response_rate&lt;/li&gt;
&lt;li&gt;instant_bookable&lt;/li&gt;
&lt;li&gt;review_scores_rating&lt;/li&gt;
&lt;li&gt;bedrooms&lt;/li&gt;
&lt;li&gt;beds&lt;/li&gt;
&lt;li&gt;zipcode&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이제 오버피팅을 막기 위해 데이터를 train set과 test set으로 나누어 모형 만들어 평가해 보도록 한다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;nobs=nrow(f_df)

set.seed(1234)
i = sample(1:nobs, round(nobs*0.6)) #60% for training data, 40% for testdata
train_df = f_df[i,] 
test_df = f_df[-i,]

lm5 = lm(log_price_ratio ~ room_type + property_type + accommodates + bathrooms 
          + cancellation_policy + host_identity_verified + host_response_rate + instant_bookable + 
            review_scores_rating + bedrooms + beds + zipcode, data = f_df)

summary(lm5)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + host_identity_verified + 
##     host_response_rate + instant_bookable + review_scores_rating + 
##     bedrooms + beds + zipcode, data = f_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.51557 -0.22551 -0.00287  0.22588  2.52586 
## 
## Coefficients:
##                           Estimate Std. Error  t value Pr(&amp;gt;|t|)    
## (Intercept)              2.8112298  0.0525988   53.447  &amp;lt; 2e-16 ***
## room_typePrivate room   -0.5855993  0.0055699 -105.136  &amp;lt; 2e-16 ***
## room_typeShared room    -1.1375240  0.0161312  -70.517  &amp;lt; 2e-16 ***
## property_typeHouse      -0.0183360  0.0059407   -3.087  0.00203 ** 
## property_typeOther       0.0422432  0.0072288    5.844 5.16e-09 ***
## accommodates             0.0668736  0.0021358   31.311  &amp;lt; 2e-16 ***
## bathrooms                0.1209281  0.0049524   24.418  &amp;lt; 2e-16 ***
## cancellation_policy.L    0.2933262  0.0452494    6.482 9.18e-11 ***
## cancellation_policy.Q    0.1616865  0.0337823    4.786 1.71e-06 ***
## cancellation_policy.C    0.0664165  0.0154332    4.303 1.69e-05 ***
## host_identity_verifiedt  0.0162382  0.0055087    2.948  0.00320 ** 
## host_response_rate      -0.1381528  0.0227264   -6.079 1.23e-09 ***
## instant_bookablet       -0.0365163  0.0049570   -7.367 1.80e-13 ***
## review_scores_rating     0.0188152  0.0005015   37.518  &amp;lt; 2e-16 ***
## bedrooms                 0.1719812  0.0042620   40.352  &amp;lt; 2e-16 ***
## beds                    -0.0390361  0.0031066  -12.566  &amp;lt; 2e-16 ***
## zipcode11               -0.3585074  0.0072259  -49.614  &amp;lt; 2e-16 ***
## zipcode1m               -0.3950436  0.3661121   -1.079  0.28059    
## zipcode20               -0.2976181  0.0100374  -29.651  &amp;lt; 2e-16 ***
## zipcode21               -0.2358253  0.0112927  -20.883  &amp;lt; 2e-16 ***
## zipcode22               -0.1539659  0.0548451   -2.807  0.00500 ** 
## zipcode24               -0.6528374  0.3661251   -1.783  0.07458 .  
## zipcode60               -0.3329465  0.0101308  -32.865  &amp;lt; 2e-16 ***
## zipcode90               -0.2835116  0.0071819  -39.476  &amp;lt; 2e-16 ***
## zipcode91               -0.5014514  0.0112977  -44.385  &amp;lt; 2e-16 ***
## zipcode92               -0.8951543  0.3661830   -2.445  0.01451 *  
## zipcode93               -0.6850067  0.1017839   -6.730 1.73e-11 ***
## zipcode94               -0.2315125  0.0091763  -25.229  &amp;lt; 2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.366 on 27008 degrees of freedom
## Multiple R-squared:  0.6588, Adjusted R-squared:  0.6584 
## F-statistic:  1931 on 27 and 27008 DF,  p-value: &amp;lt; 2.2e-16&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(lm5,which=1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-23-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(lm5,which=2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: not plotting observations with leverage one:
##   1413, 8437, 20636&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/datamining-logisticregression_files/figure-html/unnamed-chunk-23-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;p-value도 유의미하며(일부 zipcode는 유의미 하지 않으나 대부분이 유의미하므로 그대로 사용한다. 하지만 해당 zipcode에 대해서는 해석에 유의할 필요가 있다.), Adjusted R-squared도 0.6584이다. 잔차도 문제 없으므로 test데이터와 비교를 해본다.&lt;/p&gt;
&lt;p&gt;그 결과 예측결정계수,평균절대오차, MAPE는 순서대로 다음과 같다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## predicted values
pred = predict(lm5, newdata=test_df, type=&amp;#39;response&amp;#39;)
# predictive R^2
cor(test_df$log_price_ratio, pred)^2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.6595498&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# MAE
mean(abs(test_df$log_price_ratio - pred))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.280805&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# MAPE
mean(abs(test_df$log_price_ratio - pred)/abs(test_df$log_price_ratio))*100&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 6.538482&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;최종-결과&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;최종 결과&lt;/h1&gt;
&lt;p&gt;마지막으로 우리의 최종 모형을 설명하고자 한다.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(lm5)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = log_price_ratio ~ room_type + property_type + accommodates + 
##     bathrooms + cancellation_policy + host_identity_verified + 
##     host_response_rate + instant_bookable + review_scores_rating + 
##     bedrooms + beds + zipcode, data = f_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.51557 -0.22551 -0.00287  0.22588  2.52586 
## 
## Coefficients:
##                           Estimate Std. Error  t value Pr(&amp;gt;|t|)    
## (Intercept)              2.8112298  0.0525988   53.447  &amp;lt; 2e-16 ***
## room_typePrivate room   -0.5855993  0.0055699 -105.136  &amp;lt; 2e-16 ***
## room_typeShared room    -1.1375240  0.0161312  -70.517  &amp;lt; 2e-16 ***
## property_typeHouse      -0.0183360  0.0059407   -3.087  0.00203 ** 
## property_typeOther       0.0422432  0.0072288    5.844 5.16e-09 ***
## accommodates             0.0668736  0.0021358   31.311  &amp;lt; 2e-16 ***
## bathrooms                0.1209281  0.0049524   24.418  &amp;lt; 2e-16 ***
## cancellation_policy.L    0.2933262  0.0452494    6.482 9.18e-11 ***
## cancellation_policy.Q    0.1616865  0.0337823    4.786 1.71e-06 ***
## cancellation_policy.C    0.0664165  0.0154332    4.303 1.69e-05 ***
## host_identity_verifiedt  0.0162382  0.0055087    2.948  0.00320 ** 
## host_response_rate      -0.1381528  0.0227264   -6.079 1.23e-09 ***
## instant_bookablet       -0.0365163  0.0049570   -7.367 1.80e-13 ***
## review_scores_rating     0.0188152  0.0005015   37.518  &amp;lt; 2e-16 ***
## bedrooms                 0.1719812  0.0042620   40.352  &amp;lt; 2e-16 ***
## beds                    -0.0390361  0.0031066  -12.566  &amp;lt; 2e-16 ***
## zipcode11               -0.3585074  0.0072259  -49.614  &amp;lt; 2e-16 ***
## zipcode1m               -0.3950436  0.3661121   -1.079  0.28059    
## zipcode20               -0.2976181  0.0100374  -29.651  &amp;lt; 2e-16 ***
## zipcode21               -0.2358253  0.0112927  -20.883  &amp;lt; 2e-16 ***
## zipcode22               -0.1539659  0.0548451   -2.807  0.00500 ** 
## zipcode24               -0.6528374  0.3661251   -1.783  0.07458 .  
## zipcode60               -0.3329465  0.0101308  -32.865  &amp;lt; 2e-16 ***
## zipcode90               -0.2835116  0.0071819  -39.476  &amp;lt; 2e-16 ***
## zipcode91               -0.5014514  0.0112977  -44.385  &amp;lt; 2e-16 ***
## zipcode92               -0.8951543  0.3661830   -2.445  0.01451 *  
## zipcode93               -0.6850067  0.1017839   -6.730 1.73e-11 ***
## zipcode94               -0.2315125  0.0091763  -25.229  &amp;lt; 2e-16 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.366 on 27008 degrees of freedom
## Multiple R-squared:  0.6588, Adjusted R-squared:  0.6584 
## F-statistic:  1931 on 27 and 27008 DF,  p-value: &amp;lt; 2.2e-16&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;y변수-log_price_ratio-가격비에-log를-취한-값&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Y변수 : log_price_ratio (가격비에 log를 취한 값)&lt;/h3&gt;
&lt;/div&gt;
&lt;div id=&#34;x변수-room_type-property_type-accommodates-bathrooms-cancellation_policy-host_identity_verified-host_response_rate-instant_bookable-review_scores_rating-bedrooms-beds-zipcod&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;X변수 : room_type + property_type + accommodates + bathrooms + cancellation_policy + host_identity_verified + host_response_rate + instant_bookable + review_scores_rating + bedrooms + beds + zipcod&lt;/h3&gt;
&lt;p&gt;위의 Coefficients의 Estimate를 보면 그 결과를 알 수 있으나 간단히 설명하면 다음과 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;cancellation_policy가 “super_strict_30”에서 “flexible”으로 변하면 0.2750713만큼 log_price_ratio가 증가한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cancellation_policy가 “super_strict_30”에서 “moderate”으로 변하면 0.1480741만큼 log_price_ratio가 증가한다.&lt;br /&gt;
&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cancellation_policy가 “super_strict_30”에서 “strict”으로 변하면 0.0603244만큼 log_price_ratio가 증가한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;room_type가 Entire home/apt에서 “Private room”으로 변하면 0.5854706만큼 log_price_ratio가 &lt;strong&gt;감소&lt;/strong&gt;한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;room_type가 Entire home/apt에서 “Shared room”으로 변하면 1.1371925만큼 log_price_ratio가 &lt;strong&gt;감소&lt;/strong&gt;한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;property_type가 “Apartment”에서 “House”으로 변하면 0.0184556만큼 log_price_ratio가 &lt;strong&gt;감소&lt;/strong&gt;한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;property_type가 “Apartment”에서 “Other”으로 변하면 0.0422110만큼 log_price_ratio가 증가한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;host_identity_verified가 “f”에서 “t”으로 변하면 0.0162358만큼 log_price_ratio가 증가한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;bedrooms의 개수가 1개 증가할 수록 0.1718274만큼 log_price_ratio가 증가한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;beds의 수가 1개 증가할수록 0.0392406만큼 log_price_ratio가 &lt;strong&gt;감소&lt;/strong&gt;한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;bathrooms의 개수가 1개 증가할 수록 0.1208864만큼 log_price_ratio가 증가한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;accommodate가 1 증가할 수록 0.0670576만큼 log_price_ratio가 증가한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;host_response_rate가 1 증가할 수록 0.1385022만큼 log_price_ratio가 &lt;strong&gt;감소&lt;/strong&gt;한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;instant_bookablet가 1 증가할 수록 0.0365038만큼 log_price_ratio가 &lt;strong&gt;감소&lt;/strong&gt;한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;review_scores_rating가 1 증가할 수록 0.0188218만큼 log_price_ratio가 증가한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;zipcode의 경우 10###에서 각 해당 코드로 변했을떄 log_price_ratio가 얼마나 감소했는지를 의미한다. 다만 zipcode1m###과 zipcode24###는 설명하지 않는다.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="/categories/r/" term="R" label="R" />
                            
                        
                            
                            
                            
                                <category scheme="/categories/data-mining/" term="data mining" label="data mining" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="/tags/data-mining/" term="data mining" label="data mining" />
                            
                        
                            
                            
                            
                                <category scheme="/tags/logistic/" term="logistic" label="logistic" />
                            
                        
                    
                
            
        </entry>
    
</feed>
